var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,o=(t,s,l)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[s]=l,i=(e,t)=>{for(var s in t||(t={}))r.call(t,s)&&o(e,s,t[s]);if(l)for(var s of l(t))a.call(t,s)&&o(e,s,t[s]);return e},n=(e,l)=>t(e,s(l)),d=(e,t,s)=>o(e,"symbol"!=typeof t?t+"":t,s),c=(e,t,s)=>new Promise((l,r)=>{var a=e=>{try{i(s.next(e))}catch(t){r(t)}},o=e=>{try{i(s.throw(e))}catch(t){r(t)}},i=e=>e.done?l(e.value):Promise.resolve(e.value).then(a,o);i((s=s.apply(e,t)).next())});import{r as g,a as m,b as x,c as u,d as h}from"./vendor-D0mQW2M9.js";import{N as y,u as p,L as b,O as f,a as j,b as v,B as w,R as N,c as k}from"./router-HpuqVZca.js";import{c as _}from"./supabase-Coq80B_L.js";import{R as C,X as S,A as I,C as E,S as A,Z as q,U as D,M as L,L as T,E as P,a as R,b as $,B as F,c as O,d as M,T as z,e as U,f as B,P as H,g as V,h as G,i as W,j as J,k as Y,l as K,m as X,n as Q,o as Z,p as ee,q as te,r as se,s as le,F as re,t as ae,u as oe,v as ie,w as ne,x as de,y as ce,z as ge,D as me,G as xe,H as ue,I as he,J as ye,K as pe,N as be,O as fe,Q as je,V as ve,W as we,Y as Ne,_ as ke,$ as _e,a0 as Ce,a1 as Se,a2 as Ie,a3 as Ee,a4 as Ae,a5 as qe,a6 as De,a7 as Le,a8 as Te,a9 as Pe,aa as Re,ab as $e,ac as Fe,ad as Oe,ae as Me,af as ze,ag as Ue,ah as Be,ai as He,aj as Ve,ak as Ge}from"./icons-CY97Nb5r.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var We={exports:{}},Je={},Ye=g,Ke=Symbol.for("react.element"),Xe=Symbol.for("react.fragment"),Qe=Object.prototype.hasOwnProperty,Ze=Ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,et={key:!0,ref:!0,__self:!0,__source:!0};function tt(e,t,s){var l,r={},a=null,o=null;for(l in void 0!==s&&(a=""+s),void 0!==t.key&&(a=""+t.key),void 0!==t.ref&&(o=t.ref),t)Qe.call(t,l)&&!et.hasOwnProperty(l)&&(r[l]=t[l]);if(e&&e.defaultProps)for(l in t=e.defaultProps)void 0===r[l]&&(r[l]=t[l]);return{$$typeof:Ke,type:e,key:a,ref:o,props:r,_owner:Ze.current}}Je.Fragment=Xe,Je.jsx=tt,Je.jsxs=tt,We.exports=Je;var st=We.exports,lt={},rt=m;lt.createRoot=rt.createRoot,lt.hydrateRoot=rt.hydrateRoot;const at=_("https://zhlaaaysvzqixnugqbna.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpobGFhYXlzdnpxaXhudWdxYm5hIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE0MDYwOTUsImV4cCI6MjA2Njk4MjA5NX0.oS03M7cfw3JiQObDL5uwvTPc1F54awaOfdmqUBcIVTc",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),ot=g.createContext(void 0);function it({children:e}){const[t,s]=g.useState(null),[l,r]=g.useState(null),[a,o]=g.useState(!0),[i,n]=g.useState(!1);g.useEffect(()=>{at.auth.getSession().then(({data:{session:e}})=>{var t;r(e),s(null!=(t=null==e?void 0:e.user)?t:null),d(null==e?void 0:e.user),o(!1)});const{data:{subscription:e}}=at.auth.onAuthStateChange((e,t)=>c(this,null,function*(){var e;r(t),s(null!=(e=null==t?void 0:t.user)?e:null),d(null==t?void 0:t.user),o(!1)}));return()=>e.unsubscribe()},[]);const d=e=>c(this,null,function*(){var t;if(e)try{const{data:s,error:l}=yield at.from("memberships").select("role").eq("user_id",e.id);!l&&s&&s.length>0&&"admin"===(null==(t=s[0])?void 0:t.role)?n(!0):n(!1)}catch(s){n(!1)}else n(!1)}),m={user:t,session:l,loading:a,isAdmin:i,signIn:(e,t)=>c(this,null,function*(){const{error:s}=yield at.auth.signInWithPassword({email:e,password:t});if(s)throw s}),signUp:(e,t,s)=>c(this,null,function*(){const{data:l,error:r}=yield at.auth.signUp({email:e,password:t,options:{data:{full_name:s}}});if(r)throw r;if(l.user){const{error:e}=yield at.from("users").insert([{id:l.user.id,full_name:s}]);e&&console.error("Error creating user profile:",e);const{error:t}=yield at.from("memberships").insert([{user_id:l.user.id,role:"member"}]);t&&console.error("Error creating membership:",t)}}),signOut:()=>c(this,null,function*(){const{error:e}=yield at.auth.signOut();if(e)throw e})};return st.jsx(ot.Provider,{value:m,children:e})}function nt(){const e=g.useContext(ot);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e}const dt=g.createContext(void 0);function ct({children:e}){const[t,s]=g.useState("blue");g.useEffect(()=>{const e=localStorage.getItem("theme");!e||"blue"!==e&&"gold"!==e||s(e)},[]);const l={theme:t,toggleTheme:()=>{const e="blue"===t?"gold":"blue";s(e),localStorage.setItem("theme",e)}};return st.jsx(dt.Provider,{value:l,children:e})}function gt(){const e=g.useContext(dt);if(void 0===e)throw new Error("useTheme must be used within a ThemeProvider");return e}class mt extends g.Component{constructor(){super(...arguments),d(this,"state",{hasError:!1})}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Uncaught error:",e,t)}render(){return this.state.hasError?st.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:st.jsx("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:st.jsxs("div",{className:"text-center",children:[st.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:st.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:st.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),st.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Something went wrong"}),st.jsx("p",{className:"text-gray-600 mb-4",children:"An unexpected error occurred. Please refresh the page to try again."}),st.jsx("button",{onClick:()=>window.location.reload(),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors",children:"Refresh Page"})]})})}):this.props.children}}function xt(){const[e,t]=g.useState(!1),[s,l]=g.useState(""),[r,a]=g.useState(""),o=g.useCallback((e,...s)=>c(this,[e,...s],function*(e,s={}){t(!0),l(""),a("");try{yield e(),s.successMessage&&a(s.successMessage)}catch(r){const e=s.errorMessage||(r instanceof Error?r.message:"An unexpected error occurred");l(e)}finally{t(!1)}}),[]);return{isLoading:e,error:s,success:r,setError:l,setSuccess:a,executeAsync:o}}function ut(){const e=g.useCallback((e,t)=>{var s,l,r;if(console.error(`Error in ${t||"unknown context"}:`,e),null==e?void 0:e.code)switch(e.code){case"invalid_credentials":return{message:"Invalid email or password. Please check your credentials.",code:e.code,type:"auth"};case"email_not_confirmed":return{message:"Please verify your email address before signing in.",code:e.code,type:"auth"};case"too_many_requests":return{message:"Too many requests. Please wait a moment before trying again.",code:e.code,type:"network"};default:return{message:e.message||"An unexpected error occurred.",code:e.code,type:"server"}}return"NetworkError"===(null==e?void 0:e.name)||(null==(s=null==e?void 0:e.message)?void 0:s.includes("fetch"))?{message:"Network error. Please check your connection and try again.",type:"network"}:(null==(l=null==e?void 0:e.message)?void 0:l.includes("validation"))||(null==(r=null==e?void 0:e.message)?void 0:r.includes("required"))?{message:e.message,type:"validation"}:{message:(null==e?void 0:e.message)||"An unexpected error occurred. Please try again.",type:"unknown"}},[]),t=g.useCallback((t,s)=>c(this,null,function*(){try{return yield t(),null}catch(l){return e(l,s)}}),[e]);return{handleError:e,handleAsyncError:t}}class ht{static sanitizeInput(e){return"string"!=typeof e?"":e.trim().replace(/[<>]/g,"").substring(0,this.INPUT_LIMITS.TEXT_MEDIUM)}static sanitizeUrl(e){if("string"!=typeof e)return"";try{const t=new URL(e);return["http:","https:"].includes(t.protocol)?t.toString().substring(0,this.INPUT_LIMITS.URL):""}catch(t){return""}}static sanitizeEmail(e){return"string"!=typeof e?"":e.trim().toLowerCase().substring(0,this.INPUT_LIMITS.EMAIL)}static sanitizePhone(e){return"string"!=typeof e?"":e.trim().replace(/[^\d\+\-\(\)\s]/g,"").substring(0,this.INPUT_LIMITS.PHONE)}}d(ht,"INPUT_LIMITS",{TEXT_SHORT:255,TEXT_MEDIUM:1e3,TEXT_LONG:5e3,EMAIL:320,PHONE:20,URL:2048});class yt{static validateEmail(e){const t=[];if(!e||""===e.trim())return t.push("Email is required"),{isValid:!1,errors:t};return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)||t.push("Please enter a valid email address"),e.length>320&&t.push("Email address is too long"),{isValid:0===t.length,errors:t}}static validatePhone(e){const t=[];if(!e||""===e.trim())return t.push("Phone number is required"),{isValid:!1,errors:t};const s=e.replace(/\D/g,"");return s.length<10&&t.push("Phone number must be at least 10 digits"),s.length>15&&t.push("Phone number is too long"),{isValid:0===t.length,errors:t}}static validateUrl(e,t=!1){const s=[];if(!e||""===e.trim())return t&&s.push("URL is required"),{isValid:!t,errors:s};try{new URL(e)}catch(l){s.push("Please enter a valid URL")}return{isValid:0===s.length,errors:s}}static validateText(e,t={}){const s=[],{required:l=!1,maxLength:r=1e3,fieldName:a="Field"}=t;return e&&""!==e.trim()?(e.length>r&&s.push(`${a} must be less than ${r} characters`),{isValid:0===s.length,errors:s}):(l&&s.push(`${a} is required`),{isValid:!l,errors:s})}static validateCampaignData(e){const t=[];if(e.offer&&""!==e.offer.trim()||t.push("Campaign offer is required"),e.calendar_url&&""!==e.calendar_url.trim()){this.validateUrl(e.calendar_url,!0).isValid||t.push("Please enter a valid calendar URL")}else t.push("Calendar URL is required");return{isValid:0===t.length,errors:t}}}function pt({title:e,message:t,type:s="error",onRetry:l,onDismiss:r,className:a=""}){const{theme:o}=gt(),i=(()=>{switch(s){case"warning":case"info":return I;default:return S}})();return st.jsx("div",{className:`rounded-lg border p-4 ${(()=>{switch(s){case"warning":return"gold"===o?"bg-yellow-500/10 border-yellow-500/30 text-yellow-400":"bg-yellow-50 border-yellow-200 text-yellow-800";case"info":return"gold"===o?"bg-blue-500/10 border-blue-500/30 text-blue-400":"bg-blue-50 border-blue-200 text-blue-800";default:return"gold"===o?"bg-red-500/10 border-red-500/30 text-red-400":"bg-red-50 border-red-200 text-red-800"}})()} ${a}`,children:st.jsxs("div",{className:"flex items-start",children:[st.jsx("div",{className:"flex-shrink-0",children:st.jsx(i,{className:"h-5 w-5"})}),st.jsxs("div",{className:"ml-3 flex-1",children:[e&&st.jsx("h3",{className:"text-sm font-medium mb-1",children:e}),st.jsx("p",{className:"text-sm",children:t})]}),st.jsxs("div",{className:"ml-3 flex space-x-2",children:[l&&st.jsx("button",{onClick:l,className:"flex-shrink-0 hover:opacity-70 transition-opacity",title:"Retry",children:st.jsx(C,{className:"h-4 w-4"})}),r&&st.jsx("button",{onClick:r,className:"flex-shrink-0 hover:opacity-70 transition-opacity",title:"Dismiss",children:st.jsx(S,{className:"h-4 w-4"})})]})]})})}function bt({size:e="md",message:t,className:s=""}){const{theme:l}=gt();return st.jsxs("div",{className:`flex flex-col items-center justify-center ${s}`,children:[st.jsx("div",{className:"relative",children:st.jsx("div",{className:`animate-spin rounded-full ${{sm:"h-6 w-6",md:"h-12 w-12",lg:"h-16 w-16"}[e]} border-4 ${"gold"===l?"border-yellow-400/20 border-t-yellow-400":"border-blue-600/20 border-t-blue-600"}`})}),t&&st.jsx("p",{className:"mt-3 text-sm "+("gold"===l?"text-gray-400":"text-gray-600"),children:t})]})}function ft(){const{user:e,signIn:t,signUp:s,loading:l}=nt(),{theme:r}=gt(),{handleError:a}=ut(),{isLoading:o,error:d,setError:m,executeAsync:x}=xt(),[u,h]=g.useState(""),[p,b]=g.useState(!1),[f,j]=g.useState({email:"",password:"",fullName:""}),[v,w]=g.useState(!1);if(e)return st.jsx(y,{to:"/dashboard",replace:!0});const N=e=>c(this,null,function*(){if(e.preventDefault(),!f.email||!f.password)return void m("Email and password are required");const l=yt.validateEmail(f.email);l.isValid?!p||f.fullName?yield x(()=>c(this,null,function*(){var e,l,r;if(p)try{yield s(f.email,f.password,f.fullName),h("Account created successfully! Please sign in with your credentials."),b(!1),j({email:f.email,password:"",fullName:""})}catch(o){if(o instanceof Error){if((null==(e=o.message)?void 0:e.includes("User already registered"))||(null==(l=o.message)?void 0:l.includes("already exists")))return m("An account with this email already exists. Please sign in instead."),b(!1),void j({email:f.email,password:"",fullName:""});throw new Error(o.message)}throw new Error("Registration failed")}else try{yield t(f.email,f.password)}catch(o){if((null==(r=null==o?void 0:o.message)?void 0:r.includes("Email not confirmed"))||"email_not_confirmed"===(null==o?void 0:o.code)||(null==o?void 0:o.body)&&o.body.includes("email_not_confirmed"))return void m("Please verify your email address. Check your inbox for a confirmation email and click the verification link before signing in.");const e=a(o,"sign-in");return void m(e.message)}}),{errorMessage:null}):m("Full name is required for registration"):m(l.errors[0])}),k=e=>{const t=ht.sanitizeInput(e.target.value);j(n(i({},f),{[e.target.name]:t})),d&&m(""),u&&h("")},_=()=>{b(!p),m(""),h(""),j({email:"",password:"",fullName:""})};return l?st.jsx("div",{className:"min-h-screen flex items-center justify-center "+("gold"===r?"bg-gradient-to-br from-black via-gray-900 to-black":"bg-gray-50"),children:st.jsx(bt,{size:"lg",message:"Loading authentication..."})}):"gold"===r?st.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-black via-gray-900 to-black py-12 px-4 sm:px-6 lg:px-8",children:[st.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[st.jsx("div",{className:"absolute top-1/4 left-1/4 w-64 h-64 bg-yellow-400/5 rounded-full blur-3xl"}),st.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-yellow-600/5 rounded-full blur-3xl"})]}),st.jsxs("div",{className:"max-w-md w-full space-y-8 relative z-10",children:[st.jsxs("div",{className:"text-center",children:[st.jsx("div",{className:"mx-auto h-16 w-16 gold-gradient rounded-xl flex items-center justify-center shadow-2xl mb-6",children:st.jsx(E,{className:"h-8 w-8 text-black"})}),st.jsx("h2",{className:"mt-6 text-4xl font-bold gold-text-gradient",children:p?"Join the Elite":"Welcome Back"}),st.jsx("p",{className:"mt-2 text-sm text-gray-400",children:p?"Start your premium outreach journey":"Access your elite dashboard"}),st.jsxs("div",{className:"mt-6 flex justify-center space-x-6",children:[st.jsxs("div",{className:"flex items-center text-xs text-gray-400",children:[st.jsx(A,{className:"h-3 w-3 text-yellow-400 mr-1"}),"Premium AI"]}),st.jsxs("div",{className:"flex items-center text-xs text-gray-400",children:[st.jsx(q,{className:"h-3 w-3 text-yellow-400 mr-1"}),"Elite Results"]}),st.jsxs("div",{className:"flex items-center text-xs text-gray-400",children:[st.jsx(E,{className:"h-3 w-3 text-yellow-400 mr-1"}),"VIP Support"]})]})]}),st.jsxs("form",{className:"mt-8 space-y-6",onSubmit:N,children:[st.jsxs("div",{className:"space-y-4",children:[p&&st.jsxs("div",{children:[st.jsx("label",{htmlFor:"fullName",className:"sr-only",children:"Full Name"}),st.jsxs("div",{className:"relative",children:[st.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:st.jsx(D,{className:"h-5 w-5 text-yellow-400"})}),st.jsx("input",{id:"fullName",name:"fullName",type:"text",required:p,value:f.fullName,onChange:k,className:"appearance-none relative block w-full pl-10 pr-3 py-3 border border-yellow-400/30 placeholder-gray-500 text-gray-200 rounded-lg bg-black/50 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:border-transparent focus:z-10 sm:text-sm",placeholder:"Full Name"})]})]}),st.jsxs("div",{children:[st.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email address"}),st.jsxs("div",{className:"relative",children:[st.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:st.jsx(L,{className:"h-5 w-5 text-yellow-400"})}),st.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:f.email,onChange:k,className:"appearance-none relative block w-full pl-10 pr-3 py-3 border border-yellow-400/30 placeholder-gray-500 text-gray-200 rounded-lg bg-black/50 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:border-transparent focus:z-10 sm:text-sm",placeholder:"Email address"})]})]}),st.jsxs("div",{children:[st.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),st.jsxs("div",{className:"relative",children:[st.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:st.jsx(T,{className:"h-5 w-5 text-yellow-400"})}),st.jsx("input",{id:"password",name:"password",type:v?"text":"password",required:!0,value:f.password,onChange:k,className:"appearance-none relative block w-full pl-10 pr-10 py-3 border border-yellow-400/30 placeholder-gray-500 text-gray-200 rounded-lg bg-black/50 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:border-transparent focus:z-10 sm:text-sm",placeholder:"Password"}),st.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:st.jsx("button",{type:"button",onClick:()=>w(!v),className:"text-yellow-400 hover:text-yellow-300",children:v?st.jsx(P,{className:"h-5 w-5"}):st.jsx(R,{className:"h-5 w-5"})})})]})]})]}),d&&st.jsx(pt,{message:d,onDismiss:()=>m("")}),u&&st.jsx("div",{className:"rounded-lg border p-4 "+("gold"===r?"bg-green-500/10 border-green-500/30 text-green-400":"bg-green-50 border-green-200 text-green-800"),children:st.jsxs("div",{className:"flex items-start",children:[st.jsx("div",{className:"flex-shrink-0",children:st.jsx($,{className:"h-5 w-5"})}),st.jsx("div",{className:"ml-3",children:st.jsx("p",{className:"text-sm font-medium",children:u})}),st.jsx("button",{onClick:()=>h(""),className:"ml-auto text-current hover:opacity-70",children:"×"})]})}),st.jsx("div",{children:st.jsx("button",{type:"submit",disabled:o,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-bold rounded-lg text-black gold-gradient hover-gold focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-400 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg",children:o?st.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-black"}):p?st.jsxs(st.Fragment,{children:[st.jsx(E,{className:"h-4 w-4 mr-2"}),"Join Elite"]}):st.jsxs(st.Fragment,{children:[st.jsx(q,{className:"h-4 w-4 mr-2"}),"Access Dashboard"]})})}),st.jsx("div",{className:"text-center",children:st.jsx("button",{type:"button",onClick:_,className:"text-sm text-yellow-400 hover:text-yellow-300 transition-colors",children:p?"Already elite? Sign in":"Ready to join the elite? Sign up"})})]})]})]}):st.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-white to-blue-50 py-12 px-4 sm:px-6 lg:px-8",children:st.jsxs("div",{className:"max-w-md w-full space-y-8",children:[st.jsxs("div",{className:"text-center",children:[st.jsx("div",{className:"mx-auto h-12 w-12 bg-blue-600 rounded-xl flex items-center justify-center",children:st.jsx(L,{className:"h-6 w-6 text-white"})}),st.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:p?"Create your account":"Welcome back"}),st.jsx("p",{className:"mt-2 text-sm text-gray-600",children:p?"Start your cold outreach journey":"Sign in to your account"})]}),st.jsxs("form",{className:"mt-8 space-y-6",onSubmit:N,children:[st.jsxs("div",{className:"space-y-4",children:[p&&st.jsxs("div",{children:[st.jsx("label",{htmlFor:"fullName",className:"sr-only",children:"Full Name"}),st.jsxs("div",{className:"relative",children:[st.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:st.jsx(D,{className:"h-5 w-5 text-gray-400"})}),st.jsx("input",{id:"fullName",name:"fullName",type:"text",required:p,value:f.fullName,onChange:k,className:"appearance-none relative block w-full pl-10 pr-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:z-10 sm:text-sm",placeholder:"Full Name"})]})]}),st.jsxs("div",{children:[st.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email address"}),st.jsxs("div",{className:"relative",children:[st.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:st.jsx(L,{className:"h-5 w-5 text-gray-400"})}),st.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:f.email,onChange:k,className:"appearance-none relative block w-full pl-10 pr-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:z-10 sm:text-sm",placeholder:"Email address"})]})]}),st.jsxs("div",{children:[st.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),st.jsxs("div",{className:"relative",children:[st.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:st.jsx(T,{className:"h-5 w-5 text-gray-400"})}),st.jsx("input",{id:"password",name:"password",type:v?"text":"password",required:!0,value:f.password,onChange:k,className:"appearance-none relative block w-full pl-10 pr-10 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:z-10 sm:text-sm",placeholder:"Password"}),st.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:st.jsx("button",{type:"button",onClick:()=>w(!v),className:"text-gray-400 hover:text-gray-600",children:v?st.jsx(P,{className:"h-5 w-5"}):st.jsx(R,{className:"h-5 w-5"})})})]})]})]}),d&&st.jsx(pt,{message:d,onDismiss:()=>m("")}),u&&st.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded-lg text-sm flex items-start",children:[st.jsx($,{className:"h-5 w-5 mr-2 flex-shrink-0 mt-0.5"}),st.jsx("div",{className:"flex-1",children:u}),st.jsx("button",{onClick:()=>h(""),className:"ml-2 text-green-600 hover:text-green-800",children:"×"})]}),st.jsx("div",{children:st.jsx("button",{type:"submit",disabled:o,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:o?st.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):p?"Create Account":"Sign In"})}),st.jsx("div",{className:"text-center",children:st.jsx("button",{type:"button",onClick:_,className:"text-sm text-blue-600 hover:text-blue-500",children:p?"Already have an account? Sign in":"Don't have an account? Sign up"})})]})]})})}function jt(){var e;const{user:t,signOut:s,loading:l}=nt(),{theme:r}=gt(),a=p(),[o,i]=x.useState(!1);if(l)return st.jsx("div",{className:"min-h-screen flex items-center justify-center "+("gold"===r?"bg-gradient-to-br from-black via-gray-900 to-black":"bg-gray-50"),children:st.jsxs("div",{className:"text-center",children:[st.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-transparent mx-auto mb-4 "+("gold"===r?"border-t-yellow-400":"border-t-blue-600")}),st.jsx("p",{className:"text-sm "+("gold"===r?"text-gray-400":"text-gray-600"),children:"Loading application..."}),st.jsx("p",{className:"text-xs mt-2 text-gray-500",children:"If this takes too long, try refreshing the page"})]})});if(!t)return st.jsx(y,{to:"/auth",replace:!0});const n=[{name:"Dashboard",href:"/dashboard",icon:F},{name:"Chat",href:"/targeting",icon:O},{name:"Lists",href:"/lists",icon:M},{name:"Campaigns",href:"/campaigns",icon:z},{name:"CRM",href:"/booked",icon:O},{name:"Settings",href:"/settings",icon:U}];return st.jsxs("div",{className:"min-h-screen relative "+("gold"===r?"bg-gradient-to-br from-black via-gray-900 to-black":"bg-gray-50"),children:[st.jsxs("div",{className:`fixed left-0 top-0 h-full z-30 transition-all duration-300 ease-in-out ${o?"w-64":"w-16"} ${"gold"===r?"bg-black border-r border-yellow-400/20":"bg-white border-r border-gray-200"}`,onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:[st.jsx("div",{className:"flex items-center justify-center h-16 border-b "+("gold"===r?"border-yellow-400/20":"border-gray-200"),children:st.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center "+("gold"===r?"gold-gradient":"bg-blue-600"),children:st.jsx(R,{className:"h-6 w-6 "+("gold"===r?"text-black":"text-white")})})}),st.jsx("nav",{className:"mt-6 px-3 overflow-hidden",children:st.jsx("div",{className:"space-y-1",children:n.map(e=>{const t=e.icon,s=a.pathname===e.href||"/dashboard"!==e.href&&a.pathname.startsWith(e.href);return st.jsxs(b,{to:e.href,className:"group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200 relative "+(s?"gold"===r?"gold-gradient text-black":"bg-blue-50 text-blue-700":"gold"===r?"text-gray-300 hover:text-yellow-400 hover:bg-yellow-400/10":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),title:o?void 0:e.name,children:[st.jsx(t,{className:"mr-3 h-5 w-5 "+(s?"gold"===r?"text-black":"text-blue-700":"gold"===r?"text-gray-400 group-hover:text-yellow-400":"text-gray-400 group-hover:text-gray-500")}),st.jsx("span",{className:"ml-3 whitespace-nowrap transition-opacity duration-200 "+(o?"opacity-100":"opacity-0"),children:e.name})]},e.name)})})}),st.jsx("div",{className:"absolute bottom-0 w-full p-4 border-t overflow-hidden "+("gold"===r?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center "+("gold"===r?"bg-yellow-400/20":"bg-gray-100"),children:st.jsx(D,{className:"h-5 w-5 "+("gold"===r?"text-yellow-400":"text-gray-600")})}),st.jsxs("div",{className:"ml-3 flex-1 transition-opacity duration-200 "+(o?"opacity-100":"opacity-0"),children:[st.jsx("p",{className:"text-sm font-medium "+("gold"===r?"text-gray-200":"text-gray-900"),children:(null==(e=t.user_metadata)?void 0:e.full_name)||"User"}),st.jsx("p",{className:"text-xs "+("gold"===r?"text-gray-400":"text-gray-500"),children:"Member"})]}),st.jsx("button",{onClick:()=>c(this,null,function*(){try{yield s()}catch(e){console.error("Error signing out:",e)}}),className:`p-2 rounded-lg transition-all duration-200 ${o?"opacity-100":"opacity-0"} ${"gold"===r?"text-gray-400 hover:text-red-400 hover:bg-red-400/10":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:"Sign out",children:st.jsx(B,{className:"h-4 w-4"})})]})})]}),st.jsx("div",{className:"flex-1 overflow-hidden ml-16",children:st.jsx("main",{className:"py-6 px-4 sm:px-6 lg:px-8 min-h-screen",children:st.jsx(f,{})})})]})}function vt(){var e;const{user:t}=nt(),{theme:s}=gt(),[l,r]=g.useState([]),[a,o]=g.useState({totalCampaigns:0,activeCampaigns:0,totalLeads:0,bookedLeads:0,totalReplies:0,callsMade:0,smssSent:0,whatsappSent:0,emailsSent:0,responseRate:0,conversionRate:0}),[i,n]=g.useState([]),[d,m]=g.useState(!0),[x,u]=g.useState("");g.useEffect(()=>{t&&h()},[t]);const h=()=>c(this,null,function*(){try{if(!t)return;m(!0),u("");const{data:e,error:s}=yield at.from("campaigns").select("*").eq("user_id",t.id).order("created_at",{ascending:!1});if(s)throw s;const[l,a,i,d]=yield Promise.all([at.from("uploaded_leads").select("id",{count:"exact"}).eq("user_id",t.id),at.from("bookings").select("id",{count:"exact"}).eq("user_id",t.id),at.from("conversation_history").select("campaign_id, channel, from_role").in("campaign_id",(null==e?void 0:e.map(e=>e.id))||[]),at.from("email_tracking").select("campaign_id").eq("user_id",t.id)]),c=l.count||0,g=a.count||0,x=i.data||[],h=d.data||[],y=x.filter(e=>"vapi"===e.channel&&"ai"===e.from_role).length,p=x.filter(e=>"sms"===e.channel&&"ai"===e.from_role).length,b=x.filter(e=>"whatsapp"===e.channel&&"ai"===e.from_role).length,f=h.length,j=x.filter(e=>"lead"===e.from_role).length,v=y+p+b+f,w=v>0?j/v*100:0,N=c>0?g/c*100:0,k=[];for(const t of e||[]){const{data:e}=yield at.from("uploaded_leads").select("id").eq("campaign_id",t.id),s=x.filter(e=>e.campaign_id===t.id),l=h.filter(e=>e.campaign_id===t.id),{data:r}=yield at.from("bookings").select("id").eq("campaign_id",t.id),a=s.filter(e=>"vapi"===e.channel&&"ai"===e.from_role).length,o=s.filter(e=>"sms"===e.channel&&"ai"===e.from_role).length,i=s.filter(e=>"whatsapp"===e.channel&&"ai"===e.from_role).length,n=l.length,d=s.filter(e=>"lead"===e.from_role).length,c=a+o+i+n,g=(null==e?void 0:e.length)||0,m=(null==r?void 0:r.length)||0;k.push({campaign_id:t.id,campaign_name:t.name||"Untitled Campaign",total_leads:g,calls_made:a,sms_sent:o,whatsapp_sent:i,emails_sent:n,replies:d,bookings:m,response_rate:c>0?d/c*100:0,conversion_rate:g>0?m/g*100:0})}r(e||[]),o({totalCampaigns:(null==e?void 0:e.length)||0,activeCampaigns:(null==e?void 0:e.filter(e=>"active"===e.status).length)||0,totalLeads:c,bookedLeads:g,totalReplies:j,callsMade:y,smssSent:p,whatsappSent:b,emailsSent:f,responseRate:w,conversionRate:N}),n(k)}catch(e){console.error("Dashboard data fetch error:",e),u("Failed to load dashboard data. Please try refreshing the page.")}finally{m(!1)}});return d?st.jsx(bt,{size:"lg",message:"Loading dashboard...",className:"h-64"}):x?st.jsx(pt,{title:"Dashboard Error",message:x,onRetry:h,onDismiss:()=>u(""),className:"m-6"}):st.jsxs("div",{className:"space-y-8",children:[st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{children:[st.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:["gold"===s?st.jsx(E,{className:"h-8 w-8 text-yellow-400"}):st.jsx(F,{className:"h-8 w-8 text-blue-600"}),st.jsx("h1",{className:"text-3xl font-bold "+("gold"===s?"gold-text-gradient":"text-gray-900"),children:"Dashboard"})]}),st.jsxs("p",{className:"gold"===s?"text-gray-400":"text-gray-600",children:["Welcome back, ",(null==(e=null==t?void 0:t.user_metadata)?void 0:e.full_name)||(null==t?void 0:t.email)]})]}),st.jsxs(b,{to:"/campaigns",className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors "+("gold"===s?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[st.jsx(H,{className:"h-4 w-4 mr-2"}),"New Campaign"]})]}),st.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[st.jsx("div",{className:"p-6 rounded-xl border "+("gold"===s?"black-card gold-border":"bg-white border-gray-200"),children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"p-2 rounded-lg "+("gold"===s?"bg-blue-500/20":"bg-blue-100"),children:st.jsx(z,{className:"h-6 w-6 "+("gold"===s?"text-blue-400":"text-blue-600")})}),st.jsxs("div",{className:"ml-4",children:[st.jsx("p",{className:"text-2xl font-bold "+("gold"===s?"text-yellow-400":"text-gray-900"),children:a.totalCampaigns}),st.jsx("p",{className:"text-sm "+("gold"===s?"text-gray-400":"text-gray-600"),children:"Total Campaigns"}),st.jsxs("p",{className:"text-xs text-gray-500",children:[a.activeCampaigns," active"]})]})]})}),st.jsx("div",{className:"p-6 rounded-xl border "+("gold"===s?"black-card gold-border":"bg-white border-gray-200"),children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"p-2 rounded-lg "+("gold"===s?"bg-green-500/20":"bg-green-100"),children:st.jsx(M,{className:"h-6 w-6 "+("gold"===s?"text-green-400":"text-green-600")})}),st.jsxs("div",{className:"ml-4",children:[st.jsx("p",{className:"text-2xl font-bold "+("gold"===s?"text-yellow-400":"text-gray-900"),children:a.totalLeads.toLocaleString()}),st.jsx("p",{className:"text-sm "+("gold"===s?"text-gray-400":"text-gray-600"),children:"Total Leads"}),st.jsx("p",{className:"text-xs text-gray-500",children:"Across all campaigns"})]})]})}),st.jsx("div",{className:"p-6 rounded-xl border "+("gold"===s?"black-card gold-border":"bg-white border-gray-200"),children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"p-2 rounded-lg "+("gold"===s?"bg-purple-500/20":"bg-purple-100"),children:st.jsx(V,{className:"h-6 w-6 "+("gold"===s?"text-purple-400":"text-purple-600")})}),st.jsxs("div",{className:"ml-4",children:[st.jsxs("p",{className:"text-2xl font-bold "+("gold"===s?"text-yellow-400":"text-gray-900"),children:[a.responseRate.toFixed(1),"%"]}),st.jsx("p",{className:"text-sm "+("gold"===s?"text-gray-400":"text-gray-600"),children:"Response Rate"}),st.jsxs("p",{className:"text-xs text-gray-500",children:[a.totalReplies," replies"]})]})]})}),st.jsx("div",{className:"p-6 rounded-xl border "+("gold"===s?"black-card gold-border":"bg-white border-gray-200"),children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"p-2 rounded-lg "+("gold"===s?"bg-orange-500/20":"bg-orange-100"),children:st.jsx(G,{className:"h-6 w-6 "+("gold"===s?"text-orange-400":"text-orange-600")})}),st.jsxs("div",{className:"ml-4",children:[st.jsx("p",{className:"text-2xl font-bold "+("gold"===s?"text-yellow-400":"text-gray-900"),children:a.bookedLeads}),st.jsx("p",{className:"text-sm "+("gold"===s?"text-gray-400":"text-gray-600"),children:"Bookings"}),st.jsxs("p",{className:"text-xs text-gray-500",children:[a.conversionRate.toFixed(1),"% conversion"]})]})]})})]}),st.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[st.jsxs("div",{className:"p-6 rounded-xl border "+("gold"===s?"black-card gold-border":"bg-white border-gray-200"),children:[st.jsxs("div",{className:"flex items-center justify-between mb-6",children:[st.jsx("h3",{className:"text-lg font-semibold "+("gold"===s?"text-gray-200":"text-gray-900"),children:"Outreach Activity"}),st.jsx(W,{className:"h-5 w-5 "+("gold"===s?"text-yellow-400":"text-blue-600")})]}),st.jsxs("div",{className:"space-y-4",children:[st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx(J,{className:"h-5 w-5 "+("gold"===s?"text-yellow-400":"text-green-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Calls Made"})]}),st.jsx("span",{className:"text-lg font-bold "+("gold"===s?"text-yellow-400":"text-green-600"),children:a.callsMade})]}),st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx(O,{className:"h-5 w-5 "+("gold"===s?"text-yellow-400":"text-blue-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:"SMS Sent"})]}),st.jsx("span",{className:"text-lg font-bold "+("gold"===s?"text-yellow-400":"text-blue-600"),children:a.smssSent})]}),st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx(O,{className:"h-5 w-5 "+("gold"===s?"text-yellow-400":"text-emerald-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:"WhatsApp Sent"})]}),st.jsx("span",{className:"text-lg font-bold "+("gold"===s?"text-yellow-400":"text-emerald-600"),children:a.whatsappSent})]}),st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx(L,{className:"h-5 w-5 "+("gold"===s?"text-yellow-400":"text-purple-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Emails Sent"})]}),st.jsx("span",{className:"text-lg font-bold "+("gold"===s?"text-yellow-400":"text-purple-600"),children:a.emailsSent})]})]})]}),st.jsxs("div",{className:"p-6 rounded-xl border "+("gold"===s?"black-card gold-border":"bg-white border-gray-200"),children:[st.jsxs("div",{className:"flex items-center justify-between mb-6",children:[st.jsx("h3",{className:"text-lg font-semibold "+("gold"===s?"text-gray-200":"text-gray-900"),children:"Performance Overview"}),st.jsx(Y,{className:"h-5 w-5 "+("gold"===s?"text-yellow-400":"text-blue-600")})]}),st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{children:[st.jsxs("div",{className:"flex items-center justify-between mb-2",children:[st.jsx("span",{className:"text-sm font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Response Rate"}),st.jsxs("span",{className:"text-sm font-bold "+("gold"===s?"text-yellow-400":"text-blue-600"),children:[a.responseRate.toFixed(1),"%"]})]}),st.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 "+("gold"===s?"bg-gray-700":"bg-gray-200"),children:st.jsx("div",{className:"h-2 rounded-full "+("gold"===s?"gold-gradient":"bg-blue-600"),style:{width:`${Math.min(a.responseRate,100)}%`}})})]}),st.jsxs("div",{children:[st.jsxs("div",{className:"flex items-center justify-between mb-2",children:[st.jsx("span",{className:"text-sm font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Conversion Rate"}),st.jsxs("span",{className:"text-sm font-bold "+("gold"===s?"text-yellow-400":"text-green-600"),children:[a.conversionRate.toFixed(1),"%"]})]}),st.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 "+("gold"===s?"bg-gray-700":"bg-gray-200"),children:st.jsx("div",{className:"h-2 rounded-full "+("gold"===s?"bg-green-400":"bg-green-600"),style:{width:`${Math.min(a.conversionRate,100)}%`}})})]}),st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===s?"bg-yellow-400/10":"bg-blue-50"),children:[st.jsx("div",{className:"text-sm font-medium "+("gold"===s?"text-yellow-400":"text-blue-700"),children:"Total Outreach Messages"}),st.jsx("div",{className:"text-2xl font-bold "+("gold"===s?"text-yellow-400":"text-blue-600"),children:(a.callsMade+a.smssSent+a.whatsappSent+a.emailsSent).toLocaleString()})]})]})]})]}),st.jsxs("div",{className:"rounded-xl border "+("gold"===s?"black-card gold-border":"bg-white border-gray-200"),children:[st.jsx("div",{className:"px-6 py-4 border-b "+("gold"===s?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsx("h2",{className:"text-lg font-semibold "+("gold"===s?"text-gray-200":"text-gray-900"),children:"Campaign Performance"}),st.jsx(b,{to:"/campaigns",className:"text-sm hover:underline "+("gold"===s?"text-yellow-400":"text-blue-600"),children:"View all campaigns"})]})}),st.jsx("div",{className:"p-6",children:0===i.length?st.jsxs("div",{className:"text-center py-12",children:[st.jsx(z,{className:"mx-auto h-12 w-12 mb-4 "+("gold"===s?"text-gray-600":"text-gray-400")}),st.jsx("h3",{className:"text-lg font-medium mb-2 "+("gold"===s?"text-gray-200":"text-gray-900"),children:"No campaigns found"}),st.jsx("p",{className:"mb-6 "+("gold"===s?"text-gray-400":"text-gray-600"),children:"Create your first campaign to start tracking performance."}),st.jsxs(b,{to:"/campaigns",className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors "+("gold"===s?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[st.jsx(H,{className:"h-4 w-4 mr-2"}),"Create Campaign"]})]}):st.jsx("div",{className:"overflow-x-auto",children:st.jsxs("table",{className:"min-w-full",children:[st.jsx("thead",{className:""+("gold"===s?"bg-black/20":"bg-gray-50"),children:st.jsxs("tr",{children:[st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===s?"text-gray-400":"text-gray-500"),children:"Campaign"}),st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===s?"text-gray-400":"text-gray-500"),children:"Stats"}),st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===s?"text-gray-400":"text-gray-500"),children:"Performance"})]})}),st.jsx("tbody",{className:"divide-y "+("gold"===s?"divide-yellow-400/20":"divide-gray-200"),children:i.map(e=>{var t;return st.jsxs("tr",{className:`hover:${"gold"===s?"bg-yellow-400/5":"bg-gray-50"} transition-colors`,children:[st.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center "+("gold"===s?"gold-gradient":"bg-blue-100"),children:st.jsx(z,{className:"h-5 w-5 "+("gold"===s?"text-black":"text-blue-600")})}),st.jsxs("div",{className:"ml-4",children:[st.jsx("div",{className:"text-sm font-medium "+("gold"===s?"text-gray-200":"text-gray-900"),children:e.campaign_name}),st.jsx("div",{className:"text-xs text-gray-500",children:(null==(t=l.find(t=>t.id===e.campaign_id))?void 0:t.status)||"draft"})]})]})}),st.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:st.jsxs("div",{className:"space-y-1",children:[st.jsxs("div",{className:"text-sm font-medium "+("gold"===s?"text-yellow-400":"text-gray-900"),children:[e.total_leads," leads"]}),st.jsxs("div",{className:"text-xs "+("gold"===s?"text-gray-400":"text-gray-600"),children:[e.calls_made+e.sms_sent+e.whatsapp_sent+e.emails_sent," contacted"]})]})}),st.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{className:"space-y-1",children:[st.jsxs("div",{className:"text-sm font-medium "+("gold"===s?"text-green-400":"text-green-600"),children:[e.replies," replies"]}),st.jsxs("div",{className:"text-sm font-medium "+("gold"===s?"text-purple-400":"text-purple-600"),children:[e.bookings," bookings"]})]}),st.jsxs(b,{to:`/campaigns/${e.campaign_id}/edit`,className:"inline-flex items-center px-3 py-1 text-xs rounded-lg transition-colors "+("gold"===s?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-50"),children:[st.jsx(R,{className:"h-3 w-3 mr-1"}),"View"]})]})})]},e.campaign_id)})})]})})})]}),st.jsxs("div",{className:"rounded-xl border "+("gold"===s?"black-card gold-border":"bg-white border-gray-200"),children:[st.jsx("div",{className:"px-6 py-4 border-b "+("gold"===s?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsx("h2",{className:"text-lg font-semibold "+("gold"===s?"text-gray-200":"text-gray-900"),children:"Recent Campaigns"}),st.jsx(b,{to:"/campaigns",className:"text-sm hover:underline "+("gold"===s?"text-yellow-400":"text-blue-600"),children:"View all"})]})}),st.jsx("div",{className:"p-6",children:0===l.length?st.jsxs("div",{className:"text-center py-12",children:[st.jsx(z,{className:"mx-auto h-12 w-12 mb-4 "+("gold"===s?"text-gray-600":"text-gray-400")}),st.jsx("h3",{className:"text-lg font-medium mb-2 "+("gold"===s?"text-gray-200":"text-gray-900"),children:"No campaigns found"}),st.jsx("p",{className:"mb-6 "+("gold"===s?"text-gray-400":"text-gray-600"),children:"Create your first campaign to start tracking performance."}),st.jsxs(b,{to:"/campaigns",className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors "+("gold"===s?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[st.jsx(H,{className:"h-4 w-4 mr-2"}),"Create Campaign"]})]}):st.jsx("div",{className:"space-y-4",children:l.slice(0,5).map(e=>{const t=i.find(t=>t.campaign_id===e.id);return st.jsx(b,{to:`/campaigns/${e.id}/edit`,className:"block p-4 border rounded-lg transition-colors "+("gold"===s?"border-yellow-400/20 hover:bg-yellow-400/5":"border-gray-200 hover:bg-gray-50"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center "+("gold"===s?"gold-gradient":"bg-blue-100"),children:st.jsx(z,{className:"h-5 w-5 "+("gold"===s?"text-black":"text-blue-600")})}),st.jsxs("div",{children:[st.jsx("h3",{className:"font-semibold "+("gold"===s?"text-gray-200":"text-gray-900"),children:e.name||"Untitled Campaign"}),st.jsx("p",{className:"text-sm "+("gold"===s?"text-gray-400":"text-gray-500"),children:e.offer?e.offer.substring(0,80)+(e.offer.length>80?"...":""):"No offer description"})]})]}),st.jsxs("div",{className:"flex items-center space-x-4",children:[t&&st.jsxs("div",{className:"text-right",children:[st.jsxs("div",{className:"text-sm font-medium "+("gold"===s?"text-yellow-400":"text-gray-900"),children:[t.total_leads," leads"]}),st.jsxs("div",{className:"text-xs text-gray-500",children:[t.response_rate.toFixed(1),"% response • ",t.bookings," booked"]})]}),st.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+("active"===e.status?"gold"===s?"bg-green-500/20 text-green-400":"bg-green-100 text-green-800":"gold"===s?"bg-yellow-500/20 text-yellow-400":"bg-yellow-100 text-yellow-800"),children:e.status||"draft"}),st.jsx(K,{className:"h-4 w-4 text-gray-400"})]})]})},e.id)})})})]})]})}function wt(){const{user:e}=nt(),{theme:t}=gt(),[s,l]=g.useState([]),[r,a]=g.useState(!0),[o,d]=g.useState(""),[m,x]=g.useState(!1),[u,h]=g.useState({name:"",offer:"",calendar_url:"",goal:"",conversion_goals:{target_bookings:10,target_response_rate:15,target_conversion_rate:5},outreach_channels:{voice:!1,sms:!1,whatsapp:!1,email:!1}}),[y,p]=g.useState(!1);g.useEffect(()=>{e&&f()},[e]);const f=()=>c(this,null,function*(){if(e)try{const{data:t,error:s}=yield at.from("campaigns").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(s)throw s;l(t||[])}catch(t){console.error("Error fetching campaigns:",t),d("Failed to load campaigns")}finally{a(!1)}}),j=t=>c(this,null,function*(){if(confirm("Are you sure you want to delete this campaign?"))try{const{error:s}=yield at.from("campaigns").delete().eq("id",t).eq("user_id",e.id);if(s)throw s;f()}catch(s){console.error("Error deleting campaign:",s),d("Failed to delete campaign")}}),v=(t,s)=>c(this,null,function*(){const l="active"===s?"paused":"active",r="active"===l?"resume":"pause";if(confirm(`Are you sure you want to ${r} this campaign?`))try{const{error:s}=yield at.from("campaigns").update({status:l}).eq("id",t).eq("user_id",e.id);if(s)throw s;f()}catch(a){console.error("Error updating campaign status:",a),d(`Failed to ${r} campaign`)}});return r?st.jsx("div",{className:"flex items-center justify-center h-64",children:st.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{children:[st.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:["gold"===t?st.jsx(E,{className:"h-8 w-8 text-yellow-400"}):st.jsx(z,{className:"h-8 w-8 text-blue-600"}),st.jsx("h1",{className:"text-3xl font-bold "+("gold"===t?"gold-text-gradient":"text-gray-900"),children:"Campaigns"})]}),st.jsx("p",{className:"gold"===t?"text-gray-400":"text-gray-600",children:"Manage your outreach campaigns and conversion goals"})]}),st.jsxs("button",{onClick:()=>x(!0),className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors "+("gold"===t?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[st.jsx(H,{className:"h-4 w-4 mr-2"}),"New Campaign"]})]}),o&&st.jsx(ErrorMessage,{message:o,onDismiss:()=>d("")}),st.jsxs("div",{className:"rounded-xl border "+("gold"===t?"black-card gold-border":"bg-white border-gray-200"),children:[st.jsx("div",{className:"p-4 border-b "+("gold"===t?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("h2",{className:"text-lg font-medium "+("gold"===t?"text-gray-200":"text-gray-900"),children:["Your Campaigns (",s.length,")"]})}),st.jsx("div",{className:"p-4",children:0===s.length?st.jsxs("div",{className:"text-center py-12",children:[st.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 "+("gold"===t?"bg-yellow-400/20":"bg-blue-100"),children:st.jsx(z,{className:"h-8 w-8 "+("gold"===t?"text-yellow-400":"text-blue-600")})}),st.jsx("h3",{className:"text-lg font-medium mb-2 "+("gold"===t?"text-gray-200":"text-gray-900"),children:"No campaigns yet"}),st.jsx("p",{className:"mb-6 "+("gold"===t?"text-gray-400":"text-gray-600"),children:"Create your first campaign to start outreach"}),st.jsxs("button",{onClick:()=>x(!0),className:"inline-flex items-center px-6 py-3 text-sm font-medium rounded-lg transition-colors "+("gold"===t?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[st.jsx(H,{className:"h-4 w-4 mr-2"}),"Create First Campaign"]})]}):st.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:s.map(e=>st.jsxs("div",{className:"rounded-lg border p-6 transition-all hover:shadow-md "+("gold"===t?"border-yellow-400/20 bg-black/10 hover:bg-yellow-400/5":"border-gray-200 bg-gray-50 hover:bg-gray-100"),children:[st.jsxs("div",{className:"flex items-start justify-between mb-4",children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center "+("gold"===t?"gold-gradient":"bg-blue-100"),children:st.jsx(z,{className:"h-6 w-6 "+("gold"===t?"text-black":"text-blue-600")})}),st.jsxs("div",{children:[st.jsx("h3",{className:"text-lg font-semibold "+("gold"===t?"text-gray-200":"text-gray-900"),children:e.name||"New Campaign"}),st.jsxs("p",{className:"text-sm "+("gold"===t?"text-gray-400":"text-gray-500"),children:["Created ",new Date(e.created_at).toLocaleDateString()]})]})]}),st.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+("active"===e.status?"gold"===t?"bg-green-500/20 text-green-400":"bg-green-100 text-green-800":"gold"===t?"bg-yellow-500/20 text-yellow-400":"bg-yellow-100 text-yellow-800"),children:e.status||"draft"})]}),st.jsx("p",{className:"text-sm mb-4 "+("gold"===t?"text-gray-300":"text-gray-600"),children:e.offer||"No offer description available"}),st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsx("div",{}),st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx(b,{to:`/campaigns/${e.id}/edit`,className:"p-2 rounded-lg transition-colors "+("gold"===t?"text-yellow-400 hover:bg-yellow-400/10":"text-blue-600 hover:bg-blue-100"),title:"Edit campaign",children:st.jsx(X,{className:"h-4 w-4"})}),st.jsx("button",{onClick:()=>v(e.id,e.status),className:"p-2 rounded-lg transition-colors "+("active"===e.status?"gold"===t?"text-orange-400 hover:bg-orange-400/10":"text-orange-600 hover:bg-orange-100":"gold"===t?"text-green-400 hover:bg-green-400/10":"text-green-600 hover:bg-green-100"),title:"active"===e.status?"Pause campaign":"Resume campaign",children:"active"===e.status?st.jsx(S,{className:"h-4 w-4"}):st.jsx(Q,{className:"h-4 w-4"})}),st.jsx("button",{onClick:()=>j(e.id),className:"p-2 rounded-lg transition-colors "+("gold"===t?"text-red-400 hover:bg-red-400/10":"text-red-600 hover:bg-red-50"),title:"Delete campaign",children:st.jsx(Z,{className:"h-4 w-4"})})]})]})]},e.id))})})]}),m&&st.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto "+("gold"===t?"bg-black/75":"bg-gray-900/50"),children:st.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:st.jsxs("div",{className:"w-full max-w-2xl rounded-xl shadow-2xl "+("gold"===t?"black-card gold-border":"bg-white border border-gray-200"),children:[st.jsx("div",{className:"p-6 border-b "+("gold"===t?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsx("h2",{className:"text-xl font-bold "+("gold"===t?"text-gray-200":"text-gray-900"),children:"Create New Campaign"}),st.jsx("button",{onClick:()=>x(!1),className:"p-2 rounded-lg transition-colors "+("gold"===t?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"),children:st.jsx(ee,{className:"h-5 w-5"})})]})}),st.jsx("div",{className:"p-6",children:st.jsxs("form",{onSubmit:t=>c(this,null,function*(){if(t.preventDefault(),e){p(!0),d("");try{const{error:t}=yield at.from("campaigns").insert([{user_id:e.id,name:u.name||u.offer,offer:u.offer,calendar_url:u.calendar_url,goal:u.goal,avatar:JSON.stringify({conversion_goals:u.conversion_goals,outreach_channels:u.outreach_channels}),status:"draft"}]);if(t)throw t;h({name:"",offer:"",calendar_url:"",goal:"",conversion_goals:{target_bookings:10,target_response_rate:15,target_conversion_rate:5},outreach_channels:{voice:!1,sms:!1,whatsapp:!1,email:!1}}),x(!1),f()}catch(s){console.error("Error creating campaign:",s),d("Failed to create campaign")}finally{p(!1)}}}),className:"space-y-4",children:[st.jsxs("div",{className:"space-y-4",children:[st.jsx("h3",{className:"text-lg font-semibold "+("gold"===t?"text-gray-200":"text-gray-900"),children:"Campaign Details"}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===t?"text-gray-300":"text-gray-700"),children:"Campaign Name"}),st.jsx("input",{type:"text",value:u.name,onChange:e=>h(n(i({},u),{name:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===t?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"e.g., Q4 SaaS Founders Outreach"})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===t?"text-gray-300":"text-gray-700"),children:"Offer Description *"}),st.jsx("textarea",{value:u.offer,onChange:e=>h(n(i({},u),{offer:e.target.value})),rows:3,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===t?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"e.g., Free consultation call to discuss your business growth strategy...",required:!0})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===t?"text-gray-300":"text-gray-700"),children:"Calendar URL *"}),st.jsx("input",{type:"url",value:u.calendar_url,onChange:e=>h(n(i({},u),{calendar_url:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===t?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"https://calendly.com/...",required:!0})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===t?"text-gray-300":"text-gray-700"),children:"Campaign Goal"}),st.jsx("textarea",{value:u.goal,onChange:e=>h(n(i({},u),{goal:e.target.value})),rows:3,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===t?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"Describe your campaign objectives..."})]})]}),st.jsxs("div",{className:"space-y-4",children:[st.jsx("h3",{className:"text-lg font-semibold "+("gold"===t?"text-gray-200":"text-gray-900"),children:"Outreach Channels"}),st.jsx("p",{className:"text-sm "+("gold"===t?"text-gray-400":"text-gray-600"),children:"Select which channels you want to use for this campaign"}),st.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[{key:"voice",label:"Voice Calls",icon:J},{key:"sms",label:"SMS",icon:O},{key:"whatsapp",label:"WhatsApp",icon:O},{key:"email",label:"Email",icon:L}].map(e=>{const s=e.icon,l=u.outreach_channels[e.key];return st.jsx("button",{type:"button",onClick:()=>h(n(i({},u),{outreach_channels:n(i({},u.outreach_channels),{[e.key]:!l})})),className:"p-3 rounded-lg border-2 transition-all "+(l?"gold"===t?"border-yellow-400 bg-yellow-400/10":"border-blue-500 bg-blue-50":"gold"===t?"border-gray-600 hover:border-gray-500":"border-gray-200 hover:border-gray-300"),children:st.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[st.jsx(s,{className:"h-5 w-5 "+(l?"gold"===t?"text-yellow-400":"text-blue-600":"gold"===t?"text-gray-400":"text-gray-500")}),st.jsx("span",{className:"text-xs font-medium text-center "+(l?"gold"===t?"text-yellow-400":"text-blue-600":"gold"===t?"text-gray-300":"text-gray-700"),children:e.label})]})},e.key)})})]}),st.jsxs("div",{className:"space-y-4",children:[st.jsx("h3",{className:"text-lg font-semibold "+("gold"===t?"text-gray-200":"text-gray-900"),children:"Conversion Goals"}),st.jsx("p",{className:"text-sm "+("gold"===t?"text-gray-400":"text-gray-600"),children:"Set your target metrics for this campaign"}),st.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===t?"text-gray-300":"text-gray-700"),children:"Target Bookings"}),st.jsxs("div",{className:"relative",children:[st.jsx(G,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 "+("gold"===t?"text-yellow-400":"text-gray-400")}),st.jsx("input",{type:"number",min:"1",value:u.conversion_goals.target_bookings,onChange:e=>h(n(i({},u),{conversion_goals:n(i({},u.conversion_goals),{target_bookings:parseInt(e.target.value)||10})})),className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===t?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"10"})]})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===t?"text-gray-300":"text-gray-700"),children:"Response Rate (%)"}),st.jsxs("div",{className:"relative",children:[st.jsx(te,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 "+("gold"===t?"text-yellow-400":"text-gray-400")}),st.jsx("input",{type:"number",min:"1",max:"100",value:u.conversion_goals.target_response_rate,onChange:e=>h(n(i({},u),{conversion_goals:n(i({},u.conversion_goals),{target_response_rate:parseInt(e.target.value)||15})})),className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===t?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"15"})]})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===t?"text-gray-300":"text-gray-700"),children:"Conversion Rate (%)"}),st.jsxs("div",{className:"relative",children:[st.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 "+("gold"===t?"text-yellow-400":"text-gray-400")}),st.jsx("input",{type:"number",min:"1",max:"100",value:u.conversion_goals.target_conversion_rate,onChange:e=>h(n(i({},u),{conversion_goals:n(i({},u.conversion_goals),{target_conversion_rate:parseInt(e.target.value)||5})})),className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===t?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"5"})]})]})]})]}),st.jsxs("div",{className:"flex space-x-3 pt-4",children:[st.jsx("button",{type:"button",onClick:()=>x(!1),className:"flex-1 px-4 py-2 text-sm rounded-lg transition-colors "+("gold"===t?"text-gray-400 bg-gray-800 border border-gray-600 hover:bg-gray-700":"text-gray-700 bg-gray-200 hover:bg-gray-300"),children:"Cancel"}),st.jsx("button",{type:"submit",disabled:y,className:"flex-1 px-4 py-2 text-sm font-medium rounded-lg transition-colors disabled:opacity-50 "+("gold"===t?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:y?"Creating...":"Create Campaign"})]})]})})]})})})]})}function Nt({isOpen:e,title:t,message:s,confirmText:l="Confirm",cancelText:r="Cancel",type:a="danger",onConfirm:o,onCancel:i,loading:n=!1}){const{theme:d}=gt();if(!e)return null;return st.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto "+("gold"===d?"bg-black/75":"bg-gray-900/50"),children:st.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:st.jsxs("div",{className:"w-full max-w-md rounded-xl shadow-2xl "+("gold"===d?"black-card gold-border":"bg-white border border-gray-200"),children:[st.jsx("div",{className:"p-6 border-b "+("gold"===d?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"p-2 rounded-lg "+("danger"===a?"gold"===d?"bg-red-500/20":"bg-red-100":"warning"===a?"gold"===d?"bg-yellow-500/20":"bg-yellow-100":"gold"===d?"bg-blue-500/20":"bg-blue-100"),children:st.jsx(se,{className:"h-5 w-5 "+("danger"===a?"gold"===d?"text-red-400":"text-red-600":"warning"===a?"gold"===d?"text-yellow-400":"text-yellow-600":"gold"===d?"text-blue-400":"text-blue-600")})}),st.jsx("h3",{className:"text-lg font-semibold "+("gold"===d?"text-gray-200":"text-gray-900"),children:t})]}),st.jsx("button",{onClick:i,disabled:n,className:`p-2 rounded-lg transition-colors ${"gold"===d?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"} disabled:opacity-50`,children:st.jsx(ee,{className:"h-5 w-5"})})]})}),st.jsx("div",{className:"p-6",children:st.jsx("p",{className:"text-sm "+("gold"===d?"text-gray-300":"text-gray-700"),children:s})}),st.jsx("div",{className:"p-6 border-t "+("gold"===d?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex space-x-3",children:[st.jsx("button",{onClick:i,disabled:n,className:`flex-1 px-4 py-2 text-sm rounded-lg transition-colors ${"gold"===d?"text-gray-400 bg-gray-800 border border-gray-600 hover:bg-gray-700":"text-gray-700 bg-gray-200 hover:bg-gray-300"} disabled:opacity-50`,children:r}),st.jsx("button",{onClick:o,disabled:n,className:`flex-1 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${(()=>{switch(a){case"warning":return"gold"===d?"bg-yellow-600 hover:bg-yellow-700 text-black":"bg-yellow-600 hover:bg-yellow-700 text-white";case"info":return"gold"===d?"gold-gradient hover-gold text-black":"bg-blue-600 hover:bg-blue-700 text-white";default:return"bg-red-600 hover:bg-red-700 text-white"}})()} disabled:opacity-50`,children:n?st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),"Loading..."]}):l})]})})]})})})}function kt({campaignId:e}){const{user:t}=nt(),{theme:s}=gt(),[l,r]=g.useState([]),[a,o]=g.useState(!0),[d,m]=g.useState(!1),[x,u]=g.useState(!1),[h,y]=g.useState(!1),[p,b]=g.useState(!1),[f,j]=g.useState(""),[v,w]=g.useState(""),[N,k]=g.useState(""),[_,C]=g.useState(""),[S,I]=g.useState("call"),[E,A]=g.useState(null),[q,D]=g.useState({resource_type:"note",content:"",link_url:"",tags:""});g.useEffect(()=>{T()},[e]);const T=()=>c(this,null,function*(){try{const{data:t,error:s}=yield at.from("training_resources").select("*").eq("campaign_id",e).order("created_at",{ascending:!1});if(s)throw s;r(t||[])}catch(t){console.error("Error fetching training resources:",t)}finally{o(!1)}}),P=e=>c(this,null,function*(){try{const{error:t}=yield at.from("training_resources").delete().eq("id",e);if(t)throw t;T()}catch(t){console.error("Error deleting training resource:",t)}});return a?st.jsx("div",{className:"flex items-center justify-center py-8",children:st.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{children:[st.jsx("h3",{className:"text-lg font-semibold "+("gold"===s?"text-gray-200":"text-gray-900"),children:"AI Training Resources"}),st.jsx("p",{className:"text-sm "+("gold"===s?"text-gray-400":"text-gray-600"),children:"Add notes, links, and files to train your AI assistant"})]}),st.jsxs("button",{onClick:()=>m(!0),className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors "+("gold"===s?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[st.jsx(H,{className:"h-4 w-4 mr-2"}),"Add Resource"]})]}),st.jsx("div",{className:"p-4 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-yellow-400/5":"border-blue-200 bg-blue-50"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{children:[st.jsx("h4",{className:"text-sm font-medium "+("gold"===s?"text-yellow-400":"text-blue-700"),children:"Test Your AI Assistant"}),st.jsx("p",{className:"text-xs mt-1 "+("gold"===s?"text-gray-400":"text-blue-600"),children:"Test your AI caller with your training data before going live"})]}),st.jsxs("button",{onClick:()=>u(!0),className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors "+("gold"===s?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[st.jsx(le,{className:"h-4 w-4 mr-2"}),"Test AI"]})]})}),E&&st.jsx("div",{className:"rounded-lg border p-4 "+(E.success?"gold"===s?"bg-green-500/10 border-green-500/30 text-green-400":"bg-green-50 border-green-200 text-green-800":"gold"===s?"bg-red-500/10 border-red-500/30 text-red-400":"bg-red-50 border-red-200 text-red-800"),children:st.jsxs("div",{className:"flex items-start",children:[st.jsx("div",{className:"flex-shrink-0",children:(E.success,st.jsx(le,{className:"h-5 w-5"}))}),st.jsx("div",{className:"ml-3",children:st.jsx("p",{className:"text-sm font-medium",children:E.message})}),st.jsx("button",{onClick:()=>A(null),className:"ml-auto text-current hover:opacity-70",children:"×"})]})}),0===l.length?st.jsxs("div",{className:"text-center py-8 border-2 border-dashed rounded-lg "+("gold"===s?"border-yellow-400/30 text-gray-400":"border-gray-300 text-gray-500"),children:[st.jsx(re,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),st.jsx("p",{children:"No training resources added yet"}),st.jsx("p",{className:"text-sm mt-1",children:"Add notes, links, or files to help train your AI"})]}):st.jsx("div",{className:"grid gap-4",children:l.map(e=>st.jsx("div",{className:"p-4 rounded-lg border "+("gold"===s?"border-yellow-400/30 bg-black/50":"border-gray-200 bg-white"),children:st.jsxs("div",{className:"flex items-start justify-between",children:[st.jsxs("div",{className:"flex-1",children:[st.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:["url"===e.type?st.jsx(ae,{className:"h-4 w-4 text-blue-500"}):st.jsx(re,{className:"h-4 w-4 text-gray-500"}),st.jsx("span",{className:"text-xs font-medium px-2 py-1 rounded "+("gold"===s?"bg-yellow-400/20 text-yellow-400":"bg-gray-100 text-gray-700"),children:e.type})]}),st.jsx("div",{className:"text-sm "+("gold"===s?"text-gray-300":"text-gray-700"),children:"url"===e.type?st.jsx("a",{href:e.content,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:e.content}):st.jsx("p",{className:"whitespace-pre-wrap",children:e.content})}),st.jsxs("p",{className:"text-xs mt-2 "+("gold"===s?"text-gray-500":"text-gray-400"),children:["Added ",new Date(e.created_at).toLocaleDateString()]})]}),st.jsx("button",{onClick:()=>P(e.id),className:"p-2 rounded-lg transition-colors "+("gold"===s?"text-gray-400 hover:text-red-400 hover:bg-red-400/10":"text-gray-400 hover:text-red-600 hover:bg-red-50"),children:st.jsx(Z,{className:"h-4 w-4"})})]})},e.id))}),d&&st.jsxs("div",{className:"p-6 rounded-lg border "+("gold"===s?"border-yellow-400/30 bg-black/50":"border-gray-200 bg-white"),children:[st.jsx("h4",{className:"text-lg font-medium mb-4 "+("gold"===s?"text-gray-200":"text-gray-900"),children:"Add Training Resource"}),st.jsxs("form",{onSubmit:t=>c(this,null,function*(){t.preventDefault(),y(!0);try{const{data:{user:t}}=yield at.auth.getUser();if(!t)throw new Error("User not authenticated");const s={campaign_id:e,user_id:t.id,type:q.resource_type,content:"url"===q.resource_type?q.link_url:q.content},{error:l}=yield at.from("training_resources").insert([s]);if(l)throw l;D({resource_type:"note",content:"",link_url:"",tags:""}),m(!1),T()}catch(s){console.error("Error saving training resource:",s)}finally{y(!1)}}),className:"space-y-4",children:[st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Resource Type"}),st.jsxs("select",{value:q.resource_type,onChange:e=>D(n(i({},q),{resource_type:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===s?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),children:[st.jsx("option",{value:"note",children:"Note"}),st.jsx("option",{value:"url",children:"URL"}),st.jsx("option",{value:"file",children:"File"})]})]}),"note"===q.resource_type&&st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Content"}),st.jsx("textarea",{rows:4,value:q.content,onChange:e=>D(n(i({},q),{content:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===s?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"Enter training content...",required:!0})]}),"url"===q.resource_type&&st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===s?"text-gray-300":"text-gray-700"),children:"URL"}),st.jsx("input",{type:"url",value:q.link_url,onChange:e=>D(n(i({},q),{link_url:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===s?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"https://...",required:!0})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Tags"}),st.jsx("input",{type:"text",value:q.tags,onChange:e=>D(n(i({},q),{tags:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===s?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"Enter tags separated by commas..."})]}),st.jsxs("div",{className:"flex justify-end space-x-3",children:[st.jsx("button",{type:"button",onClick:()=>m(!1),className:"px-4 py-2 text-sm rounded-lg transition-colors "+("gold"===s?"text-gray-400 bg-gray-800 hover:bg-gray-700":"text-gray-700 bg-gray-200 hover:bg-gray-300"),children:"Cancel"}),st.jsx("button",{type:"submit",disabled:h,className:`inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors ${"gold"===s?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50`,children:h?st.jsxs(st.Fragment,{children:[st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),"Saving..."]}):st.jsxs(st.Fragment,{children:[st.jsx(oe,{className:"h-4 w-4 mr-2"}),"Save Resource"]})})]})]})]}),x&&st.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto "+("gold"===s?"bg-black/75":"bg-gray-900/50"),children:st.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:st.jsxs("div",{className:"w-full max-w-md rounded-xl shadow-2xl "+("gold"===s?"black-card gold-border":"bg-white border border-gray-200"),children:[st.jsx("div",{className:"p-6 border-b "+("gold"===s?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsx("h3",{className:"text-lg font-semibold "+("gold"===s?"text-gray-200":"text-gray-900"),children:"Test AI Assistant"}),st.jsx("button",{onClick:()=>u(!1),className:"p-2 rounded-lg transition-colors "+("gold"===s?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"),children:"×"})]})}),st.jsxs("div",{className:"p-6 space-y-4",children:[st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===s?"text-gray-300":"text-gray-700"),children:"email"===S?"Test Email Address":"Test Phone Number"}),st.jsx("input",{type:"email"===S?"email":"tel",value:"email"===S?_:f,onChange:e=>"email"===S?C(e.target.value):j(e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===s?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"email"===S?"your-email@domain.com":"+1234567890",required:!0}),st.jsx("p",{className:"text-xs mt-1 text-gray-500",children:"email"===S?"Enter your email address to receive a test email (required)":"Enter your phone number to receive a test (required)"})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Contact Name (Optional)"}),st.jsx("input",{type:"text",value:v,onChange:e=>w(e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===s?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"John Doe"})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Company Name (Optional)"}),st.jsx("input",{type:"text",value:N,onChange:e=>k(e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===s?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"Acme Corp"})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Test Type"}),st.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[{key:"call",label:"Call",icon:J},{key:"sms",label:"SMS",icon:O},{key:"whatsapp",label:"WhatsApp",icon:O},{key:"email",label:"Email",icon:L}].map(e=>{const t=e.icon;return st.jsx("button",{onClick:()=>I(e.key),className:"p-2 md:p-3 rounded-lg border-2 transition-all "+(S===e.key?"gold"===s?"border-yellow-400 bg-yellow-400/10":"border-blue-500 bg-blue-50":"gold"===s?"border-gray-600 hover:border-gray-500":"border-gray-200 hover:border-gray-300"),children:st.jsxs("div",{className:"flex flex-col items-center space-y-1 text-center",children:[st.jsx(t,{className:"h-4 w-4 "+(S===e.key?"gold"===s?"text-yellow-400":"text-blue-600":"gold"===s?"text-gray-400":"text-gray-500")}),st.jsx("span",{className:"text-xs font-medium "+(S===e.key?"gold"===s?"text-yellow-400":"text-blue-600":"gold"===s?"text-gray-300":"text-gray-700"),children:e.label})]})},e.key)})})]}),st.jsxs("div",{className:"flex space-x-3 pt-4",children:[st.jsx("button",{onClick:()=>u(!1),className:"flex-1 px-4 py-2 text-sm rounded-lg transition-colors "+("gold"===s?"text-gray-400 bg-gray-800 border border-gray-600 hover:bg-gray-700":"text-gray-700 bg-gray-200 hover:bg-gray-300"),children:"Cancel"}),st.jsx("button",{onClick:()=>c(this,null,function*(){if("email"!==S||_.trim())if("email"===S||f.trim()){b(!0),A(null);try{if(!(yield fetch("https://mazirhx.app.n8n.cloud/webhook/test-ai-outreach",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:null==t?void 0:t.id,campaign_id:e,channel:"call"===S?"voice":S,phone:"email"===S?void 0:f,email:"email"===S?_:void 0,name:v||void 0,company_name:N||void 0})})).ok)throw new Error("Failed to initiate test");A({success:!0,message:`Test ${"call"===S?"voice call":S} initiated successfully! You should receive a ${"call"===S?"call":"message"} shortly.`}),u(!1),j(""),C(""),w(""),k("")}catch(s){A({success:!1,message:`Failed to initiate test ${"call"===S?"call":"email"===S?"email":"message"}. Please try again.`})}finally{b(!1)}}else A({success:!1,message:"Please enter a phone number to test"});else A({success:!1,message:"Please enter an email address to test"})}),disabled:p||("email"===S?!_.trim():!f.trim()),className:`flex-1 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${"gold"===s?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50 disabled:cursor-not-allowed`,children:p?st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),"Testing..."]}):st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx(Q,{className:"h-4 w-4 mr-2"}),"Start Test"]})})]}),st.jsxs("div",{className:"text-xs text-gray-500",children:[st.jsx("p",{className:"font-medium mb-2",children:"Test Information:"}),st.jsxs("ul",{className:"space-y-1",children:[st.jsx("li",{children:"• Test calls will use your AI training resources for context"}),st.jsx("li",{children:"• SMS/WhatsApp tests will send a sample message from your campaign"}),st.jsx("li",{children:"• Email tests will send a sample email using your campaign templates"}),st.jsx("li",{children:"• Make sure your phone/email can receive messages from unknown senders"}),st.jsx("li",{children:"• Test results help you refine your AI training before going live"})]})]})]})]})})})]})}function _t({campaignId:e}){const{user:t}=nt(),{theme:s}=gt(),[l,r]=g.useState({totalLeads:0,callsMade:0,smssSent:0,whatsappSent:0,emailsSent:0,bookings:0,responseRate:0,replies:0,emailMetrics:{totalEmails:0,emailsOpened:0,emailsClicked:0,emailsReplied:0,openRate:0,clickRate:0,replyRate:0,bookingRate:0},callMetrics:{totalCalls:0,callsAnswered:0,callDuration:0,replyRate:0,bookingRate:0},campaignChannels:{hasEmail:!1,hasVoice:!1,hasSMS:!1,hasWhatsApp:!1},dailyActivity:[]}),[a,o]=g.useState(!0),[i,n]=g.useState("7d"),[d,m]=g.useState(""),[x,u]=g.useState(""),[h,y]=g.useState(!1),[p,b]=g.useState("bar");g.useEffect(()=>{e&&f()},[e,i]);const f=()=>c(this,null,function*(){try{const t=new Date;let s=new Date;"7d"===i?s.setDate(t.getDate()-7):"30d"===i?s.setDate(t.getDate()-30):s="custom"===i&&d&&x?new Date(d):new Date("2020-01-01");const l="custom"===i&&x?new Date(x):t,{data:a,error:o}=yield at.from("campaign_sequences").select("type").eq("campaign_id",e);if(o)throw o;const n=new Set((null==a?void 0:a.map(e=>e.type))||[]),c={hasEmail:n.has("email"),hasVoice:n.has("call")||n.has("voice"),hasSMS:n.has("sms"),hasWhatsApp:n.has("whatsapp")},{data:g,error:m}=yield at.from("uploaded_leads").select("id").eq("campaign_id",e).gte("created_at",s.toISOString()).lte("created_at",l.toISOString());if(m)throw m;let u=[],h=[],y=0;const{data:p,error:b}=yield at.from("conversation_history").select("*").eq("campaign_id",e).gte("timestamp",s.toISOString()).lte("timestamp",l.toISOString());if(b)throw b;if(u=p||[],c.hasEmail){const{data:t,error:r}=yield at.from("email_tracking").select("\n            *,\n            email_events (\n              event_type,\n              timestamp\n            )\n          ").eq("campaign_id",e).gte("sent_at",s.toISOString()).lte("sent_at",l.toISOString());if(r){console.warn("Email tracking data not available:",r);const{data:t}=yield at.from("lead_activity_history").select("id").eq("campaign_id",e).eq("type","email").gte("executed_at",s.toISOString()).lte("executed_at",l.toISOString());y=(null==t?void 0:t.length)||0}else h=t||[]}const{data:f,error:j}=yield at.from("conversation_history").select("id").eq("campaign_id",e).eq("from_role","lead").gte("timestamp",s.toISOString()).lte("timestamp",l.toISOString());if(j)throw j;const{data:v,error:w}=yield at.from("bookings").select("*").eq("campaign_id",e).gte("created_at",s.toISOString()).lte("created_at",l.toISOString());if(w)throw w;const N=(null==u?void 0:u.filter(e=>"vapi"===e.channel&&"ai"===e.from_role).length)||0,k=(null==u?void 0:u.filter(e=>"sms"===e.channel&&"ai"===e.from_role).length)||0,_=(null==u?void 0:u.filter(e=>"whatsapp"===e.channel&&"ai"===e.from_role).length)||0,C=(null==h?void 0:h.length)||y||(null==u?void 0:u.filter(e=>"email"===e.channel&&"ai"===e.from_role).length)||0,S=(null==f?void 0:f.length)||0,I=N+k+_+C,E=I>0?S/I*100:0,A={totalEmails:C,emailsOpened:0,emailsClicked:0,emailsReplied:0,openRate:0,clickRate:0,replyRate:0,bookingRate:0};if(h&&h.length>0){const e=new Set,t=new Set,s=new Set;h.forEach(l=>{l.email_events&&Array.isArray(l.email_events)&&l.email_events.forEach(r=>{switch(r.event_type){case"open":e.add(l.tracking_id);break;case"click":t.add(l.tracking_id);break;case"reply":s.add(l.tracking_id)}})}),A.emailsOpened=e.size,A.emailsClicked=t.size,A.emailsReplied=s.size,A.openRate=C>0?A.emailsOpened/C*100:0,A.clickRate=C>0?A.emailsClicked/C*100:0,A.replyRate=C>0?A.emailsReplied/C*100:0,A.bookingRate=C>0?100*((null==v?void 0:v.length)||0/C):0}else if(c.hasEmail&&C>0){const e=(null==u?void 0:u.filter(e=>"email"===e.channel&&"lead"===e.from_role).length)||0;A.emailsReplied=e,A.replyRate=C>0?e/C*100:0,A.bookingRate=C>0?((null==v?void 0:v.length)||0)/C*100:0}const q={totalCalls:N,callsAnswered:(null==u?void 0:u.filter(e=>"vapi"===e.channel&&"lead"===e.from_role).length)||0,callDuration:0,replyRate:N>0?S/N*100:0,bookingRate:N>0?100*((null==v?void 0:v.length)||0/N):0};let D=7;"30d"===i?D=30:"custom"===i&&d&&x?D=Math.min(Math.ceil((new Date(x).getTime()-new Date(d).getTime())/864e5)+1,90):"all"===i&&(D=30);const L=[],T="custom"===i&&d?new Date(d):t;for(let e=D-1;e>=0;e--){const t=new Date;"custom"===i&&d?t.setTime(T.getTime()+24*(D-1-e)*60*60*1e3):t.setDate(t.getDate()-e);const s=t.toISOString().split("T")[0],l=(null==u?void 0:u.filter(e=>e.timestamp.startsWith(s)&&"ai"===e.from_role))||[];L.push({date:s,calls:l.filter(e=>"vapi"===e.channel).length,sms:l.filter(e=>"sms"===e.channel).length,whatsapp:l.filter(e=>"whatsapp"===e.channel).length,emails:(null==h?void 0:h.filter(e=>{var t;return null==(t=e.sent_at)?void 0:t.startsWith(s)}).length)||0})}r({totalLeads:(null==g?void 0:g.length)||0,callsMade:N,smssSent:k,whatsappSent:_,emailsSent:C,bookings:(null==v?void 0:v.length)||0,responseRate:E,replies:S,emailMetrics:A,callMetrics:q,campaignChannels:c,dailyActivity:L})}catch(t){console.error("Error fetching analytics:",t)}finally{o(!1)}}),j=Math.max(...l.dailyActivity.map(e=>Math.max(e.calls,e.sms,e.whatsapp,e.emails)),1);return a?st.jsx("div",{className:"p-6 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-gray-50"),children:st.jsxs("div",{className:"animate-pulse",children:[st.jsx("div",{className:"h-4 rounded mb-4 "+("gold"===s?"bg-gray-700":"bg-gray-300")}),st.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[...Array(4)].map((e,t)=>st.jsx("div",{className:"h-20 rounded "+("gold"===s?"bg-gray-700":"bg-gray-300")},t))}),st.jsx("div",{className:"h-64 rounded "+("gold"===s?"bg-gray-700":"bg-gray-300")})]})}):st.jsxs("div",{className:"space-y-6",children:[l.campaignChannels.hasEmail?st.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-white"),children:[st.jsxs("div",{className:"flex items-center",children:[st.jsx(M,{className:"h-5 w-5 mr-2 "+("gold"===s?"text-yellow-400":"text-blue-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Total Leads"})]}),st.jsx("p",{className:"text-2xl font-bold mt-1 "+("gold"===s?"text-yellow-400":"text-blue-600"),children:l.totalLeads})]}),st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-white"),children:[st.jsxs("div",{className:"flex items-center",children:[st.jsx(L,{className:"h-5 w-5 mr-2 "+("gold"===s?"text-yellow-400":"text-purple-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Emails Sent"})]}),st.jsx("p",{className:"text-2xl font-bold mt-1 "+("gold"===s?"text-yellow-400":"text-purple-600"),children:l.emailMetrics.totalEmails})]}),st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-white"),children:[st.jsxs("div",{className:"flex items-center",children:[st.jsx(R,{className:"h-5 w-5 mr-2 "+("gold"===s?"text-yellow-400":"text-blue-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Open Rate"})]}),st.jsxs("p",{className:"text-2xl font-bold mt-1 "+("gold"===s?"text-yellow-400":"text-blue-600"),children:[l.emailMetrics.openRate.toFixed(1),"%"]}),st.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:[l.emailMetrics.emailsOpened," opened"]})]}),st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-white"),children:[st.jsxs("div",{className:"flex items-center",children:[st.jsx(ie,{className:"h-5 w-5 mr-2 "+("gold"===s?"text-yellow-400":"text-green-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Click Rate"})]}),st.jsxs("p",{className:"text-2xl font-bold mt-1 "+("gold"===s?"text-yellow-400":"text-green-600"),children:[l.emailMetrics.clickRate.toFixed(1),"%"]}),st.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:[l.emailMetrics.emailsClicked," clicked"]})]}),st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-white"),children:[st.jsxs("div",{className:"flex items-center",children:[st.jsx(ne,{className:"h-5 w-5 mr-2 "+("gold"===s?"text-yellow-400":"text-orange-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Reply Rate"})]}),st.jsxs("p",{className:"text-2xl font-bold mt-1 "+("gold"===s?"text-yellow-400":"text-orange-600"),children:[l.emailMetrics.replyRate.toFixed(1),"%"]}),st.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:[l.emailMetrics.emailsReplied," replied"]})]})]}):l.campaignChannels.hasVoice?st.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-white"),children:[st.jsxs("div",{className:"flex items-center",children:[st.jsx(M,{className:"h-5 w-5 mr-2 "+("gold"===s?"text-yellow-400":"text-blue-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Total Leads"})]}),st.jsx("p",{className:"text-2xl font-bold mt-1 "+("gold"===s?"text-yellow-400":"text-blue-600"),children:l.totalLeads})]}),st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-white"),children:[st.jsxs("div",{className:"flex items-center",children:[st.jsx(J,{className:"h-5 w-5 mr-2 "+("gold"===s?"text-yellow-400":"text-green-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Calls Made"})]}),st.jsx("p",{className:"text-2xl font-bold mt-1 "+("gold"===s?"text-yellow-400":"text-green-600"),children:l.callMetrics.totalCalls})]}),st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-white"),children:[st.jsxs("div",{className:"flex items-center",children:[st.jsx($,{className:"h-5 w-5 mr-2 "+("gold"===s?"text-yellow-400":"text-blue-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Answer Rate"})]}),st.jsxs("p",{className:"text-2xl font-bold mt-1 "+("gold"===s?"text-yellow-400":"text-blue-600"),children:[l.callMetrics.totalCalls>0?(l.callMetrics.callsAnswered/l.callMetrics.totalCalls*100).toFixed(1):0,"%"]}),st.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:[l.callMetrics.callsAnswered," answered"]})]}),st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-white"),children:[st.jsxs("div",{className:"flex items-center",children:[st.jsx(G,{className:"h-5 w-5 mr-2 "+("gold"===s?"text-yellow-400":"text-orange-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Bookings"})]}),st.jsx("p",{className:"text-2xl font-bold mt-1 "+("gold"===s?"text-yellow-400":"text-orange-600"),children:l.bookings}),st.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:[l.callMetrics.bookingRate.toFixed(1),"% rate"]})]})]}):st.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-white"),children:[st.jsxs("div",{className:"flex items-center",children:[st.jsx(M,{className:"h-5 w-5 mr-2 "+("gold"===s?"text-yellow-400":"text-blue-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Total Leads"})]}),st.jsx("p",{className:"text-2xl font-bold mt-1 "+("gold"===s?"text-yellow-400":"text-blue-600"),children:l.totalLeads})]}),st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-white"),children:[st.jsxs("div",{className:"flex items-center",children:[st.jsx(O,{className:"h-5 w-5 mr-2 "+("gold"===s?"text-yellow-400":"text-purple-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Messages Sent"})]}),st.jsx("p",{className:"text-2xl font-bold mt-1 "+("gold"===s?"text-yellow-400":"text-purple-600"),children:l.callsMade+l.smssSent+l.whatsappSent+l.emailsSent}),st.jsx("p",{className:"text-xs mt-1 text-gray-500",children:"All channels"})]}),st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-white"),children:[st.jsxs("div",{className:"flex items-center",children:[st.jsx(ne,{className:"h-5 w-5 mr-2 "+("gold"===s?"text-yellow-400":"text-green-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Replies"})]}),st.jsx("p",{className:"text-2xl font-bold mt-1 "+("gold"===s?"text-yellow-400":"text-green-600"),children:l.replies}),st.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:[l.responseRate.toFixed(1),"% rate"]})]}),st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-white"),children:[st.jsxs("div",{className:"flex items-center",children:[st.jsx(G,{className:"h-5 w-5 mr-2 "+("gold"===s?"text-yellow-400":"text-orange-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Bookings"})]}),st.jsx("p",{className:"text-2xl font-bold mt-1 "+("gold"===s?"text-yellow-400":"text-orange-600"),children:l.bookings}),st.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:[l.totalLeads>0?(l.bookings/l.totalLeads*100).toFixed(1):0,"% rate"]})]})]}),st.jsxs("div",{className:"p-6 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-gray-50"),children:[st.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[st.jsx("h4",{className:"text-md font-semibold mb-4 sm:mb-0 "+("gold"===s?"text-gray-200":"text-gray-900"),children:"Daily Activity"}),st.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[st.jsx("div",{className:"flex rounded-lg overflow-hidden border",children:["7d","30d","all"].map(e=>st.jsx("button",{onClick:()=>n(e),className:"px-3 py-1 text-xs font-medium transition-colors "+(i===e?"gold"===s?"gold-gradient text-black":"bg-blue-600 text-white":"gold"===s?"text-gray-400 hover:bg-gray-800":"text-gray-600 hover:bg-gray-100"),children:"7d"===e?"7 Days":"30d"===e?"30 Days":"All Time"},e))}),st.jsxs("div",{className:"flex rounded-lg overflow-hidden border",children:[st.jsx("button",{onClick:()=>b("bar"),className:"px-3 py-1 text-xs font-medium transition-colors "+("bar"===p?"gold"===s?"gold-gradient text-black":"bg-blue-600 text-white":"gold"===s?"text-gray-400 hover:bg-gray-800":"text-gray-600 hover:bg-gray-100"),title:"Bar Chart",children:st.jsx(de,{className:"h-4 w-4"})}),st.jsx("button",{onClick:()=>b("line"),className:"px-3 py-1 text-xs font-medium transition-colors "+("line"===p?"gold"===s?"gold-gradient text-black":"bg-blue-600 text-white":"gold"===s?"text-gray-400 hover:bg-gray-800":"text-gray-600 hover:bg-gray-100"),title:"Line Chart",children:st.jsx(ce,{className:"h-4 w-4"})})]})]})]}),st.jsxs("div",{className:"relative",children:["bar"===p?st.jsx("div",{className:"space-y-1",children:st.jsx("div",{className:"flex justify-between items-end h-64 px-2",children:l.dailyActivity.map((e,t)=>{const l=e.calls+e.sms+e.whatsapp+e.emails,r=new Date(e.date),a=r.toLocaleDateString("en-US",{weekday:"short"}),o=r.toLocaleDateString("en-US",{day:"numeric"}),i=200;return st.jsxs("div",{className:"flex flex-col items-center space-y-2 flex-1 max-w-16",children:[st.jsxs("div",{className:"relative flex flex-col justify-end h-48 w-8",children:[e.calls>0&&st.jsx("div",{className:`w-full rounded-t-sm ${"gold"===s?"bg-yellow-400":"bg-blue-500"} transition-all duration-300 hover:opacity-80`,style:{height:e.calls/j*i+"px",minHeight:e.calls>0?"2px":"0"},title:`${e.calls} calls`}),e.sms>0&&st.jsx("div",{className:`w-full ${0===e.calls?"rounded-t-sm":""} ${0===e.whatsapp?"rounded-b-sm":""} ${"gold"===s?"bg-yellow-600":"bg-green-500"} transition-all duration-300 hover:opacity-80`,style:{height:e.sms/j*i+"px",minHeight:e.sms>0?"2px":"0"},title:`${e.sms} SMS`}),e.whatsapp>0&&st.jsx("div",{className:`w-full rounded-b-sm ${"gold"===s?"bg-orange-400":"bg-purple-500"} transition-all duration-300 hover:opacity-80`,style:{height:e.whatsapp/j*i+"px",minHeight:e.whatsapp>0?"2px":"0"},title:`${e.whatsapp} WhatsApp`}),e.emails>0&&st.jsx("div",{className:`w-full ${0===e.whatsapp?"rounded-b-sm":""} ${"gold"===s?"bg-purple-400":"bg-indigo-500"} transition-all duration-300 hover:opacity-80`,style:{height:e.emails/j*i+"px",minHeight:e.emails>0?"2px":"0"},title:`${e.emails} Emails`}),0===l&&st.jsx("div",{className:"w-full h-1 rounded-sm "+("gold"===s?"bg-gray-700":"bg-gray-200")}),l>0&&st.jsx("div",{className:"absolute -top-6 left-1/2 transform -translate-x-1/2 text-xs font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:l})]}),st.jsxs("div",{className:"text-center",children:[st.jsx("div",{className:"text-xs font-medium "+("gold"===s?"text-gray-300":"text-gray-700"),children:a}),st.jsx("div",{className:"text-xs text-gray-500",children:o})]})]},t)})})}):st.jsx("div",{className:"relative h-64",children:st.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 800 200",children:[[0,1,2,3,4].map(e=>st.jsx("line",{x1:"40",y1:40+32*e,x2:"760",y2:40+32*e,stroke:"gold"===s?"#374151":"#e5e7eb",strokeWidth:"1",opacity:"0.5"},e)),[0,1,2,3,4].map(e=>st.jsx("text",{x:"35",y:45+32*e,textAnchor:"end",className:"text-xs "+("gold"===s?"fill-gray-400":"fill-gray-600"),children:Math.round(j/4*(4-e))},e)),l.dailyActivity.length>1&&st.jsxs(st.Fragment,{children:[st.jsx("polyline",{fill:"none",stroke:"gold"===s?"#facc15":"#3b82f6",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",points:l.dailyActivity.map((e,t)=>`${40+t*(720/(l.dailyActivity.length-1))},${168-e.calls/j*128}`).join(" ")}),st.jsx("polyline",{fill:"none",stroke:"gold"===s?"#ca8a04":"#22c55e",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",points:l.dailyActivity.map((e,t)=>`${40+t*(720/(l.dailyActivity.length-1))},${168-e.sms/j*128}`).join(" ")}),st.jsx("polyline",{fill:"none",stroke:"gold"===s?"#fb923c":"#a855f7",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",points:l.dailyActivity.map((e,t)=>`${40+t*(720/(l.dailyActivity.length-1))},${168-e.whatsapp/j*128}`).join(" ")}),l.dailyActivity.map((e,t)=>{const r=40+t*(720/(l.dailyActivity.length-1));return e.calls,e.sms,e.whatsapp,st.jsxs("g",{children:[e.calls>0&&st.jsx("circle",{cx:r,cy:168-e.calls/j*128,r:"4",fill:"gold"===s?"#facc15":"#3b82f6",className:"hover:r-6 transition-all cursor-pointer",children:st.jsx("title",{children:`${e.calls} calls`})}),e.sms>0&&st.jsx("circle",{cx:r,cy:168-e.sms/j*128,r:"4",fill:"gold"===s?"#ca8a04":"#22c55e",className:"hover:r-6 transition-all cursor-pointer",children:st.jsx("title",{children:`${e.sms} SMS`})}),e.whatsapp>0&&st.jsx("circle",{cx:r,cy:168-e.whatsapp/j*128,r:"4",fill:"gold"===s?"#fb923c":"#a855f7",className:"hover:r-6 transition-all cursor-pointer",children:st.jsx("title",{children:`${e.whatsapp} WhatsApp`})})]},t)})]}),l.dailyActivity.map((e,t)=>{const r=40+t*(720/Math.max(l.dailyActivity.length-1,1)),a=new Date(e.date),o=a.toLocaleDateString("en-US",{weekday:"short"}),i=a.toLocaleDateString("en-US",{day:"numeric"});return st.jsxs("g",{children:[st.jsx("text",{x:r,y:"190",textAnchor:"middle",className:"text-xs "+("gold"===s?"fill-gray-400":"fill-gray-600"),children:o}),st.jsx("text",{x:r,y:"200",textAnchor:"middle",className:"text-xs fill-gray-500",children:i})]},t)})]})}),st.jsxs("div",{className:"flex justify-center space-x-6 mt-4",children:[st.jsxs("div",{className:"flex items-center text-xs "+("gold"===s?"text-gray-400":"text-gray-600"),children:[st.jsx("div",{className:"w-3 h-3 rounded-full mr-2 "+("gold"===s?"bg-yellow-400":"bg-blue-500")}),"Calls"]}),st.jsxs("div",{className:"flex items-center text-xs "+("gold"===s?"text-gray-400":"text-gray-600"),children:[st.jsx("div",{className:"w-3 h-3 rounded-full mr-2 "+("gold"===s?"bg-yellow-600":"bg-green-500")}),"SMS"]}),st.jsxs("div",{className:"flex items-center text-xs "+("gold"===s?"text-gray-400":"text-gray-600"),children:[st.jsx("div",{className:"w-3 h-3 rounded-full mr-2 "+("gold"===s?"bg-orange-400":"bg-purple-500")}),"WhatsApp"]}),st.jsxs("div",{className:"flex items-center text-xs "+("gold"===s?"text-gray-400":"text-gray-600"),children:[st.jsx("div",{className:"w-3 h-3 rounded-full mr-2 "+("gold"===s?"bg-purple-400":"bg-indigo-500")}),"Email"]})]})]})]}),st.jsxs("div",{className:"p-6 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-gray-50"),children:[st.jsx("h4",{className:"text-md font-semibold mb-4 "+("gold"===s?"text-gray-200":"text-gray-900"),children:"Campaign Progress"}),st.jsxs("div",{className:"space-y-4",children:[st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsx("span",{className:"text-sm "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Leads Contacted"}),st.jsxs("span",{className:"text-sm font-medium "+("gold"===s?"text-yellow-400":"text-blue-600"),children:[l.callsMade+l.smssSent+l.whatsappSent+l.emailsSent," / ",l.totalLeads]})]}),st.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 "+("gold"===s?"bg-gray-700":"bg-gray-200"),children:st.jsx("div",{className:"h-2 rounded-full "+("gold"===s?"gold-gradient":"bg-blue-600"),style:{width:(l.totalLeads>0?(l.callsMade+l.smssSent+l.whatsappSent+l.emailsSent)/l.totalLeads*100:0)+"%"}})}),st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsx("span",{className:"text-sm "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Conversion to Bookings"}),st.jsxs("span",{className:"text-sm font-medium "+("gold"===s?"text-yellow-400":"text-green-600"),children:[l.totalLeads>0?(l.bookings/l.totalLeads*100).toFixed(1):0,"%"]})]})]})]})]})}function Ct({campaignId:e,onSave:t,campaignStatus:s="draft"}){const{user:l}=nt(),{theme:r}=gt(),{isLoading:a,error:o,success:d,setError:m,setSuccess:x,executeAsync:u}=xt(),[h,y]=g.useState([]),[p,b]=g.useState([]),[f,j]=g.useState(!0);g.useEffect(()=>{e&&l&&(v(),w())},[e,l]);const v=()=>c(this,null,function*(){if(l)try{const{data:e,error:t}=yield at.from("channels").select("*").eq("user_id",l.id).eq("is_active",!0).order("created_at");if(t)throw t;y(e||[])}catch(e){console.error("Error fetching connected channels:",e)}}),w=()=>c(this,null,function*(){try{const{data:t,error:s}=yield at.from("campaign_sequences").select("*").eq("campaign_id",e).order("step_number");if(s)throw s;if(t&&t.length>0){const e=t.map(e=>{const t=h.find(t=>t.channel_type===e.type||"call"===e.type&&"voice"===t.channel_type);return{id:e.id,step_number:e.step_number,channel_id:(null==t?void 0:t.id)||"",channel_type:"call"===e.type?"voice":e.type,provider:(null==t?void 0:t.provider)||"unknown",sender_id:(null==t?void 0:t.sender_id)||null,delay_hours:Math.floor((e.wait_seconds||0)/3600),email_subject:e.email_subject||"",email_template:e.email_template||""}});b(e)}}catch(t){console.error("Error fetching sequence:",t)}finally{j(!1)}}),N=e=>{const t=h.find(t=>t.id===e);if(!t)return;const s={step_number:p.length+1,channel_id:e,channel_type:t.channel_type,provider:t.provider,sender_id:t.sender_id,delay_hours:0===p.length?0:24};b([...p,s])},k=(e,t)=>{const s=[...p],l="up"===t?e-1:e+1;if(l<0||l>=s.length)return;[s[e],s[l]]=[s[l],s[e]];const r=s.map((e,t)=>n(i({},e),{step_number:t+1}));b(r)},_=e=>{switch(e){case"voice":return J;case"sms":case"whatsapp":default:return O;case"email":return L}},C=e=>{switch(e){case"voice":return"gold"===r?"text-yellow-400":"text-blue-600";case"sms":return"gold"===r?"text-yellow-400":"text-green-600";case"whatsapp":return"gold"===r?"text-yellow-400":"text-emerald-600";case"email":return"gold"===r?"text-yellow-400":"text-purple-600";default:return"gold"===r?"text-gray-400":"text-gray-600"}},S=()=>{const e=p.map(e=>e.channel_id);return h.filter(t=>!e.includes(t.id))};return f?st.jsx("div",{className:"flex items-center justify-center h-64",children:st.jsxs("div",{className:"relative",children:[st.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-transparent "+("gold"===r?"border-t-yellow-400 border-r-yellow-500":"border-t-blue-600 border-r-blue-500")}),"gold"===r?st.jsx(E,{className:"absolute inset-0 m-auto h-4 w-4 text-yellow-400"}):st.jsx(q,{className:"absolute inset-0 m-auto h-4 w-4 text-blue-600"})]})}):st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{children:[st.jsx("h3",{className:"text-lg font-semibold "+("gold"===r?"text-gray-200":"text-gray-900"),children:"Campaign Sequence Builder"}),st.jsx("p",{className:"text-sm "+("gold"===r?"text-gray-400":"text-gray-600"),children:"Design your automated outreach sequence using your connected channels"})]}),st.jsxs("button",{onClick:()=>c(this,null,function*(){l&&(yield u(()=>c(this,null,function*(){yield at.from("campaign_sequences").delete().eq("campaign_id",e);const s=p.map(t=>({campaign_id:e,user_id:l.id,step_number:t.step_number,type:"voice"===t.channel_type?"call":t.channel_type,wait_seconds:3600*t.delay_hours,email_subject:t.email_subject||null,email_template:t.email_template||null,prompt:`You are an AI appointment setter. Contact leads via ${t.channel_type} and book qualified appointments.`})),{error:r}=yield at.from("campaign_sequences").insert(s);if(r)throw r;null==t||t()}),{successMessage:"active"===s?"Sequence updated successfully! The new sequence steps have been added to your active campaign and will be applied to future leads.":"Sequence saved successfully! When you publish the campaign, all steps will be pre-scheduled for each lead.",errorMessage:"Failed to save sequence. Please try again."}))}),disabled:a||0===p.length,className:`inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors ${"gold"===r?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50`,children:[a?st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}):st.jsx(oe,{className:"h-4 w-4 mr-2"}),"Save Sequence"]})]}),d&&st.jsx("div",{className:"rounded-lg border p-4 "+("gold"===r?"bg-green-500/10 border-green-500/30 text-green-400":"bg-green-50 border-green-200 text-green-800"),children:st.jsxs("div",{className:"flex items-start",children:[st.jsx("div",{className:"flex-shrink-0",children:st.jsx($,{className:"h-5 w-5"})}),st.jsx("div",{className:"ml-3",children:st.jsx("p",{className:"text-sm font-medium",children:d})}),st.jsx("button",{onClick:()=>x(""),className:"ml-auto text-current hover:opacity-70",children:"×"})]})}),o&&st.jsx(pt,{message:o,onDismiss:()=>m("")}),st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===r?"border-yellow-400/20 bg-black/10":"border-gray-200 bg-gray-50"),children:[st.jsxs("h4",{className:"text-sm font-medium mb-3 "+("gold"===r?"text-gray-300":"text-gray-700"),children:["Connected Channels (",h.length,")"]}),st.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:h.map(e=>{const t=_(e.channel_type),s=p.some(t=>t.channel_id===e.id);return st.jsx("div",{className:"p-3 rounded-lg border transition-all "+(s?"gold"===r?"border-yellow-400/30 bg-yellow-400/10":"border-blue-200 bg-blue-50":"gold"===r?"border-gray-600 bg-black/20":"border-gray-200 bg-white"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx(t,{className:`h-4 w-4 ${C(e.channel_type)}`}),st.jsxs("div",{children:[st.jsxs("div",{className:"text-sm font-medium "+("gold"===r?"text-gray-200":"text-gray-900"),children:[e.provider.charAt(0).toUpperCase()+e.provider.slice(1)," ",e.channel_type.charAt(0).toUpperCase()+e.channel_type.slice(1)]}),st.jsx("div",{className:"text-xs text-gray-500",children:e.sender_id&&`From: ${e.sender_id.substring(0,15)}...`})]})]}),!s&&st.jsx("button",{onClick:()=>N(e.id),className:"p-1 rounded transition-colors "+("gold"===r?"text-yellow-400 hover:bg-yellow-400/10":"text-blue-600 hover:bg-blue-100"),title:"Add to sequence",children:st.jsx(H,{className:"h-4 w-4"})})]})},e.id)})})]}),st.jsxs("div",{className:"space-y-4",children:[st.jsxs("h4",{className:"text-md font-semibold "+("gold"===r?"text-gray-200":"text-gray-900"),children:["Sequence Steps (",p.length,")"]}),0===p.length?st.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg "+("gold"===r?"border-yellow-400/30 text-gray-400":"border-gray-300 text-gray-500"),children:[st.jsx(O,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),st.jsx("h3",{className:"text-lg font-medium mb-2 "+("gold"===r?"text-gray-200":"text-gray-900"),children:"No sequence steps yet"}),st.jsx("p",{className:"mb-4",children:"Add channels from above to build your outreach sequence"})]}):st.jsx("div",{className:"space-y-4",children:p.map((e,t)=>{const s=_(e.channel_type),l=h.find(t=>t.id===e.channel_id);return st.jsxs("div",{className:"p-6 rounded-lg border "+("gold"===r?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-gray-50"),children:[st.jsxs("div",{className:"flex items-center justify-between mb-4",children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold "+("gold"===r?"gold-gradient text-black":"bg-blue-100 text-blue-600"),children:e.step_number}),st.jsx("div",{className:"p-2 rounded-lg "+("gold"===r?"bg-yellow-400/10":"bg-white"),children:st.jsx(s,{className:`h-4 w-4 ${C(e.channel_type)}`})}),st.jsxs("div",{children:[st.jsxs("span",{className:"font-medium "+("gold"===r?"text-gray-200":"text-gray-900"),children:[(null==l?void 0:l.provider.charAt(0).toUpperCase())+(null==l?void 0:l.provider.slice(1))," ",e.channel_type.charAt(0).toUpperCase()+e.channel_type.slice(1)]}),st.jsx("p",{className:"text-sm "+("gold"===r?"text-gray-400":"text-gray-600"),children:e.sender_id&&`From: ${e.sender_id}`})]})]}),st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx("button",{onClick:()=>k(t,"up"),disabled:0===t,className:"p-2 rounded-lg transition-colors disabled:opacity-50 "+("gold"===r?"text-gray-400 hover:bg-gray-800":"text-gray-600 hover:bg-gray-100"),children:st.jsx(ge,{className:"h-4 w-4"})}),st.jsx("button",{onClick:()=>k(t,"down"),disabled:t===p.length-1,className:"p-2 rounded-lg transition-colors disabled:opacity-50 "+("gold"===r?"text-gray-400 hover:bg-gray-800":"text-gray-600 hover:bg-gray-100"),children:st.jsx(me,{className:"h-4 w-4"})}),st.jsx("button",{onClick:()=>(e=>{const t=p.filter((t,s)=>s!==e).map((e,t)=>n(i({},e),{step_number:t+1}));b(t)})(t),className:"p-2 rounded-lg transition-colors "+("gold"===r?"text-red-400 hover:bg-red-400/10":"text-red-600 hover:bg-red-50"),children:st.jsx(Z,{className:"h-4 w-4"})})]})]}),st.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===r?"text-gray-300":"text-gray-700"),children:"Delay (Hours)"}),st.jsxs("div",{className:"relative",children:[st.jsx(xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 "+("gold"===r?"text-yellow-400":"text-gray-400")}),st.jsx("input",{type:"number",min:"0",step:"email"===e.channel_type?"0.1":"1",value:e.delay_hours,onChange:e=>((e,t,s)=>{const l=[...p];l[e]=n(i({},l[e]),{[t]:s}),b(l)})(t,"delay_hours",parseInt(e.target.value)||0),className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===r?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"email"===e.channel_type?"0.1":"24"})]}),st.jsx("p",{className:"text-xs mt-1 text-gray-500",children:0===t?"First step (usually 0)":"email"===e.channel_type?"Hours after previous step (min 0.1 for emails)":"Hours after previous step"}),"email"===e.channel_type&&e.step_number>1&&e.delay_hours<.1&&st.jsxs("div",{className:"mt-2 p-2 rounded-lg flex items-start space-x-2 "+("gold"===r?"bg-yellow-500/10 border border-yellow-500/20":"bg-yellow-50 border border-yellow-200"),children:[st.jsx(se,{className:"h-4 w-4 mt-0.5 "+("gold"===r?"text-yellow-400":"text-yellow-600")}),st.jsxs("div",{className:"text-xs "+("gold"===r?"text-yellow-300":"text-yellow-700"),children:[st.jsx("strong",{children:"Deliverability Warning:"})," Email delays under 5 minutes may trigger spam filters"]})]})]})})]},t)})})]}),S().length>0&&st.jsxs("div",{className:"p-4 rounded-lg border-2 border-dashed "+("gold"===r?"border-yellow-400/30 bg-yellow-400/5":"border-gray-300 bg-gray-50"),children:[st.jsx("h4",{className:"text-sm font-medium mb-3 "+("gold"===r?"text-gray-300":"text-gray-700"),children:"Add More Channels"}),st.jsx("div",{className:"flex flex-wrap gap-2",children:S().map(e=>{const t=_(e.channel_type);return st.jsxs("button",{onClick:()=>N(e.id),className:"inline-flex items-center px-3 py-2 text-sm rounded-lg border transition-colors "+("gold"===r?"border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border-gray-300 text-gray-700 hover:bg-gray-100"),children:[st.jsx(t,{className:"h-4 w-4 mr-2"}),e.provider.charAt(0).toUpperCase()+e.provider.slice(1)," ",e.channel_type.charAt(0).toUpperCase()+e.channel_type.slice(1)]},e.id)})})]})]})}function St({campaign:e,onSave:t}){const{user:s}=nt(),{theme:l}=gt(),{isLoading:r,error:a,setError:o,executeAsync:d}=xt(),[m,x]=g.useState({offer:"",calendar_url:"",goal:"",target_industry:"",target_job_title:"",target_company_size:"",target_pain_points:"",target_description:""});g.useEffect(()=>{if(e){let s={target_industry:"",target_job_title:"",target_company_size:"",target_pain_points:"",target_description:""};if(e.avatar)try{const t=JSON.parse(e.avatar);s={target_industry:t.industry||"",target_job_title:t.jobTitle||"",target_company_size:t.companySize||"",target_pain_points:t.painPoints||"",target_description:t.description||""}}catch(t){s.target_description=e.avatar}x(i({offer:e.offer||"",calendar_url:e.calendar_url||"",goal:e.goal||""},s))}},[e]);const u=(e,t,l,r)=>c(this,null,function*(){if(s)try{const a=((e,t,s)=>{let l="You are an AI appointment setter for this campaign.";return e.industry&&(l+=` You're contacting professionals in the ${e.industry} industry.`),e.jobTitle&&(l+=` Specifically, you're reaching out to ${e.jobTitle}s and similar roles.`),e.companySize&&(l+=` These are typically at companies with ${e.companySize}.`),e.painPoints&&(l+=` They commonly face these challenges: ${e.painPoints}.`),t&&(l+=` Your goal is to book qualified appointments for our offer: ${t}.`),s&&(l+=` Campaign context: ${s}.`),e.description&&(l+=` Additional context about your target audience: ${e.description}.`),l+=" Be professional, empathetic, and focus on understanding their specific needs before presenting our solution. Ask qualifying questions based on their likely pain points and company context.",l})(t,l,r),{data:o}=yield at.from("training_resources").select("id").eq("campaign_id",e).eq("type","note").limit(1);o&&o.length>0?yield at.from("training_resources").update({content:a}).eq("id",o[0].id):yield at.from("training_resources").insert({campaign_id:e,user_id:s.id,type:"note",content:a}),yield at.from("campaign_sequences").update({prompt:a}).eq("campaign_id",e),console.log("AI training prompts updated with client avatar data")}catch(a){console.error("Error updating AI training prompts:",a)}}),h=e=>{x(n(i({},m),{[e.target.name]:e.target.value}))};return st.jsxs("form",{onSubmit:l=>c(this,null,function*(){if(l.preventDefault(),!s)return;const r=Object.entries(m).reduce((e,[t,s])=>(e[t]="string"==typeof s?ht.sanitizeInput(s):s,e),{}),a=yt.validateCampaignData({offer:r.offer,calendar_url:r.calendar_url,goal:r.goal});a.isValid?yield d(()=>c(this,null,function*(){const l={industry:r.target_industry,jobTitle:r.target_job_title,companySize:r.target_company_size,painPoints:r.target_pain_points,description:r.target_description},a=Object.values(l).some(e=>""!==e.trim()),o=a?JSON.stringify(l):null,i={offer:r.offer,calendar_url:ht.sanitizeUrl(r.calendar_url),goal:r.goal,avatar:o},{error:n}=yield at.from("campaigns").update(i).eq("id",e.id).eq("user_id",s.id);if(n)throw n;a&&(yield u(e.id,l,m.offer,m.goal)),null==t||t()}),{successMessage:"Campaign updated successfully!",errorMessage:"Failed to update campaign"}):o(a.errors[0])}),className:"space-y-6",children:[a&&st.jsx(pt,{message:a,onDismiss:()=>o("")}),st.jsxs("div",{className:"rounded-lg p-6 border "+("gold"===l?"bg-yellow-400/10 border-yellow-400/20":"bg-blue-50 border-blue-200"),children:[st.jsx("h3",{className:"text-lg font-semibold mb-4 "+("gold"===l?"text-gray-200":"text-gray-900"),children:"Target Client Avatar"}),st.jsx("p",{className:"text-sm mb-6 "+("gold"===l?"text-gray-400":"text-gray-600"),children:"Define your ideal client to help our AI create more personalized and effective outreach messages."}),st.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[st.jsxs("div",{children:[st.jsx("label",{htmlFor:"target_industry",className:"block text-sm font-medium mb-2 "+("gold"===l?"text-gray-300":"text-gray-700"),children:"Industry"}),st.jsx("input",{type:"text",id:"target_industry",name:"target_industry",value:m.target_industry,onChange:h,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:border-transparent "+("gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"e.g., SaaS, E-commerce, Healthcare"})]}),st.jsxs("div",{children:[st.jsx("label",{htmlFor:"target_job_title",className:"block text-sm font-medium mb-2 "+("gold"===l?"text-gray-300":"text-gray-700"),children:"Job Title / Role"}),st.jsx("input",{type:"text",id:"target_job_title",name:"target_job_title",value:m.target_job_title,onChange:h,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:border-transparent "+("gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"e.g., Marketing Director, CEO, Sales Manager"})]}),st.jsxs("div",{children:[st.jsx("label",{htmlFor:"target_company_size",className:"block text-sm font-medium mb-2 "+("gold"===l?"text-gray-300":"text-gray-700"),children:"Company Size"}),st.jsxs("select",{id:"target_company_size",name:"target_company_size",value:m.target_company_size,onChange:h,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:border-transparent "+("gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),children:[st.jsx("option",{value:"",children:"Select company size"}),st.jsx("option",{value:"1-10 employees",children:"1-10 employees (Startup)"}),st.jsx("option",{value:"11-50 employees",children:"11-50 employees (Small)"}),st.jsx("option",{value:"51-200 employees",children:"51-200 employees (Medium)"}),st.jsx("option",{value:"201-1000 employees",children:"201-1000 employees (Large)"}),st.jsx("option",{value:"1000+ employees",children:"1000+ employees (Enterprise)"})]})]})]}),st.jsxs("div",{className:"space-y-4",children:[st.jsxs("div",{children:[st.jsx("label",{htmlFor:"target_pain_points",className:"block text-sm font-medium mb-2 "+("gold"===l?"text-gray-300":"text-gray-700"),children:"Main Pain Points & Challenges"}),st.jsx("textarea",{id:"target_pain_points",name:"target_pain_points",value:m.target_pain_points,onChange:h,rows:3,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:border-transparent "+("gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"What problems does your ideal client face? What keeps them up at night?"})]}),st.jsxs("div",{children:[st.jsx("label",{htmlFor:"target_description",className:"block text-sm font-medium mb-2 "+("gold"===l?"text-gray-300":"text-gray-700"),children:"Detailed Client Description"}),st.jsx("textarea",{id:"target_description",name:"target_description",value:m.target_description,onChange:h,rows:4,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:border-transparent "+("gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"Provide a detailed description of your ideal client: their goals, motivations, decision-making process, budget, timeline, etc."})]})]})]}),st.jsxs("div",{className:"space-y-6",children:[st.jsx("h3",{className:"text-lg font-semibold "+("gold"===l?"text-gray-200":"text-gray-900"),children:"Campaign Information"}),st.jsxs("div",{children:[st.jsx("label",{htmlFor:"offer",className:"block text-sm font-medium mb-2 "+("gold"===l?"text-gray-300":"text-gray-700"),children:"Campaign Offer *"}),st.jsx("textarea",{id:"offer",name:"offer",value:m.offer,onChange:h,rows:3,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:border-transparent "+("gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"e.g., Free consultation call to discuss your business growth strategy...",required:!0})]}),st.jsxs("div",{children:[st.jsx("label",{htmlFor:"goal",className:"block text-sm font-medium mb-2 "+("gold"===l?"text-gray-300":"text-gray-700"),children:"Description of the Campaign Goal"}),st.jsx("textarea",{id:"goal",name:"goal",value:m.goal,onChange:h,rows:4,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:border-transparent "+("gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"Describe your campaign objectives and goals..."})]}),st.jsxs("div",{children:[st.jsx("label",{htmlFor:"calendar_url",className:"block text-sm font-medium mb-2 "+("gold"===l?"text-gray-300":"text-gray-700"),children:"Calendar URL *"}),st.jsx("input",{type:"url",id:"calendar_url",name:"calendar_url",value:m.calendar_url,onChange:h,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:border-transparent "+("gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"https://calendly.com/..."})]})]}),st.jsx("div",{className:"flex justify-end",children:st.jsxs("button",{type:"submit",disabled:r,className:`inline-flex items-center px-6 py-2 text-sm font-medium rounded-lg transition-colors ${"gold"===l?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50`,children:[r?st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 mr-2 "+("gold"===l?"border-black":"border-white")}):st.jsx(oe,{className:"h-4 w-4 mr-2"}),r?"Saving...":"Save Campaign Details"]})})]})}function It({campaignId:e}){const{user:t}=nt(),{theme:s}=gt(),[l,r]=g.useState([]),[a,o]=g.useState(!0),[i,n]=g.useState(""),[d,m]=g.useState(""),[x,u]=g.useState(""),[h,y]=g.useState([]),[p,b]=g.useState(1),[f,j]=g.useState(0),v=100;g.useEffect(()=>{e&&t&&w()},[e,t,p,d,x]);const w=()=>c(this,null,function*(){if(t)try{o(!0);let s=at.from("uploaded_leads").select("*",{count:"exact"}).eq("campaign_id",e).eq("user_id",t.id);d&&(s=s.or(`name.ilike.%${d}%,email.ilike.%${d}%,phone.ilike.%${d}%,company_name.ilike.%${d}%`)),x&&(s=s.eq("status",x));const l=(p-1)*v,a=l+v-1,{data:i,error:n,count:c}=yield s.range(l,a).order("created_at",{ascending:!1});if(n)throw n;r(i||[]),j(c||0)}catch(s){console.error("Error fetching campaign leads:",s),n("Failed to load campaign leads")}finally{o(!1)}}),N=e=>{switch(e){case"contacted":return"gold"===s?"text-blue-400":"text-blue-600";case"replied":return"gold"===s?"text-green-400":"text-green-600";case"booked":return"gold"===s?"text-purple-400":"text-purple-600";case"not_interested":return"gold"===s?"text-red-400":"text-red-600";default:return"gold"===s?"text-gray-400":"text-gray-600"}},k=Math.ceil(f/v);return a?st.jsx(bt,{size:"lg",message:"Loading campaign leads...",className:"h-64"}):st.jsxs("div",{className:"space-y-6",children:[st.jsx("div",{className:"flex items-center justify-between",children:st.jsxs("div",{children:[st.jsxs("h3",{className:"text-lg font-semibold "+("gold"===s?"text-gray-200":"text-gray-900"),children:["Campaign Leads (",f,")"]}),st.jsx("p",{className:"text-sm "+("gold"===s?"text-gray-400":"text-gray-600"),children:"View and manage leads in this campaign"})]})}),i&&st.jsx(pt,{message:i,onDismiss:()=>n("")}),st.jsx("div",{className:"p-4 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/10":"border-gray-200 bg-gray-50"),children:st.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[st.jsx("div",{className:"flex-1 max-w-md",children:st.jsxs("div",{className:"relative",children:[st.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 "+("gold"===s?"text-yellow-400":"text-gray-400")}),st.jsx("input",{type:"text",placeholder:"Search leads...",value:d,onChange:e=>m(e.target.value),className:`w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 ${"gold"===s?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"} focus:border-transparent`})]})}),st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsxs("select",{value:x,onChange:e=>u(e.target.value),className:`px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${"gold"===s?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"} focus:border-transparent`,children:[st.jsx("option",{value:"",children:"All Statuses"}),st.jsx("option",{value:"pending",children:"Pending"}),st.jsx("option",{value:"contacted",children:"Contacted"}),st.jsx("option",{value:"replied",children:"Replied"}),st.jsx("option",{value:"booked",children:"Booked"}),st.jsx("option",{value:"not_interested",children:"Not Interested"})]}),h.length>0&&st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsxs("button",{onClick:()=>{const e=[["Name","Email","Phone","Company","Job Title","Status","Source","Created"],...(h.length>0?l.filter(e=>h.includes(e.id)):l).map(e=>[e.name||"",e.email||"",e.phone||"",e.company_name||"",e.job_title||"",e.status||"",e.source_platform||"Manual",new Date(e.created_at).toLocaleDateString()])].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n"),t=new Blob([e],{type:"text/csv"}),s=URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download=`campaign_leads_${(new Date).toISOString().split("T")[0]}.csv`,r.click(),URL.revokeObjectURL(s)},className:"inline-flex items-center px-3 py-2 text-sm rounded-lg transition-colors "+("gold"===s?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-50"),children:[st.jsx(he,{className:"h-4 w-4 mr-1"}),"Export (",h.length,")"]}),st.jsxs("button",{onClick:()=>c(this,null,function*(){if(0!==h.length&&confirm(`Are you sure you want to delete ${h.length} selected leads?`))try{const{error:e}=yield at.from("uploaded_leads").delete().in("id",h).eq("user_id",t.id);if(e)throw e;y([]),w()}catch(e){console.error("Error deleting leads:",e),n("Failed to delete leads")}}),className:"inline-flex items-center px-3 py-2 text-sm rounded-lg bg-red-600 text-white hover:bg-red-700 transition-colors",children:[st.jsx(Z,{className:"h-4 w-4 mr-1"}),"Delete (",h.length,")"]})]})]})]})}),st.jsx("div",{className:"rounded-xl border "+("gold"===s?"black-card gold-border":"bg-white border-gray-200"),children:0===l.length?st.jsxs("div",{className:"text-center py-12",children:[st.jsx(M,{className:"h-12 w-12 mx-auto mb-4 "+("gold"===s?"text-gray-600":"text-gray-400")}),st.jsx("h3",{className:"text-lg font-medium mb-2 "+("gold"===s?"text-gray-200":"text-gray-900"),children:"No leads in this campaign"}),st.jsx("p",{className:"mb-6 "+("gold"===s?"text-gray-400":"text-gray-600"),children:d||x?"No leads match your search criteria":"Upload leads to this campaign to get started"}),!d&&!x&&st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===s?"bg-yellow-400/10 border border-yellow-400/20":"bg-blue-50 border border-blue-200"),children:[st.jsx("h4",{className:"text-sm font-medium mb-2 "+("gold"===s?"text-yellow-400":"text-blue-700"),children:"💡 Import Leads from Lists"}),st.jsxs("div",{className:"text-sm "+("gold"===s?"text-yellow-300":"text-blue-600"),children:[st.jsxs("p",{children:["To add leads to this campaign, go to the ",st.jsx("strong",{children:"Lists"})," page where you can:"]}),st.jsxs("ul",{className:"mt-2 space-y-1 ml-4",children:[st.jsx("li",{children:"• Discover high-intent leads using AI"}),st.jsx("li",{children:"• Organize leads into targeted lists"}),st.jsx("li",{children:"• Import leads to this campaign with one click"})]}),st.jsx("div",{className:"mt-3",children:st.jsxs("a",{href:"/lists",className:"inline-flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors "+("gold"===s?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[st.jsx(M,{className:"h-4 w-4 mr-2"}),"Go to Lists"]})})]})]})]}):st.jsxs(st.Fragment,{children:[st.jsx("div",{className:"overflow-x-auto",children:st.jsxs("table",{className:"min-w-full",children:[st.jsx("thead",{className:""+("gold"===s?"bg-black/20":"bg-gray-50"),children:st.jsxs("tr",{children:[st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===s?"text-gray-400":"text-gray-500"),children:st.jsx("input",{type:"checkbox",checked:h.length===l.length&&l.length>0,onChange:()=>{h.length===l.length?y([]):y(l.map(e=>e.id))},className:"rounded"})}),st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===s?"text-gray-400":"text-gray-500"),children:"Lead"}),st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===s?"text-gray-400":"text-gray-500"),children:"Contact Info"}),st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===s?"text-gray-400":"text-gray-500"),children:"Company"}),st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===s?"text-gray-400":"text-gray-500"),children:"Status"}),st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===s?"text-gray-400":"text-gray-500"),children:"Source"}),st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===s?"text-gray-400":"text-gray-500"),children:"Added"})]})}),st.jsx("tbody",{className:"divide-y "+("gold"===s?"divide-yellow-400/20":"divide-gray-200"),children:l.map(e=>{const t=(e=>{switch(e){case"contacted":return $;case"replied":return O;case"booked":return G;case"not_interested":return S;default:return xe}})(e.status);return st.jsxs("tr",{className:`hover:${"gold"===s?"bg-yellow-400/5":"bg-gray-50"} transition-colors`,children:[st.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:st.jsx("input",{type:"checkbox",checked:h.includes(e.id),onChange:()=>{return t=e.id,void y(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"rounded"})}),st.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center "+("gold"===s?"bg-blue-500/20":"bg-blue-100"),children:st.jsx(M,{className:"h-5 w-5 "+("gold"===s?"text-blue-400":"text-blue-600")})}),st.jsxs("div",{className:"ml-4",children:[st.jsx("div",{className:"text-sm font-medium "+("gold"===s?"text-gray-200":"text-gray-900"),children:e.name||"No name"}),e.job_title&&st.jsx("div",{className:"text-sm "+("gold"===s?"text-gray-400":"text-gray-500"),children:e.job_title})]})]})}),st.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:st.jsxs("div",{className:"space-y-1",children:[e.email&&""!==e.email&&"EMPTY"!==e.email?st.jsxs("div",{className:"flex items-center text-sm "+("gold"===s?"text-gray-300":"text-gray-700"),children:[st.jsx(L,{className:"h-3 w-3 mr-2"}),e.email]}):null,e.phone&&""!==e.phone&&"EMPTY"!==e.phone?st.jsxs("div",{className:"flex items-center text-sm "+("gold"===s?"text-gray-300":"text-gray-700"),children:[st.jsx(J,{className:"h-3 w-3 mr-2"}),e.phone]}):null,(!e.email||""===e.email||"EMPTY"===e.email)&&(!e.phone||""===e.phone||"EMPTY"===e.phone)&&st.jsx("span",{className:"text-sm text-gray-500",children:"No contact info"})]})}),st.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.company_name?st.jsxs("div",{className:"flex items-center text-sm "+("gold"===s?"text-gray-300":"text-gray-700"),children:[st.jsx(ye,{className:"h-3 w-3 mr-2"}),e.company_name]}):st.jsx("span",{className:"text-sm text-gray-500",children:"No company"})}),st.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:st.jsxs("div",{className:"flex items-center",children:[st.jsx(t,{className:`h-4 w-4 mr-2 ${N(e.status)}`}),st.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+("booked"===e.status?"gold"===s?"bg-purple-500/20 text-purple-400":"bg-purple-100 text-purple-800":"replied"===e.status?"gold"===s?"bg-green-500/20 text-green-400":"bg-green-100 text-green-800":"contacted"===e.status?"gold"===s?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-800":"not_interested"===e.status?"gold"===s?"bg-red-500/20 text-red-400":"bg-red-100 text-red-800":"gold"===s?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-800"),children:e.status||"pending"})]})}),st.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:st.jsx("div",{className:"text-sm "+("gold"===s?"text-gray-300":"text-gray-700"),children:e.source_platform||"Manual"})}),st.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:st.jsx("div",{className:"text-sm "+("gold"===s?"text-gray-400":"text-gray-500"),children:new Date(e.created_at).toLocaleDateString()})})]},e.id)})})]})}),k>1&&st.jsx("div",{className:"px-6 py-4 border-t "+("gold"===s?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{className:"text-sm "+("gold"===s?"text-gray-400":"text-gray-600"),children:["Showing ",(p-1)*v+1," to ",Math.min(p*v,f)," of ",f," leads"]}),st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx("button",{onClick:()=>b(Math.max(1,p-1)),disabled:1===p,className:"px-3 py-2 text-sm rounded-lg transition-colors disabled:opacity-50 "+("gold"===s?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-50"),children:"Previous"}),st.jsxs("span",{className:"px-3 py-2 text-sm "+("gold"===s?"text-gray-300":"text-gray-700"),children:["Page ",p," of ",k]}),st.jsx("button",{onClick:()=>b(Math.min(k,p+1)),disabled:p===k,className:"px-3 py-2 text-sm rounded-lg transition-colors disabled:opacity-50 "+("gold"===s?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-50"),children:"Next"})]})]})}),h.length>0&&st.jsx("div",{className:"px-6 py-4 border-t "+("gold"===s?"border-yellow-400/20":"border-gray-200"),children:st.jsx("div",{className:"p-4 rounded-lg "+("gold"===s?"bg-yellow-400/10 border border-yellow-400/20":"bg-blue-50 border border-blue-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("span",{className:"text-sm font-medium "+("gold"===s?"text-yellow-400":"text-blue-700"),children:[h.length," leads selected"]}),st.jsx("div",{className:"flex items-center space-x-2",children:st.jsx("button",{onClick:()=>y([]),className:`text-sm ${"gold"===s?"text-gray-400":"text-gray-600"} hover:underline`,children:"Clear selection"})})]})})})]})})]})}function Et(){const{id:e}=j(),t=v(),{user:s}=nt(),{theme:l}=gt();ut();const{isLoading:r,error:a,setError:o,executeAsync:d}=xt(),[m,x]=g.useState(null),[u,h]=g.useState(!1),[y,p]=g.useState([]),[f,w]=g.useState(!1),[N,k]=g.useState(!1),[_,C]=g.useState("analytics");g.useEffect(()=>{e&&s&&I()},[e,s]);const I=()=>c(this,null,function*(){e&&s&&(yield d(()=>c(this,null,function*(){const{data:t,error:l}=yield at.from("campaigns").select("*").eq("id",e).eq("user_id",s.id).single();if(l)throw l;if(!t)throw new Error("Campaign not found");t&&x(t)}),{errorMessage:"Failed to load campaign"}))}),E=()=>c(this,null,function*(){const e=[];if(!s||!m)return["Campaign or user not found"];try{const{data:t}=yield at.from("channels").select("*").eq("user_id",s.id).eq("is_active",!0);t&&0!==t.length||e.push("You must connect at least one communication channel before publishing a campaign. Go to Settings > Channels to set up your integrations.");const{data:l}=yield at.from("uploaded_leads").select("id").eq("campaign_id",m.id).limit(1);l&&0!==l.length||e.push('Campaign must have at least one lead before publishing. Upload leads in the "Upload Leads" tab.'),m.offer&&""!==m.offer.trim()||e.push("Campaign must have an offer description."),m.calendar_url&&""!==m.calendar_url.trim()||e.push("Campaign must have a calendar URL for booking appointments.")}catch(t){console.error("Error validating campaign:",t),e.push("Error validating campaign. Please try again.")}return e}),A=e=>c(this,null,function*(){if(!s)return;const t=[];try{const{data:l}=yield at.from("training_resources").select("content").eq("campaign_id",e).limit(1);let r="You are an AI setter. Your job is to contact leads and book them into a calendar.";r=l&&l.length>0?l[0].content:(null==m?void 0:m.goal)&&""!==m.goal.trim()?`You are an AI appointment setter. ${m.goal} Your job is to contact leads and book qualified appointments for our offer targeting ${(null==m?void 0:m.offer)||"prospects"}.`:`You are an AI setter. Your job is to contact leads and book them into a calendar for our offer: ${(null==m?void 0:m.offer)||"our solution"}. Be professional and focus on qualifying prospects.`;const{data:a}=yield at.from("campaign_sequences").select("id").eq("campaign_id",e).limit(1);a&&0!==a.length||(yield at.from("campaign_sequences").insert({campaign_id:e,user_id:s.id,step_number:1,type:"call",wait_seconds:0,prompt:r}));const{data:o}=yield at.from("training_resources").select("id").eq("campaign_id",e).limit(1);o&&0!==o.length||(yield at.from("training_resources").insert({campaign_id:e,user_id:s.id,type:"note",content:r}));const{data:i}=yield at.from("campaign_sequences").select("*").eq("campaign_id",e).order("step_number");if(!i||0===i.length)throw t.push("No sequence steps found. Please configure your campaign sequence first."),new Error("No sequence steps configured");const{data:n}=yield at.from("uploaded_leads").select("id").eq("campaign_id",e);if(n&&n.length>0){const l=[],r=new Date;for(const t of n)for(const a of i){let o=new Date(r);if(1===a.step_number)o=r;else{let e=0;for(let t=0;t<a.step_number-1;t++){e+=i[t].wait_seconds||0}o=new Date(r.getTime()+1e3*e)}l.push({lead_id:t.id,campaign_id:e,user_id:s.id,step:a.step_number,status:1===a.step_number?"ready":"queued",next_at:o.toISOString(),last_contacted_at:r.toISOString()})}const{data:a}=yield at.from("lead_sequence_progress").select("lead_id, step").eq("campaign_id",e),o=new Set((null==a?void 0:a.map(e=>`${e.lead_id}-${e.step}`))||[]),d=l.filter(e=>!o.has(`${e.lead_id}-${e.step}`));if(d.length>0){const e=100;for(let s=0;s<d.length;s+=e){const l=d.slice(s,s+e),{error:r}=yield at.from("lead_sequence_progress").insert(l);r&&(console.error("Error creating sequence progress batch:",r),t.push(`Failed to set up batch ${Math.floor(s/e)+1} for outreach: ${r.message}`))}}console.log(`Created ${d.length} new sequence progress entries for ${n.length} leads across ${i.length} steps`)}else t.push("No leads found to set up for outreach")}catch(l){throw console.error("Error setting up campaign defaults:",l),l}if(t.length>0)throw new Error(`Setup errors: ${t.join(", ")}`)}),q=t=>c(this,null,function*(){if(!e||!s)return;const l="active"===t?"resume":"pause";if(confirm(`Are you sure you want to ${l} this campaign?`)){k(!0),o("");try{const{error:l}=yield at.from("campaigns").update({status:t}).eq("id",e).eq("user_id",s.id);if(l)throw l;x(e=>e?n(i({},e),{status:t}):null)}catch(r){console.error("Error updating campaign status:",r),o(`Failed to ${l} campaign`)}finally{k(!1)}}});return r&&!m?st.jsx(bt,{size:"lg",message:"Loading campaign...",className:"h-64"}):a&&!m?st.jsx(pt,{title:"Failed to Load Campaign",message:a,onRetry:I,onDismiss:()=>t("/campaigns"),className:"m-6"}):m?st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[st.jsxs("div",{className:"flex items-center space-x-4",children:[st.jsx(b,{to:"/campaigns",className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:st.jsx(pe,{className:"h-5 w-5"})}),st.jsxs("div",{children:[st.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:m.offer||"Untitled Campaign"}),st.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Campaign ID: ",m.id]})]})]}),st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+("active"===m.status?"bg-green-100 text-green-800":"paused"===m.status||"paused"===m.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:m.status||"Draft"}),"active"===(null==m?void 0:m.status)&&st.jsxs("button",{onClick:()=>q("paused"),disabled:u,className:"inline-flex items-center px-4 py-2 rounded-lg transition-colors bg-orange-600 text-white hover:bg-orange-700 disabled:opacity-50",children:[st.jsx(S,{className:"h-4 w-4 mr-2"}),"Pause Campaign"]}),"paused"===(null==m?void 0:m.status)&&st.jsxs("button",{onClick:()=>q("active"),disabled:u,className:"inline-flex items-center px-4 py-2 rounded-lg transition-colors bg-green-600 text-white hover:bg-green-700 disabled:opacity-50",children:[st.jsx(Q,{className:"h-4 w-4 mr-2"}),"Resume Campaign"]}),"draft"===(null==m?void 0:m.status)&&st.jsxs("button",{onClick:()=>w(!0),disabled:u||y.length>0,className:"inline-flex items-center px-4 py-2 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed "+("gold"===l?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[u?st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 mr-2 "+("gold"===l?"border-black":"border-white")}):st.jsx(Q,{className:"h-4 w-4 mr-2"}),u?"Publishing...":"Publish"]})]})]}),a&&st.jsx(pt,{message:a,onDismiss:()=>o("")}),y.length>0&&st.jsx(pt,{title:"Campaign cannot be published",message:y.join(". "),onDismiss:()=>p([])}),st.jsxs("div",{className:`rounded-xl shadow-sm border ${"gold"===l}`,children:[st.jsx("div",{className:"border-b "+("gold"===l?"border-yellow-400/20":"border-gray-200"),children:st.jsx("nav",{className:"flex overflow-x-auto px-4 sm:px-6",children:[{key:"analytics",label:"Campaign Analytics"},{key:"leads",label:"View Leads"},{key:"details",label:"Campaign Details"},{key:"training",label:"AI Training"},{key:"sequence",label:"Sequence Builder"}].map(e=>st.jsx("button",{onClick:()=>C(e.key),className:"py-4 px-4 border-b-2 font-medium text-sm whitespace-nowrap "+(_===e.key?"gold"===l?"border-yellow-400 text-yellow-400":"border-blue-500 text-blue-600":"gold"===l?"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:e.label},e.key))})}),st.jsxs("div",{className:"p-4 sm:p-6",children:["details"===_&&st.jsx(St,{campaign:m,onSave:I}),"analytics"===_&&m&&st.jsx(_t,{campaignId:m.id}),"leads"===_&&m&&st.jsx(It,{campaignId:m.id}),"training"===_&&m&&st.jsx(kt,{campaignId:m.id}),"sequence"===_&&m&&st.jsx(Ct,{campaignId:m.id,campaignStatus:m.status||"draft"})]})]}),st.jsx(Nt,{isOpen:f,title:"Publish Campaign",message:"Are you sure you want to publish this campaign? This will activate automated outreach to all uploaded leads.",confirmText:"Publish Campaign",cancelText:"Cancel",type:"info",onConfirm:()=>c(this,null,function*(){if(w(!1),!e||!s)return;const t=yield E();t.length>0?p(t):(h(!0),p([]),yield d(()=>c(this,null,function*(){yield A(e);const{error:t}=yield at.from("campaigns").update({status:"active"}).eq("id",e).eq("user_id",s.id);if(t)throw t;x(e=>e?n(i({},e),{status:"active"}):null),h(!1)}),{successMessage:"Campaign published successfully! All leads are now ready for automated outreach.",errorMessage:"Failed to publish campaign"}),h(!1))}),onCancel:()=>w(!1),loading:u})]}):st.jsxs("div",{className:"text-center py-12",children:[st.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Campaign not found"}),st.jsxs(b,{to:"/campaigns",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors",children:[st.jsx(pe,{className:"h-4 w-4 mr-2"}),"Back to Campaigns"]})]})}function At(){const[e,t]=g.useState([{id:"1",content:"Hello! I'm your AI training assistant. I can help you create and refine conversation sequences for your cold outreach campaigns. What would you like to work on today?",sender:"ai",timestamp:new Date}]),[s,l]=g.useState(""),[r,a]=g.useState(!1),o=()=>c(this,null,function*(){if(!s.trim())return;const e={id:Date.now().toString(),content:s,sender:"user",timestamp:new Date};t(t=>[...t,e]),l(""),a(!0),setTimeout(()=>{const e={id:(Date.now()+1).toString(),content:"I understand you want to work on that. This feature is currently under development. Soon you'll be able to train your AI caller with custom conversation flows, objection handling, and personalized scripts.",sender:"ai",timestamp:new Date};t(t=>[...t,e]),a(!1)},1500)});return st.jsxs("div",{className:"h-full flex flex-col bg-white",children:[st.jsx("div",{className:"border-b border-gray-200 p-4",children:st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:st.jsx(be,{className:"h-6 w-6 text-blue-600"})}),st.jsxs("div",{children:[st.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"AI Training Center"}),st.jsx("p",{className:"text-sm text-gray-500",children:"Train your AI caller with conversation sequences"})]})]})}),st.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[e.map(e=>st.jsx("div",{className:"flex "+("user"===e.sender?"justify-end":"justify-start"),children:st.jsxs("div",{className:"flex items-start space-x-2 max-w-xs lg:max-w-md "+("user"===e.sender?"flex-row-reverse space-x-reverse":""),children:[st.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center "+("user"===e.sender?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"),children:"user"===e.sender?st.jsx(D,{className:"h-4 w-4"}):st.jsx(be,{className:"h-4 w-4"})}),st.jsxs("div",{className:"px-4 py-2 rounded-lg "+("user"===e.sender?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"),children:[st.jsx("p",{className:"text-sm",children:e.content}),st.jsx("p",{className:"text-xs mt-1 "+("user"===e.sender?"text-blue-100":"text-gray-500"),children:e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},e.id)),r&&st.jsx("div",{className:"flex justify-start",children:st.jsxs("div",{className:"flex items-start space-x-2",children:[st.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:st.jsx(be,{className:"h-4 w-4 text-gray-600"})}),st.jsx("div",{className:"bg-gray-100 px-4 py-2 rounded-lg",children:st.jsxs("div",{className:"flex space-x-1",children:[st.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),st.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),st.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]})})]}),st.jsxs("div",{className:"border-t border-gray-200 p-4",children:[st.jsxs("div",{className:"flex space-x-2",children:[st.jsx("input",{type:"text",value:s,onChange:e=>l(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),o())},placeholder:"Type your message to train the AI...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),st.jsx("button",{onClick:o,disabled:!s.trim()||r,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:st.jsx(fe,{className:"h-4 w-4"})})]}),st.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"🚧 This is a preview of the AI training interface. Full functionality coming soon!"})]})]})}function qt({leadId:e,campaignId:t}){const{user:s}=nt(),{theme:l}=gt(),[r,a]=g.useState([]),[o,i]=g.useState([]),[n,d]=g.useState(!0);g.useEffect(()=>{e&&(m(),x())},[e]);const m=()=>c(this,null,function*(){try{const{data:t,error:s}=yield at.from("conversation_history").select("*").eq("lead_id",e).order("timestamp",{ascending:!1});if(s)throw s;a(t||[]),console.log("Fetched messages for lead:",e,t)}catch(t){console.error("Error fetching messages:",t)}finally{d(!1)}}),x=()=>c(this,null,function*(){try{const{data:t,error:s}=yield at.from("email_tracking").select("\n          tracking_id,\n          email_events (\n            id,\n            event_type,\n            timestamp,\n            ip_address,\n            link_url\n          )\n        ").eq("lead_id",e).order("sent_at",{ascending:!1});if(s)throw s;const l=[];null==t||t.forEach(e=>{e.email_events&&Array.isArray(e.email_events)&&e.email_events.forEach(t=>{l.push({id:t.id,tracking_id:e.tracking_id,event_type:t.event_type,timestamp:t.timestamp,ip_address:t.ip_address,link_url:t.link_url})})}),i(l)}catch(t){console.error("Error fetching email events:",t)}}),u=e=>{switch(e){case"open":return"gold"===l?"text-blue-400":"text-blue-600";case"click":return"gold"===l?"text-green-400":"text-green-600";case"reply":return"gold"===l?"text-purple-400":"text-purple-600";default:return"gold"===l?"text-gray-400":"text-gray-600"}};if(n)return st.jsx("div",{className:"flex items-center justify-center h-32",children:st.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-transparent "+("gold"===l?"border-t-yellow-400":"border-t-blue-600")})});if(0===r.length&&0===o.length)return st.jsxs("div",{className:"text-center py-8",children:[st.jsx(O,{className:"h-12 w-12 mx-auto mb-4 "+("gold"===l?"text-gray-600":"text-gray-400")}),st.jsx("p",{className:"text-sm "+("gold"===l?"text-gray-400":"text-gray-600"),children:"No conversation history yet"})]});const h=[...r.map(e=>({id:e.id,type:"message",timestamp:e.timestamp,data:e})),...o.map(e=>({id:e.id,type:"email_event",timestamp:e.timestamp,data:e}))].sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime());return st.jsxs("div",{className:"space-y-4",children:[st.jsxs("h4",{className:"text-sm font-medium "+("gold"===l?"text-gray-300":"text-gray-700"),children:["Conversation History (",h.length,")"]}),st.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:h.map(e=>{if("message"===e.type){const t=e.data,s=(e=>{switch(e){case"vapi":case"call":return J;default:return O}})(t.channel),r="ai"===t.from_role;return st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===l?"border-yellow-400/20 bg-black/10":"border-gray-200 bg-gray-50"),children:[st.jsxs("div",{className:"flex items-start justify-between mb-3",children:[st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx("div",{className:"p-1.5 rounded-lg "+("gold"===l?r?"bg-yellow-400/20":"bg-blue-400/20":r?"bg-blue-100":"bg-green-100"),children:st.jsx(s,{className:"h-4 w-4 "+("gold"===l?r?"text-yellow-400":"text-blue-400":r?"text-blue-600":"text-green-600")})}),st.jsx("div",{className:"p-1 rounded "+(r?"gold"===l?"bg-yellow-400/10":"bg-blue-50":"gold"===l?"bg-green-400/10":"bg-green-50"),children:r?st.jsx(be,{className:"h-3 w-3 "+("gold"===l?"text-yellow-400":"text-blue-600")}):st.jsx(D,{className:"h-3 w-3 "+("gold"===l?"text-green-400":"text-green-600")})}),st.jsxs("span",{className:"text-sm font-medium capitalize "+("gold"===l?"text-gray-200":"text-gray-900"),children:[r?"AI Agent":"Lead"," • ","vapi"===t.channel?"Call":t.channel]})]}),st.jsxs("span",{className:"text-xs "+("gold"===l?"text-gray-500":"text-gray-400"),children:[new Date(t.timestamp).toLocaleDateString()," ",new Date(t.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),"email"===t.channel&&t.email_subject&&st.jsx("div",{className:"mb-3 p-3 rounded-lg "+("gold"===l?"bg-purple-400/10 border border-purple-400/20":"bg-purple-50 border border-purple-200"),children:st.jsxs("div",{className:"text-sm font-medium "+("gold"===l?"text-purple-400":"text-purple-700"),children:["📧 Subject: ",t.email_subject]})}),st.jsx("div",{className:"p-3 rounded-lg "+("gold"===l?"bg-gray-800/50":"bg-white"),children:"email"===t.channel&&t.email_body?st.jsx("div",{className:"text-sm prose prose-sm max-w-none "+("gold"===l?"prose-invert prose-headings:text-gray-200 prose-p:text-gray-300 prose-a:text-yellow-400":"prose-gray prose-headings:text-gray-900 prose-p:text-gray-700 prose-a:text-blue-600"),dangerouslySetInnerHTML:{__html:t.email_body}}):"email"===t.channel&&t.message?st.jsx("div",{className:"text-sm prose prose-sm max-w-none "+("gold"===l?"prose-invert prose-headings:text-gray-200 prose-p:text-gray-300 prose-a:text-yellow-400":"prose-gray prose-headings:text-gray-900 prose-p:text-gray-700 prose-a:text-blue-600"),dangerouslySetInnerHTML:{__html:t.message}}):t.message?st.jsx("div",{className:"text-sm whitespace-pre-wrap "+("gold"===l?"text-gray-300":"text-gray-700"),children:t.message}):st.jsx("div",{className:"text-sm italic text-gray-500",children:"No message content available"})})]},`msg-${t.id}`)}if("email_event"===e.type){const t=e.data,s=(e=>{switch(e){case"open":return R;case"click":return ie;case"reply":return ne;default:return O}})(t.event_type);return st.jsxs("div",{className:"p-3 rounded-lg border-l-4 "+("gold"===l?"border-blue-400 bg-blue-400/5":"border-blue-500 bg-blue-50"),children:[st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx(s,{className:`h-4 w-4 ${u(t.event_type)}`}),st.jsxs("span",{className:"text-sm font-medium capitalize "+("gold"===l?"text-gray-200":"text-gray-900"),children:["Email ",t.event_type]}),t.link_url&&st.jsx("span",{className:"text-xs px-2 py-1 rounded-full "+("gold"===l?"bg-green-500/20 text-green-400":"bg-green-100 text-green-800"),children:"Link clicked"})]}),st.jsxs("span",{className:"text-xs "+("gold"===l?"text-gray-500":"text-gray-400"),children:[new Date(t.timestamp).toLocaleDateString()," ",new Date(t.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),t.link_url&&st.jsxs("p",{className:"text-xs mt-1 "+("gold"===l?"text-gray-400":"text-gray-600"),children:["Clicked: ",t.link_url]}),t.ip_address&&st.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["IP: ",t.ip_address]})]},`event-${t.id}`)}return null})})]})}function Dt({leadId:e,campaignId:t,onClose:s}){const{user:l}=nt(),{theme:r}=gt(),[a,o]=g.useState(null),[i,n]=g.useState([]),[d,m]=g.useState("messages"),[x,u]=g.useState(!0);g.useEffect(()=>{e&&h()},[e]);const h=()=>c(this,null,function*(){try{const{data:t,error:s}=yield at.from("uploaded_leads").select("*").eq("id",e).eq("user_id",null==l?void 0:l.id).single();if(s)throw s;const{data:r,error:a}=yield at.from("bookings").select("*").eq("lead_id",e).eq("user_id",null==l?void 0:l.id).order("created_at",{ascending:!1});if(a)throw a;o(t),n(r||[])}catch(t){console.error("Error fetching lead data:",t)}finally{u(!1)}});return x?st.jsx("div",{className:"flex items-center justify-center h-64",children:st.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-transparent "+("gold"===r?"border-t-yellow-400":"border-t-blue-600")})}):a?st.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto "+("gold"===r?"bg-black/75":"bg-gray-900/50"),children:st.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:st.jsxs("div",{className:"w-full max-w-6xl rounded-xl shadow-2xl "+("gold"===r?"black-card gold-border":"bg-white border border-gray-200"),children:[st.jsxs("div",{className:"flex items-center justify-between p-6 border-b "+("gold"===r?"border-yellow-400/20":"border-gray-200"),children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center "+("gold"===r?"gold-gradient":"bg-blue-100"),children:st.jsx(D,{className:"h-6 w-6 "+("gold"===r?"text-black":"text-blue-600")})}),st.jsxs("div",{children:[st.jsx("h2",{className:"text-xl font-bold "+("gold"===r?"text-gray-200":"text-gray-900"),children:a.name||"Unknown Lead"}),st.jsx("p",{className:"text-sm "+("gold"===r?"text-gray-400":"text-gray-600"),children:"Complete Lead Profile & Conversation History"})]})]}),st.jsx("button",{onClick:s,className:"p-2 rounded-lg transition-colors "+("gold"===r?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"),children:st.jsx(ee,{className:"h-5 w-5"})})]}),st.jsx("div",{className:"border-b "+("gold"===r?"border-yellow-400/20":"border-gray-200"),children:st.jsx("nav",{className:"flex px-6",children:[{key:"messages",label:"Conversation History",icon:O},{key:"info",label:"Lead Information",icon:D},{key:"activity",label:"Activity Timeline",icon:W}].map(e=>{const t=e.icon;return st.jsxs("button",{onClick:()=>m(e.key),className:"py-4 px-4 border-b-2 font-medium text-sm whitespace-nowrap flex items-center space-x-2 "+(d===e.key?"gold"===r?"border-yellow-400 text-yellow-400":"border-blue-500 text-blue-600":"gold"===r?"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[st.jsx(t,{className:"h-4 w-4"}),st.jsx("span",{children:e.label})]},e.key)})})}),st.jsxs("div",{className:"p-6",children:["info"===d&&st.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===r?"bg-yellow-400/5 border border-yellow-400/20":"bg-gray-50 border border-gray-200"),children:[st.jsx("h3",{className:"text-lg font-semibold mb-4 "+("gold"===r?"text-gray-200":"text-gray-900"),children:"Contact Information"}),st.jsxs("div",{className:"space-y-3",children:[a.phone&&st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx(J,{className:"h-4 w-4 "+("gold"===r?"text-yellow-400":"text-gray-500")}),st.jsx("span",{className:"text-sm "+("gold"===r?"text-gray-300":"text-gray-700"),children:a.phone})]}),a.email&&st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx(L,{className:"h-4 w-4 "+("gold"===r?"text-yellow-400":"text-gray-500")}),st.jsx("span",{className:"text-sm "+("gold"===r?"text-gray-300":"text-gray-700"),children:a.email})]}),a.company_name&&st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx(ye,{className:"h-4 w-4 "+("gold"===r?"text-yellow-400":"text-gray-500")}),st.jsx("span",{className:"text-sm "+("gold"===r?"text-gray-300":"text-gray-700"),children:a.company_name})]}),a.job_title&&st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx(je,{className:"h-4 w-4 "+("gold"===r?"text-yellow-400":"text-gray-500")}),st.jsx("span",{className:"text-sm "+("gold"===r?"text-gray-300":"text-gray-700"),children:a.job_title})]})]})]}),st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===r?"bg-yellow-400/5 border border-yellow-400/20":"bg-gray-50 border border-gray-200"),children:[st.jsxs("h3",{className:"text-lg font-semibold mb-4 "+("gold"===r?"text-gray-200":"text-gray-900"),children:["Bookings (",i.length,")"]}),0===i.length?st.jsx("p",{className:"text-sm "+("gold"===r?"text-gray-400":"text-gray-600"),children:"No bookings yet"}):st.jsx("div",{className:"space-y-3",children:i.map(e=>st.jsxs("div",{className:"p-3 rounded-lg border "+("gold"===r?"border-yellow-400/10 bg-black/20":"border-gray-200 bg-white"),children:[st.jsx("div",{className:"flex items-center justify-between mb-2",children:st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx(G,{className:"h-4 w-4 "+("gold"===r?"text-yellow-400":"text-blue-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===r?"text-gray-200":"text-gray-900"),children:"Appointment Booked"})]})}),e.booking_url&&st.jsxs("a",{href:e.booking_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs hover:underline mt-1 "+("gold"===r?"text-yellow-400":"text-blue-600"),children:[st.jsx(ve,{className:"h-3 w-3 mr-1"}),"View Booking"]}),st.jsxs("p",{className:"text-xs mt-2 text-gray-500",children:["Booked on ",new Date(e.created_at).toLocaleDateString()]})]},e.id))})]})]}),"messages"===d&&st.jsx(qt,{leadId:e,campaignId:t}),"activity"===d&&st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===r?"bg-yellow-400/5 border border-yellow-400/20":"bg-gray-50 border border-gray-200"),children:[st.jsx("h3",{className:"text-lg font-semibold mb-4 "+("gold"===r?"text-gray-200":"text-gray-900"),children:"Activity Timeline"}),st.jsx("p",{className:"text-sm "+("gold"===r?"text-gray-400":"text-gray-600"),children:"Detailed activity timeline will be available in the next update."})]})]})]})})}):st.jsx("div",{className:"text-center py-8",children:st.jsx("p",{className:"gold"===r?"text-gray-400":"text-gray-600",children:"Lead not found"})})}function Lt({callId:e,recordingUrl:t,leadName:s,timestamp:l,onClose:r}){var a,o;const{user:i}=nt(),{theme:n}=gt(),[d,m]=g.useState(null),[x,u]=g.useState(""),[h,y]=g.useState(!0),[p,b]=g.useState(null),[f,j]=g.useState(!1),[v,w]=g.useState(!1),[N,k]=g.useState(0),[_,C]=g.useState(0),[I,E]=g.useState(null),[A,q]=g.useState({isLive:!1}),[L,T]=g.useState({isRecording:!1,audioChunks:[],capturedAudioUrl:null,websocket:null,connectionStatus:"disconnected",audioDataReceived:0,chunkCount:0,pcmBuffer:new Uint8Array(0)}),[P,R]=g.useState(0),[$,F]=g.useState(!1);g.useEffect(()=>(null==t?void 0:t.startsWith("wss://"))?(q({isLive:!0}),void y(!1)):(null==t?void 0:t.includes("storage.vapi.ai"))?(m({id:e||"direct-recording",status:"completed",duration:0,created_at:l,recording_url:t}),u("Transcript available in Vapi dashboard"),void y(!1)):void(e&&""!==e.trim()?O():(y(!1),b("No call ID available for this recording"))),[e,t]);const O=()=>c(this,null,function*(){try{y(!0),b(null);const t=yield fetch("https://zhlaaaysvzqixnugqbna.supabase.co/functions/v1/vapi-call-data",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpobGFhYXlzdnpxaXhudWdxYm5hIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE0MDYwOTUsImV4cCI6MjA2Njk4MjA5NX0.oS03M7cfw3JiQObDL5uwvTPc1F54awaOfdmqUBcIVTc","Content-Type":"application/json"},body:JSON.stringify({call_id:e,user_id:null==i?void 0:i.id})});if(!t.ok)throw new Error(`Failed to fetch call data: ${t.status}`);const s=yield t.json();if(s.error)throw new Error(s.error);m(s.call),u(s.transcript||"Transcript not available")}catch(t){console.error("Error fetching Vapi data:",t),b(t instanceof Error?t.message:"Failed to load call data")}finally{y(!1)}}),M=e=>`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`;return st.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto "+("gold"===n?"bg-black/75":"bg-gray-900/50"),children:st.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:st.jsxs("div",{className:"w-full max-w-4xl rounded-xl shadow-2xl "+("gold"===n?"black-card gold-border":"bg-white border border-gray-200"),children:[st.jsx("div",{className:"p-6 border-b "+("gold"===n?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center "+("gold"===n?"gold-gradient":"bg-blue-100"),children:st.jsx(J,{className:"h-6 w-6 "+("gold"===n?"text-black":"text-blue-600")})}),st.jsxs("div",{children:[st.jsx("h2",{className:"text-xl font-bold "+("gold"===n?"text-gray-200":"text-gray-900"),children:"Call Recording"}),st.jsxs("p",{className:"text-sm "+("gold"===n?"text-gray-400":"text-gray-600"),children:[s," • ",new Date(l).toLocaleDateString()," ",new Date(l).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]})]}),st.jsx("button",{onClick:r,className:"p-2 rounded-lg transition-colors "+("gold"===n?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"),children:st.jsx(ee,{className:"h-5 w-5"})})]})}),st.jsx("div",{className:"p-6",children:h?st.jsx("div",{className:"flex items-center justify-center h-64",children:st.jsxs("div",{className:"text-center",children:[st.jsx("div",{className:`animate-spin rounded-full h-8 w-8 border-2 border-transparent mx-auto mb-4 ${"gold"===n?"text-yellow-400":"text-blue-600"} ${"gold"===n?"border-t-yellow-400":"border-t-blue-600"}`}),st.jsx("p",{className:"text-sm "+("gold"===n?"text-gray-400":"text-gray-600"),children:"Loading call data and transcription..."})]})}):p?st.jsxs("div",{className:"text-center py-12 "+("gold"===n?"text-red-400":"text-red-600"),children:[st.jsx(S,{className:"h-12 w-12 mx-auto mb-4"}),st.jsx("h3",{className:"text-lg font-medium mb-2",children:"Failed to Load Call Data"}),st.jsx("p",{className:"text-sm mb-4",children:p}),st.jsxs("button",{onClick:O,className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors "+("gold"===n?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[st.jsx(we,{className:"h-4 w-4 mr-2"}),"Retry"]})]}):st.jsxs("div",{className:"space-y-6",children:[t&&st.jsxs("div",{className:"p-6 rounded-lg border "+("gold"===n?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-gray-50"),children:[st.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[st.jsx(Ne,{className:"h-5 w-5 "+("gold"===n?"text-yellow-400":"text-blue-600")}),st.jsx("h3",{className:"text-lg font-semibold "+("gold"===n?"text-gray-200":"text-gray-900"),children:"Audio Recording"})]}),st.jsx("audio",{ref:E,src:t,onLoadedMetadata:e=>{const t=e.target;C(t.duration)},onTimeUpdate:e=>{const t=e.target;k(t.currentTime)},onEnded:()=>j(!1),className:"hidden"}),st.jsxs("div",{className:"space-y-4",children:[st.jsxs("div",{className:"space-y-2",children:[st.jsx("input",{type:"range",min:"0",max:_||0,value:N,onChange:e=>{if(!I)return;const t=parseFloat(e.target.value);I.currentTime=t,k(t)},className:"w-full h-2 rounded-lg appearance-none cursor-pointer "+("gold"===n?"bg-gray-700 slider-thumb-gold":"bg-gray-200 slider-thumb-blue")}),st.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[st.jsx("span",{children:M(N)}),st.jsx("span",{children:M(_)})]})]}),st.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[st.jsx("button",{onClick:()=>{I&&(I.currentTime=0,k(0))},className:"p-2 rounded-lg transition-colors "+("gold"===n?"text-gray-400 hover:bg-gray-800":"text-gray-600 hover:bg-gray-100"),title:"Restart",children:st.jsx(we,{className:"h-5 w-5"})}),st.jsx("button",{onClick:()=>{I&&(f?I.pause():I.play(),j(!f))},className:"p-3 rounded-full transition-colors "+("gold"===n?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),title:f?"Pause":"Play",children:f?st.jsx(ke,{className:"h-6 w-6"}):st.jsx(Q,{className:"h-6 w-6"})}),st.jsx("button",{onClick:()=>{I&&(I.muted=!v,w(!v))},className:"p-2 rounded-lg transition-colors "+("gold"===n?"text-gray-400 hover:bg-gray-800":"text-gray-600 hover:bg-gray-100"),title:v?"Unmute":"Mute",children:v?st.jsx(_e,{className:"h-5 w-5"}):st.jsx(Ne,{className:"h-5 w-5"})}),st.jsx("button",{onClick:()=>{if(t){const e=document.createElement("a");e.href=t,e.download=`call-recording-${s}-${new Date(l).toISOString().split("T")[0]}.mp3`,e.click()}},className:"p-2 rounded-lg transition-colors "+("gold"===n?"text-gray-400 hover:bg-gray-800":"text-gray-600 hover:bg-gray-100"),title:"Download Recording",children:st.jsx(he,{className:"h-5 w-5"})})]})]})]}),d&&st.jsxs("div",{className:"p-6 rounded-lg border "+("gold"===n?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-gray-50"),children:[st.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[st.jsx(xe,{className:"h-5 w-5 "+("gold"===n?"text-yellow-400":"text-blue-600")}),st.jsx("h3",{className:"text-lg font-semibold "+("gold"===n?"text-gray-200":"text-gray-900"),children:"Call Details"})]}),st.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[st.jsxs("div",{children:[st.jsx("div",{className:"text-sm font-medium "+("gold"===n?"text-gray-300":"text-gray-700"),children:"Status"}),st.jsx("div",{className:"text-lg "+("gold"===n?"text-yellow-400":"text-blue-600"),children:(null==(a=d.status)?void 0:a.charAt(0).toUpperCase())+(null==(o=d.status)?void 0:o.slice(1))})]}),st.jsxs("div",{children:[st.jsx("div",{className:"text-sm font-medium "+("gold"===n?"text-gray-300":"text-gray-700"),children:"Duration"}),st.jsx("div",{className:"text-lg "+("gold"===n?"text-yellow-400":"text-blue-600"),children:M(d.duration||0)})]}),st.jsxs("div",{children:[st.jsx("div",{className:"text-sm font-medium "+("gold"===n?"text-gray-300":"text-gray-700"),children:"Call ID"}),st.jsx("div",{className:"text-sm font-mono "+("gold"===n?"text-gray-400":"text-gray-600"),children:d.id})]})]})]}),st.jsxs("div",{className:"p-6 rounded-lg border "+("gold"===n?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-gray-50"),children:[st.jsxs("div",{className:"flex items-center justify-between mb-4",children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx(re,{className:"h-5 w-5 "+("gold"===n?"text-yellow-400":"text-blue-600")}),st.jsx("h3",{className:"text-lg font-semibold "+("gold"===n?"text-gray-200":"text-gray-900"),children:"Conversation Transcript"})]}),x&&"Transcript not available"!==x&&st.jsx("button",{onClick:()=>{navigator.clipboard.writeText(x)},className:"text-xs px-3 py-1 rounded-lg transition-colors "+("gold"===n?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-100"),children:"Copy Transcript"})]}),st.jsx("div",{className:"max-h-64 overflow-y-auto p-4 rounded-lg "+("gold"===n?"bg-black/30":"bg-white"),children:x?st.jsx("div",{className:"text-sm whitespace-pre-wrap "+("gold"===n?"text-gray-300":"text-gray-700"),children:x}):st.jsxs("div",{className:"text-center py-8 text-gray-500",children:[st.jsx(re,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),st.jsx("p",{children:"Transcript not available"})]})})]}),(null==d?void 0:d.summary)&&st.jsxs("div",{className:"p-6 rounded-lg border "+("gold"===n?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-gray-50"),children:[st.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[st.jsx(D,{className:"h-5 w-5 "+("gold"===n?"text-yellow-400":"text-blue-600")}),st.jsx("h3",{className:"text-lg font-semibold "+("gold"===n?"text-gray-200":"text-gray-900"),children:"Call Summary"})]}),st.jsx("p",{className:"text-sm "+("gold"===n?"text-gray-300":"text-gray-700"),children:d.summary})]}),e&&st.jsx("div",{className:"flex justify-center",children:st.jsxs("a",{href:`https://dashboard.vapi.ai/call/${e}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 text-sm rounded-lg border transition-colors "+("gold"===n?"border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border-gray-300 text-gray-700 hover:bg-gray-100"),children:[st.jsx(ve,{className:"h-4 w-4 mr-2"}),"View in Vapi Dashboard"]})}),A.isLive&&st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===n?"bg-blue-500/10 border border-blue-500/20":"bg-blue-50 border border-blue-200"),children:[st.jsx("h5",{className:"text-sm font-medium mb-2 "+("gold"===n?"text-blue-400":"text-blue-700"),children:"💡 How to Get Recordings"}),st.jsxs("ul",{className:"text-sm space-y-1 "+("gold"===n?"text-blue-300":"text-blue-600"),children:[st.jsxs("li",{children:["• ",st.jsx("strong",{children:"Enable Recording:"})," Set `recordingEnabled: true` in your Vapi assistant config"]}),st.jsxs("li",{children:["• ",st.jsx("strong",{children:"Live Capture:"})," Connect to this WebSocket to capture PCM audio in real-time"]}),st.jsxs("li",{children:["• ",st.jsx("strong",{children:"API Polling:"})," After call ends, we automatically poll Vapi API for the official recording"]}),st.jsxs("li",{children:["• ",st.jsx("strong",{children:"Retention:"})," Vapi recordings are kept for 30 days"]}),st.jsxs("li",{children:["• ",st.jsx("strong",{children:"Transcripts:"})," Automatically generated when recording is enabled"]})]})]})]})})]})})})}function Tt({searchTerm:e,selectedCampaign:t,campaigns:s,theme:l}){const{user:r}=nt(),[a,o]=g.useState([]),[i,n]=g.useState(!0),[d,m]=g.useState(null);g.useEffect(()=>{r&&x()},[r,t]);const x=()=>c(this,null,function*(){if(r)try{n(!0);let e=at.from("conversation_history").select("\n          id,\n          campaign_id,\n          lead_id,\n          channel,\n          from_role,\n          message,\n          timestamp,\n          email_subject,\n          email_body,\n          uploaded_leads!inner(name, phone)\n        ").order("timestamp",{ascending:!1}).limit(50);t&&(e=e.eq("campaign_id",t));const[s]=yield Promise.all([e]);if(s.error)throw s.error;const l=(s.data||[]).map(e=>{var t,s;return{id:e.id,type:"conversation",campaign_id:e.campaign_id,lead_id:e.lead_id,channel:e.channel,from_role:e.from_role,message:e.message,timestamp:e.timestamp,email_subject:e.email_subject,email_body:e.email_body,lead_name:null==(t=e.uploaded_leads)?void 0:t.name,lead_phone:null==(s=e.uploaded_leads)?void 0:s.phone,campaign_offer:u(e.campaign_id)}}),r=new Map;l.forEach(e=>{const t=`${e.lead_id}-${e.channel}-${e.from_role}-${e.timestamp}`;r.has(t)||r.set(t,e)});const a=Array.from(r.values()).sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime());o(a)}catch(e){console.error("Error fetching activities:",e)}finally{n(!1)}}),u=e=>{const t=s.find(t=>t.id===e);return(null==t?void 0:t.offer)||"Unknown Campaign"},h=e=>{switch(e){case"vapi":case"call":return"gold"===l?"text-yellow-400":"text-blue-600";case"sms":return"gold"===l?"text-yellow-400":"text-green-600";case"whatsapp":return"gold"===l?"text-yellow-400":"text-emerald-600";case"email":return"gold"===l?"text-yellow-400":"text-purple-600";default:return"gold"===l?"text-gray-400":"text-gray-600"}},y=(e,t)=>{if("lead"===t)return"gold"===l?"text-green-400":"text-green-600";switch(e){case"completed":return"gold"===l?"text-green-400":"text-green-600";case"failed":return"gold"===l?"text-red-400":"text-red-600";case"running":return"gold"===l?"text-yellow-400":"text-yellow-600";default:return"gold"===l?"text-blue-400":"text-blue-600"}},p=e=>{if(!e)return"N/A";return`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`},b=a.filter(s=>{var l,r,a,o;const i=!e||(null==(l=s.lead_name)?void 0:l.toLowerCase().includes(e.toLowerCase()))||(null==(r=s.lead_phone)?void 0:r.includes(e))||(null==(a=s.message)?void 0:a.toLowerCase().includes(e.toLowerCase()))||(null==(o=s.email_subject)?void 0:o.toLowerCase().includes(e.toLowerCase())),n=!t||s.campaign_id===t;return i&&n});return i?st.jsx("div",{className:"flex items-center justify-center h-64",children:st.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-transparent "+("gold"===l?"border-t-yellow-400":"border-t-blue-600")})}):0===b.length?st.jsxs("div",{className:"text-center py-12",children:[st.jsx(F,{className:"h-12 w-12 mx-auto mb-4 "+("gold"===l?"text-gray-600":"text-gray-400")}),st.jsx("h3",{className:"text-lg font-medium mb-2 "+("gold"===l?"text-gray-200":"text-gray-900"),children:"No activities yet"}),st.jsx("p",{className:"gold"===l?"text-gray-400":"text-gray-600",children:e||t?"No activities match your search criteria":"Lead activities and interactions will appear here"})]}):st.jsxs("div",{className:"space-y-4",children:[st.jsx("div",{className:"space-y-3",children:b.map(e=>{var t,s,r,a,o,i,n,d;const c=(e=>{switch(e){case"vapi":case"call":return J;case"sms":case"whatsapp":default:return O;case"email":return L}})(e.channel),g=((e,t)=>{if("lead"===t)return Ce;switch(e){case"completed":return $;case"failed":return S;case"running":return xe;default:return K}})(e.status,e.from_role),x="lead"===e.from_role,u=e.recording_url||e.vapi_call_id;return st.jsx("div",{className:"p-4 rounded-lg border transition-colors cursor-pointer "+("gold"===l?"border-yellow-400/20 bg-black/10 hover:bg-yellow-400/5":"border-gray-200 bg-gray-50 hover:bg-gray-100"),onClick:()=>(e=>{e.lead_id&&window.openLeadDetail&&window.openLeadDetail(e.lead_id,e.campaign_id)})(e),children:st.jsxs("div",{className:"flex items-start space-x-4",children:[st.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center "+(x?"gold"===l?"bg-green-500/20":"bg-green-100":"gold"===l?"bg-blue-500/20":"bg-blue-100"),children:st.jsx(c,{className:`h-5 w-5 ${h(e.channel)}`})}),st.jsxs("div",{className:"flex-1 min-w-0",children:[st.jsxs("div",{className:"flex items-center justify-between mb-2",children:[st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx(g,{className:`h-4 w-4 ${y(e.status,e.from_role)}`}),st.jsx("span",{className:"text-sm font-medium "+("gold"===l?"text-gray-200":"text-gray-900"),children:e.lead_name||"Unknown Lead"}),st.jsx("span",{className:"text-xs px-2 py-1 rounded-full "+(x?"gold"===l?"bg-green-500/20 text-green-400":"bg-green-100 text-green-800":"gold"===l?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-800"),children:x?"Inbound":"Outbound"})]}),st.jsxs("div",{className:"flex items-center space-x-3",children:[e.call_duration&&st.jsxs("div",{className:"flex items-center text-xs "+("gold"===l?"text-gray-400":"text-gray-500"),children:[st.jsx(xe,{className:"h-3 w-3 mr-1"}),p(e.call_duration)]}),(u||e.listen_url||(null==(t=e.message)?void 0:t.startsWith("wss://"))||(null==(s=e.message)?void 0:s.includes("storage.vapi.ai")))&&("vapi"===e.channel||"call"===e.channel)&&st.jsxs("button",{onClick:()=>(e=>{var t,s,l,r;(e.vapi_call_id||e.recording_url||(null==(t=e.message)?void 0:t.startsWith("wss://"))||(null==(s=e.message)?void 0:s.includes("storage.vapi.ai")))&&m({callId:e.vapi_call_id||"",recordingUrl:e.recording_url||((null==(l=e.message)?void 0:l.startsWith("wss://"))?e.message:"")||((null==(r=e.message)?void 0:r.includes("storage.vapi.ai"))?e.message:""),leadName:e.lead_name||"Unknown Lead",timestamp:e.timestamp})})(e),className:"flex items-center text-xs hover:underline "+("gold"===l?"text-yellow-400":"text-blue-600"),title:e.recording_url||(null==(r=e.message)?void 0:r.includes("storage.vapi.ai"))?"Play recording":(null==(a=e.message)?void 0:a.startsWith("wss://"))?"View live call stream":"View call details",children:[st.jsx(Q,{className:"h-3 w-3 mr-1"}),e.recording_url||(null==(o=e.message)?void 0:o.includes("storage.vapi.ai"))?"Recording":(null==(i=e.message)?void 0:i.startsWith("wss://"))?"Live Stream":"View Call"]}),st.jsxs("span",{className:"text-xs text-gray-500",children:[new Date(e.timestamp).toLocaleDateString()," ",new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]})]}),st.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[st.jsxs("div",{className:"text-sm "+("gold"===l?"text-gray-300":"text-gray-700"),children:[st.jsx("span",{className:"font-medium",children:"vapi"===e.channel?"Voice Call":"sms"===e.channel?"SMS":"whatsapp"===e.channel?"WhatsApp":"email"===e.channel?"Email":e.channel.charAt(0).toUpperCase()+e.channel.slice(1)}),e.lead_phone&&st.jsxs("span",{className:"ml-2 text-xs "+("gold"===l?"text-gray-400":"text-gray-500"),children:["• ",e.lead_phone]})]}),st.jsx("div",{className:"text-xs text-gray-500",children:e.campaign_offer})]}),e.email_subject&&st.jsx("div",{className:"mb-2 p-2 rounded border-l-4 "+("gold"===l?"border-yellow-400 bg-yellow-400/5":"border-blue-500 bg-blue-50"),children:st.jsxs("div",{className:"text-xs font-medium "+("gold"===l?"text-yellow-400":"text-blue-700"),children:["Subject: ",e.email_subject]})}),(e.message||e.email_body)&&!(null==(n=e.message)?void 0:n.startsWith("wss://"))&&st.jsx("p",{className:"text-sm "+("gold"===l?"text-gray-300":"text-gray-700"),children:"email"===e.channel?e.email_body:e.message}),(null==(d=e.message)?void 0:d.startsWith("wss://"))&&st.jsx("div",{className:"text-xs text-gray-500",children:"Live call stream available"}),e.status&&"activity"===e.type&&st.jsx("div",{className:"mt-2",children:st.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium "+("completed"===e.status?"gold"===l?"bg-green-500/20 text-green-400":"bg-green-100 text-green-800":"failed"===e.status?"gold"===l?"bg-red-500/20 text-red-400":"bg-red-100 text-red-800":"gold"===l?"bg-yellow-500/20 text-yellow-400":"bg-yellow-100 text-yellow-800"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})})]})]})},`${e.type}-${e.id}`)})}),d&&st.jsx(Lt,{callId:d.callId,recordingUrl:d.recordingUrl,leadName:d.leadName,timestamp:d.timestamp,onClose:()=>m(null)})]})}function Pt(){const{user:e}=nt(),{theme:t}=gt();ut();const{isLoading:s,error:l,setError:r,executeAsync:a}=xt(),[o,i]=g.useState([]),[n,d]=g.useState([]),[m,x]=g.useState([]),[u,h]=g.useState(""),[y,p]=g.useState("bookings"),[b,f]=g.useState(""),[j,v]=g.useState(null);g.useEffect(()=>{e&&w()},[e]);const w=()=>c(this,null,function*(){e&&(yield a(()=>c(this,null,function*(){const[t,s,l]=yield Promise.all([at.from("uploaded_leads").select("*").eq("user_id",e.id).not("booking_url","is",null).order("created_at",{ascending:!1}),at.from("conversation_history").select("\n            *,\n            uploaded_leads!inner(name, phone, email, company_name)\n          ").eq("from_role","lead").order("timestamp",{ascending:!1}),at.from("campaigns").select("id, offer").eq("user_id",e.id)]);if(t.error)throw t.error;if(s.error)throw s.error;if(l.error)throw l.error;i(t.data||[]),d(s.data||[]),x(l.data||[])}),{errorMessage:"Failed to load inbox data"}))});g.useEffect(()=>(window.openLeadDetail=(e,t)=>{v({leadId:e,campaignId:t})},()=>{delete window.openLeadDetail}),[]);const N=o.filter(e=>{var t,s;const l=!u||(null==(t=e.name)?void 0:t.toLowerCase().includes(u.toLowerCase()))||(null==(s=e.phone)?void 0:s.includes(u)),r=!b||e.campaign_id===b;return l&&r}),k=n.filter(e=>{var t,s,l,r;const a=!u||(null==(t=e.message)?void 0:t.toLowerCase().includes(u.toLowerCase()))||(null==(s=e.email_subject)?void 0:s.toLowerCase().includes(u.toLowerCase()))||(null==(r=null==(l=e.uploaded_leads)?void 0:l.name)?void 0:r.toLowerCase().includes(u.toLowerCase())),o=!b||e.campaign_id===b;return a&&o}),_=e=>{const t=m.find(t=>t.id===e);return(null==t?void 0:t.offer)||"Unknown Campaign"},C=(e,t)=>{v({leadId:e,campaignId:t})};return s&&0===o.length&&0===n.length?st.jsx(bt,{size:"lg",message:"Loading inbox...",className:"h-64"}):l&&0===o.length&&0===n.length?st.jsx(pt,{title:"Inbox Error",message:l,onRetry:w,onDismiss:()=>r(""),className:"m-6"}):st.jsxs(st.Fragment,{children:[st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{children:[st.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:["gold"===t?st.jsx(E,{className:"h-8 w-8 text-yellow-400"}):st.jsx(G,{className:"h-8 w-8 text-blue-600"}),st.jsx("h1",{className:"text-3xl font-bold "+("gold"===t?"gold-text-gradient":"text-gray-900"),children:"CRM"})]}),st.jsx("p",{className:"gold"===t?"text-gray-400":"text-gray-600",children:"Manage opportunities, booked appointments, and AI setter training"})]}),st.jsxs("div",{className:"rounded-xl shadow-sm border "+("gold"===t?"black-card gold-border":"bg-white border-gray-200"),children:[st.jsx("div",{className:"border-b "+("gold"===t?"border-yellow-400/20":"border-gray-200"),children:st.jsx("nav",{className:"flex overflow-x-auto px-4 sm:px-6",children:[{key:"activity",label:"Activity",icon:F},{key:"replies",label:"Opportunities",icon:O},{key:"bookings",label:"Booked Appointments",icon:G},{key:"ai-setter",label:"AI Setter Training",icon:be},{key:"calendar",label:"Calendar",icon:G}].map(e=>{const s=e.icon;return st.jsxs("button",{onClick:()=>p(e.key),className:"py-4 px-4 border-b-2 font-medium text-sm whitespace-nowrap flex items-center space-x-2 "+(y===e.key?"gold"===t?"border-yellow-400 text-yellow-400":"border-blue-500 text-blue-600":"gold"===t?"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[st.jsx(s,{className:"h-4 w-4"}),st.jsx("span",{children:e.label})]},e.key)})})}),st.jsxs("div",{className:"p-4 sm:p-6",children:[("bookings"===y||"replies"===y||"calendar"===y||"activity"===y)&&st.jsx("div",{className:"mb-6 space-y-4",children:st.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:space-x-4 space-y-4 md:space-y-0",children:[st.jsx("div",{className:"flex-1",children:st.jsxs("div",{className:"relative",children:[st.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 "+("gold"===t?"text-yellow-400":"text-gray-400")}),st.jsx("input",{type:"text",placeholder:"bookings"===y?"Search bookings...":"replies"===y?"Search opportunities...":"activity"===y?"Search activities...":"Search calendar...",value:u,onChange:e=>h(e.target.value),className:`w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 ${"gold"===t?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"} focus:border-transparent`})]})}),st.jsx("div",{className:"flex-shrink-0",children:st.jsxs("select",{value:b,onChange:e=>f(e.target.value),className:`px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${"gold"===t?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"} focus:border-transparent`,children:[st.jsx("option",{value:"",children:"All Campaigns"}),m.map(e=>st.jsx("option",{value:e.id,children:e.offer||"Untitled Campaign"},e.id))]})})]})}),"activity"===y&&st.jsx(Tt,{searchTerm:u,selectedCampaign:b,campaigns:m,theme:t}),"replies"===y&&st.jsx("div",{className:"space-y-4",children:0===k.length?st.jsxs("div",{className:"text-center py-12",children:[st.jsx(O,{className:"h-12 w-12 mx-auto mb-4 "+("gold"===t?"text-gray-600":"text-gray-400")}),st.jsx("h3",{className:"text-lg font-medium mb-2 "+("gold"===t?"text-gray-200":"text-gray-900"),children:"No opportunities yet"}),st.jsx("p",{className:"gold"===t?"text-gray-400":"text-gray-600",children:u||b?"No opportunities match your search criteria":"Lead replies and opportunities will appear here when prospects respond to your outreach"})]}):st.jsx("div",{className:"space-y-3",children:k.map(e=>{const s=(e=>{switch(e){case"vapi":return J;case"sms":case"whatsapp":default:return O;case"email":return Mail}})(e.channel),l=e.uploaded_leads;return st.jsx("div",{className:"p-4 rounded-lg border transition-colors cursor-pointer hover:shadow-md "+("gold"===t?"border-yellow-400/20 bg-black/10 hover:bg-yellow-400/5":"border-gray-200 bg-gray-50 hover:bg-gray-100"),onClick:()=>{return t=e.lead_id,s=e.campaign_id,void v({leadId:t,campaignId:s});var t,s},children:st.jsxs("div",{className:"flex items-start space-x-4",children:[st.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center "+("gold"===t?"bg-blue-500/20":"bg-blue-100"),children:st.jsx(s,{className:"h-5 w-5 "+("gold"===t?"text-blue-400":"text-blue-600")})}),st.jsxs("div",{className:"flex-1",children:[st.jsxs("div",{className:"flex items-center justify-between mb-2",children:[st.jsxs("div",{children:[st.jsx("div",{className:"text-sm font-medium "+("gold"===t?"text-gray-200":"text-gray-900"),children:(null==l?void 0:l.name)||"Unknown Lead"}),st.jsxs("div",{className:"text-xs "+("gold"===t?"text-gray-400":"text-gray-600"),children:["Reply via ",e.channel.toUpperCase(),(null==l?void 0:l.phone)&&` • ${l.phone}`,(null==l?void 0:l.company_name)&&` • ${l.company_name}`]})]}),st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx("button",{onClick:t=>{t.stopPropagation(),C(e.lead_id,e.campaign_id)},className:"p-1 rounded transition-colors "+("gold"===t?"text-yellow-400 hover:bg-yellow-400/10":"text-blue-600 hover:bg-blue-100"),title:"View conversation history",children:st.jsx(R,{className:"h-4 w-4"})}),st.jsx("span",{className:"text-xs text-gray-500",children:_(e.campaign_id)}),st.jsxs("span",{className:"text-xs text-gray-500",children:[new Date(e.timestamp).toLocaleDateString()," ",new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]})]}),e.email_subject&&st.jsx("div",{className:"mb-2 p-2 rounded border-l-4 "+("gold"===t?"border-yellow-400 bg-yellow-400/5":"border-blue-500 bg-blue-50"),children:st.jsxs("div",{className:"text-xs font-medium "+("gold"===t?"text-yellow-400":"text-blue-700"),children:["Subject: ",e.email_subject]})}),st.jsx("p",{className:"text-sm "+("gold"===t?"text-gray-300":"text-gray-700"),children:"email"===e.channel&&e.email_body||e.message})]})]})},e.id)})})}),"bookings"===y&&st.jsx("div",{className:"space-y-4",children:0===N.length?st.jsxs("div",{className:"text-center py-12",children:[st.jsx(G,{className:"h-12 w-12 mx-auto mb-4 "+("gold"===t?"text-gray-600":"text-gray-400")}),st.jsx("h3",{className:"text-lg font-medium mb-2 "+("gold"===t?"text-gray-200":"text-gray-900"),children:"No booked appointments yet"}),st.jsx("p",{className:"gold"===t?"text-gray-400":"text-gray-600",children:u||b?"No appointments match your search criteria":"Booked appointments will appear here when prospects schedule meetings"})]}):st.jsx("div",{className:"space-y-3",children:N.map(e=>st.jsx("div",{className:"p-4 rounded-lg border transition-colors cursor-pointer hover:shadow-md "+("gold"===t?"border-yellow-400/20 bg-black/10 hover:bg-yellow-400/5":"border-gray-200 bg-gray-50 hover:bg-gray-100"),onClick:()=>C(e.id,e.campaign_id),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{className:"flex items-center space-x-4",children:[st.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center "+("gold"===t?"bg-green-500/20":"bg-green-100"),children:st.jsx(D,{className:"h-5 w-5 "+("gold"===t?"text-green-400":"text-green-600")})}),st.jsxs("div",{children:[st.jsx("div",{className:"text-sm font-medium "+("gold"===t?"text-gray-200":"text-gray-900"),children:e.name||"No name"}),e.phone&&st.jsxs("div",{className:"text-sm flex items-center "+("gold"===t?"text-gray-400":"text-gray-500"),children:[st.jsx(J,{className:"h-3 w-3 mr-1"}),e.phone]}),st.jsx("div",{className:"text-xs text-gray-500",children:_(e.campaign_id)})]})]}),st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("button",{onClick:t=>{t.stopPropagation(),C(e.id,e.campaign_id)},className:"p-2 rounded-lg transition-colors "+("gold"===t?"text-yellow-400 hover:bg-yellow-400/10":"text-blue-600 hover:bg-blue-100"),title:"View conversation history",children:st.jsx(R,{className:"h-4 w-4"})}),st.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+("gold"===t?"bg-green-500/20 text-green-400":"bg-green-100 text-green-800"),children:[st.jsx($,{className:"h-3 w-3 mr-1"}),"Booked"]}),e.booking_url&&st.jsxs("a",{href:e.booking_url,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"text-sm hover:underline flex items-center "+("gold"===t?"text-yellow-400":"text-blue-600"),children:[st.jsx(ve,{className:"h-3 w-3 mr-1"}),"View Booking"]}),st.jsx("span",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]})]})},e.id))})}),"calendar"===y&&st.jsxs("div",{className:"space-y-4",children:[st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===t?"bg-yellow-400/10 border border-yellow-400/20":"bg-blue-50 border border-blue-200"),children:[st.jsx("h4",{className:"text-sm font-medium mb-2 "+("gold"===t?"text-yellow-400":"text-blue-700"),children:"Calendar Integration"}),st.jsx("p",{className:"text-sm "+("gold"===t?"text-gray-400":"text-blue-600"),children:"Calendar integration and appointment management features will be available soon."})]}),st.jsxs("div",{className:"text-center py-12",children:[st.jsx(G,{className:"h-16 w-16 mx-auto mb-4 "+("gold"===t?"text-gray-600":"text-gray-400")}),st.jsx("h3",{className:"text-xl font-medium mb-2 "+("gold"===t?"text-gray-200":"text-gray-900"),children:"Calendar Coming Soon"}),st.jsx("p",{className:"max-w-md mx-auto "+("gold"===t?"text-gray-400":"text-gray-600"),children:"Integrated calendar view, appointment scheduling, and booking management will be available in the next update."}),st.jsxs("div",{className:"mt-6 inline-flex items-center px-4 py-2 rounded-lg "+("gold"===t?"bg-yellow-400/10 border border-yellow-400/20 text-yellow-400":"bg-blue-50 border border-blue-200 text-blue-700"),children:[st.jsx(xe,{className:"h-4 w-4 mr-2"}),st.jsx("span",{className:"text-sm font-medium",children:"In Development"})]})]})]}),"ai-setter"===y&&st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===t?"bg-yellow-400/10 border border-yellow-400/20":"bg-blue-50 border border-blue-200"),children:[st.jsx("h4",{className:"text-sm font-medium mb-2 "+("gold"===t?"text-yellow-400":"text-blue-700"),children:"AI Setter Training"}),st.jsx("p",{className:"text-sm "+("gold"===t?"text-gray-400":"text-blue-600"),children:"Train your AI to better handle appointment setting and lead qualification. This feature will be available soon."})]}),st.jsxs("div",{className:"text-center py-12",children:[st.jsx(be,{className:"h-16 w-16 mx-auto mb-4 "+("gold"===t?"text-gray-600":"text-gray-400")}),st.jsx("h3",{className:"text-xl font-medium mb-2 "+("gold"===t?"text-gray-200":"text-gray-900"),children:"AI Setter Training Coming Soon"}),st.jsx("p",{className:"max-w-md mx-auto "+("gold"===t?"text-gray-400":"text-gray-600"),children:"Advanced AI training features for appointment setting, objection handling, and lead qualification will be available in the next update."}),st.jsxs("div",{className:"mt-6 inline-flex items-center px-4 py-2 rounded-lg "+("gold"===t?"bg-yellow-400/10 border border-yellow-400/20 text-yellow-400":"bg-blue-50 border border-blue-200 text-blue-700"),children:[st.jsx(xe,{className:"h-4 w-4 mr-2"}),st.jsx("span",{className:"text-sm font-medium",children:"In Development"})]})]})]})]})]}),("bookings"===y||"replies"===y||"calendar"===y||"activity"===y)&&st.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[st.jsx("div",{className:"p-6 rounded-xl border "+("gold"===t?"black-card gold-border":"bg-white border-gray-200"),children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"p-2 rounded-lg "+("gold"===t?"bg-green-500/20":"bg-green-100"),children:st.jsx(G,{className:"h-6 w-6 "+("gold"===t?"text-green-400":"text-green-600")})}),st.jsxs("div",{className:"ml-4",children:[st.jsx("p",{className:"text-2xl font-bold "+("gold"===t?"text-yellow-400":"text-gray-900"),children:o.length}),st.jsx("p",{className:"text-sm "+("gold"===t?"text-gray-400":"text-gray-600"),children:"calendar"===y?"Scheduled":"Total Bookings"})]})]})}),st.jsx("div",{className:"p-6 rounded-xl border "+("gold"===t?"black-card gold-border":"bg-white border-gray-200"),children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"p-2 rounded-lg "+("gold"===t?"bg-blue-500/20":"bg-blue-100"),children:st.jsx(O,{className:"h-6 w-6 "+("gold"===t?"text-blue-400":"text-blue-600")})}),st.jsxs("div",{className:"ml-4",children:[st.jsx("p",{className:"text-2xl font-bold "+("gold"===t?"text-yellow-400":"text-gray-900"),children:n.length}),st.jsx("p",{className:"text-sm "+("gold"===t?"text-gray-400":"text-gray-600"),children:"calendar"===y?"This Week":"replies"===y?"Total Opportunities":"Total Replies"})]})]})}),st.jsx("div",{className:"p-6 rounded-xl border "+("gold"===t?"black-card gold-border":"bg-white border-gray-200"),children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"p-2 rounded-lg "+("gold"===t?"bg-purple-500/20":"bg-purple-100"),children:st.jsx(D,{className:"h-6 w-6 "+("gold"===t?"text-purple-400":"text-purple-600")})}),st.jsxs("div",{className:"ml-4",children:[st.jsx("p",{className:"text-2xl font-bold "+("gold"===t?"text-yellow-400":"text-gray-900"),children:o.filter(e=>e.booking_url).length}),st.jsx("p",{className:"text-sm "+("gold"===t?"text-gray-400":"text-gray-600"),children:"calendar"===y?"Completed":"With Booking URLs"})]})]})})]})]}),j&&st.jsx(Dt,{leadId:j.leadId,campaignId:j.campaignId,onClose:()=>v(null)})]})}function Rt(){const{user:e,isAdmin:t}=nt(),[s,l]=g.useState([]),[r,a]=g.useState([]),[o,d]=g.useState(!0),[m,x]=g.useState(""),[u,h]=g.useState("users");g.useEffect(()=>{e&&t&&y()},[e,t]);const y=()=>c(this,null,function*(){if(e&&t)try{const{data:e,error:t}=yield at.from("users").select("\n          id,\n          full_name,\n          created_at,\n          memberships (role)\n        ");if(t)throw t;const{data:s,error:r}=yield at.auth.admin.listUsers();r&&console.error("Error fetching auth users:",r);const o=(null==e?void 0:e.map(e=>{var t,l,r;const a=null==(t=null==s?void 0:s.users)?void 0:t.find(t=>t.id===e.id);return{id:e.id,full_name:e.full_name,email:(null==a?void 0:a.email)||e.email||"Unknown",created_at:e.created_at,role:(null==(r=null==(l=e.memberships)?void 0:l[0])?void 0:r.role)||"member"}}))||[],{data:i,error:n}=yield at.from("campaigns").select("\n          id,\n          offer,\n          status,\n          created_at,\n          users (full_name)\n        ");if(n)throw n;const d=(null==i?void 0:i.map(e=>{var t;const s=o.find(t=>t.id===e.user_id);return{id:e.id,offer:e.offer,status:e.status,created_at:e.created_at,user:{full_name:(null==(t=e.users)?void 0:t.full_name)||(null==s?void 0:s.full_name)||null,email:(null==s?void 0:s.email)||"Unknown"}}}))||[];l(o),a(d)}catch(s){console.error("Error fetching admin data:",s)}finally{d(!1)}}),p=(e,t)=>c(this,null,function*(){const r="admin"===t?"member":"admin";try{const{error:t}=yield at.from("memberships").update({role:r}).eq("user_id",e);if(t)throw t;l(s.map(t=>t.id===e?n(i({},t),{role:r}):t))}catch(a){console.error("Error updating user role:",a)}}),b=s.filter(e=>{var t;return!m||(null==(t=e.full_name)?void 0:t.toLowerCase().includes(m.toLowerCase()))||e.email.toLowerCase().includes(m.toLowerCase())}),f=r.filter(e=>{var t;return!m||(null==(t=e.offer)?void 0:t.toLowerCase().includes(m.toLowerCase()))||e.user.email.toLowerCase().includes(m.toLowerCase())});return t?o?st.jsx("div",{className:"flex items-center justify-center h-64",children:st.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{children:[st.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Panel"}),st.jsx("p",{className:"mt-2 text-gray-600",children:"Manage users and campaigns across the platform"})]}),st.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[st.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:st.jsx(M,{className:"h-6 w-6 text-blue-600"})}),st.jsxs("div",{className:"ml-4",children:[st.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.length}),st.jsx("p",{className:"text-sm text-gray-600",children:"Total Users"})]})]})}),st.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:st.jsx(E,{className:"h-6 w-6 text-purple-600"})}),st.jsxs("div",{className:"ml-4",children:[st.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.filter(e=>"admin"===e.role).length}),st.jsx("p",{className:"text-sm text-gray-600",children:"Admins"})]})]})}),st.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:st.jsx(z,{className:"h-6 w-6 text-emerald-600"})}),st.jsxs("div",{className:"ml-4",children:[st.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length}),st.jsx("p",{className:"text-sm text-gray-600",children:"Total Campaigns"})]})]})})]}),st.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[st.jsx("div",{className:"border-b border-gray-200",children:st.jsxs("nav",{className:"flex space-x-8 px-6",children:[st.jsx("button",{onClick:()=>h("users"),className:"py-4 px-1 border-b-2 font-medium text-sm "+("users"===u?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Users Management"}),st.jsx("button",{onClick:()=>h("campaigns"),className:"py-4 px-1 border-b-2 font-medium text-sm "+("campaigns"===u?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Campaigns Overview"})]})}),st.jsxs("div",{className:"p-6",children:[st.jsx("div",{className:"mb-6",children:st.jsxs("div",{className:"relative",children:[st.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),st.jsx("input",{type:"text",placeholder:`Search ${u}...`,value:m,onChange:e=>x(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),"users"===u&&st.jsx("div",{className:"overflow-x-auto",children:st.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[st.jsx("thead",{className:"bg-gray-50",children:st.jsxs("tr",{children:[st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),st.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(e=>st.jsxs("tr",{className:"hover:bg-gray-50",children:[st.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:st.jsx(D,{className:"h-5 w-5 text-blue-600"})}),st.jsxs("div",{className:"ml-4",children:[st.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.full_name||"No name"}),st.jsx("div",{className:"text-sm text-gray-500",children:e.email})]})]})}),st.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:st.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+("admin"===e.role?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"),children:["admin"===e.role&&st.jsx(E,{className:"h-3 w-3 mr-1"}),e.role]})}),st.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()}),st.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:st.jsx("button",{onClick:()=>p(e.id,e.role),className:""+("admin"===e.role?"text-red-600 hover:text-red-900":"text-blue-600 hover:text-blue-900"),children:"admin"===e.role?"Remove Admin":"Make Admin"})})]},e.id))})]})}),"campaigns"===u&&st.jsx("div",{className:"overflow-x-auto",children:st.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[st.jsx("thead",{className:"bg-gray-50",children:st.jsxs("tr",{children:[st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Campaign"}),st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Owner"}),st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"})]})}),st.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.map(e=>st.jsxs("tr",{className:"hover:bg-gray-50",children:[st.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-full flex items-center justify-center",children:st.jsx(z,{className:"h-5 w-5 text-emerald-600"})}),st.jsx("div",{className:"ml-4",children:st.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.offer||"Untitled Campaign"})})]})}),st.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[st.jsx("div",{className:"text-sm text-gray-900",children:e.user.full_name||"No name"}),st.jsx("div",{className:"text-sm text-gray-500",children:e.user.email})]}),st.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:st.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+("active"===e.status?"bg-green-100 text-green-800":"paused"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status||"Draft"})}),st.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]},e.id))})]})})]})]})]}):st.jsxs("div",{className:"text-center py-12",children:[st.jsx(Se,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),st.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Access Denied"}),st.jsx("p",{className:"text-gray-600",children:"You need admin privileges to access this page."})]})}function $t({onBack:e,onSuccess:t,onError:s,channelName:l="Gmail Account"}){const{user:r}=nt(),{theme:a}=gt(),[o,d]=g.useState(null),[m,x]=g.useState({email:"",password:"",name:l}),[u,h]=g.useState(!1),[y,p]=g.useState(!1),[b,f]=g.useState(!1),[j,v]=g.useState(null),w=()=>c(this,null,function*(){if(!r)return void s("User not authenticated");const e=yt.validateEmail(m.email);if(e.isValid)if(m.password.trim())if(m.name.trim()){p(!0),v(null);try{const e={user_id:r.id,name:ht.sanitizeInput(m.name),provider:"gmail",channel_type:"email",email_address:ht.sanitizeInput(m.email),sender_id:ht.sanitizeInput(m.email),credentials:{email_provider:"gmail",email_address:ht.sanitizeInput(m.email),smtp_host:"smtp.gmail.com",smtp_port:587,smtp_secure:!0,smtp_username:ht.sanitizeInput(m.email),smtp_password:m.password,connection_type:"smtp"},is_active:!0,max_usage:1e3},{data:s,error:l}=yield at.from("channels").insert([e]).select().single();if(l)throw l;v({success:!0,message:"Gmail connected successfully!"}),setTimeout(()=>{t(s)},1500)}catch(l){console.error("Error connecting Gmail:",l),v({success:!1,message:l instanceof Error?l.message:"Failed to connect Gmail"})}finally{p(!1)}}else v({success:!1,message:"Channel name is required"});else v({success:!1,message:"App password is required"});else v({success:!1,message:e.errors[0]})}),N=()=>c(this,null,function*(){if(m.email&&m.password){f(!0),v(null);try{const e=yield fetch("https://zhlaaaysvzqixnugqbna.supabase.co/functions/v1/test-smtp-connection",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpobGFhYXlzdnpxaXhudWdxYm5hIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE0MDYwOTUsImV4cCI6MjA2Njk4MjA5NX0.oS03M7cfw3JiQObDL5uwvTPc1F54awaOfdmqUBcIVTc","Content-Type":"application/json"},body:JSON.stringify({email:m.email,channel_name:l,host:"smtp.gmail.com",port:587})});if(!e.ok){const t=yield e.json();throw new Error(t.error||"Connection test failed")}v({success:!0,message:"Connection test successful!"})}catch(e){v({success:!1,message:e instanceof Error?e.message:"Connection test failed"})}finally{f(!1)}}else v({success:!1,message:"Please enter email and app password first"})});return o?"app-password"===o?st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{className:"flex items-center space-x-4",children:[st.jsx("button",{onClick:()=>d(null),className:"p-2 rounded-lg transition-colors "+("gold"===a?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"),children:st.jsx(pe,{className:"h-5 w-5"})}),st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-red-500 rounded-xl flex items-center justify-center",children:st.jsxs("svg",{className:"w-7 h-7 text-white",viewBox:"0 0 24 24",children:[st.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),st.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),st.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),st.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}),st.jsxs("div",{children:[st.jsx("h2",{className:"text-xl font-bold "+("gold"===a?"text-gray-200":"text-gray-900"),children:"Connect Your Gmail Account"}),st.jsx("p",{className:"text-sm "+("gold"===a?"text-gray-400":"text-gray-600"),children:"Gmail / G-Suite"})]})]})]}),st.jsxs("div",{className:"p-6 rounded-xl border "+("gold"===a?"border-yellow-400/20 bg-yellow-400/5":"border-blue-200 bg-blue-50"),children:[st.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[st.jsx(Q,{className:"h-5 w-5 "+("gold"===a?"text-yellow-400":"text-blue-600")}),st.jsx("h3",{className:"text-lg font-semibold "+("gold"===a?"text-yellow-400":"text-blue-700"),children:"Quick Setup (2 minutes)"})]}),st.jsxs("div",{className:"text-sm space-y-3 "+("gold"===a?"text-yellow-300":"text-blue-600"),children:[st.jsxs("div",{className:"flex items-start space-x-3",children:[st.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold "+("gold"===a?"bg-yellow-400 text-black":"bg-blue-600 text-white"),children:"1"}),st.jsxs("div",{children:[st.jsx("p",{className:"font-medium",children:"Enable 2-Factor Authentication"}),st.jsx("p",{className:"text-xs opacity-80",children:"Go to your Google Account → Security → 2-Step Verification"})]})]}),st.jsxs("div",{className:"flex items-start space-x-3",children:[st.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold "+("gold"===a?"bg-yellow-400 text-black":"bg-blue-600 text-white"),children:"2"}),st.jsxs("div",{children:[st.jsx("p",{className:"font-medium",children:"Generate App Password"}),st.jsx("p",{className:"text-xs opacity-80",children:'Security → App passwords → Select "Mail" → Generate'})]})]}),st.jsxs("div",{className:"flex items-start space-x-3",children:[st.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold "+("gold"===a?"bg-yellow-400 text-black":"bg-blue-600 text-white"),children:"3"}),st.jsxs("div",{children:[st.jsx("p",{className:"font-medium",children:"Enter credentials below"}),st.jsx("p",{className:"text-xs opacity-80",children:"Use your Gmail address and the generated app password"})]})]})]}),st.jsx("div",{className:"mt-4",children:st.jsxs("a",{href:"https://support.google.com/accounts/answer/185833",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-sm hover:underline "+("gold"===a?"text-yellow-400":"text-blue-600"),children:[st.jsx(ve,{className:"h-4 w-4 mr-1"}),"Watch Google's official tutorial"]})})]}),st.jsxs("div",{className:"p-6 rounded-xl border "+("gold"===a?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-gray-50"),children:[st.jsx("h3",{className:"text-lg font-semibold mb-4 "+("gold"===a?"text-gray-200":"text-gray-900"),children:"Enter Your Gmail Credentials"}),st.jsxs("div",{className:"space-y-4",children:[st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===a?"text-gray-300":"text-gray-700"),children:"Channel Name"}),st.jsx("input",{type:"text",value:m.name,onChange:e=>x(n(i({},m),{name:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===a?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"e.g., My Gmail Account",required:!0})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===a?"text-gray-300":"text-gray-700"),children:"Gmail Address"}),st.jsx("input",{type:"email",value:m.email,onChange:e=>x(n(i({},m),{email:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===a?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"your-email@gmail.com",required:!0})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===a?"text-gray-300":"text-gray-700"),children:"App Password (Not your regular password)"}),st.jsxs("div",{className:"relative",children:[st.jsx("input",{type:u?"text":"password",value:m.password,onChange:e=>x(n(i({},m),{password:e.target.value})),className:"w-full px-3 py-2 pr-10 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===a?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"16-character app password",required:!0}),st.jsx("button",{type:"button",onClick:()=>h(!u),className:"absolute right-3 top-1/2 transform -translate-y-1/2 "+("gold"===a?"text-gray-400":"text-gray-500"),children:u?st.jsx(P,{className:"h-4 w-4"}):st.jsx(R,{className:"h-4 w-4"})})]}),st.jsx("p",{className:"text-xs mt-1 text-gray-500",children:"Use the 16-character app password generated in step 2, not your regular Gmail password"})]})]}),j&&st.jsx("div",{className:"mt-4 rounded-lg border p-4 "+(j.success?"gold"===a?"bg-green-500/10 border-green-500/30 text-green-400":"bg-green-50 border-green-200 text-green-800":"gold"===a?"bg-red-500/10 border-red-500/30 text-red-400":"bg-red-50 border-red-200 text-red-800"),children:st.jsxs("div",{className:"flex items-start",children:[st.jsx("div",{className:"flex-shrink-0",children:j.success?st.jsx($,{className:"h-5 w-5"}):st.jsx(I,{className:"h-5 w-5"})}),st.jsx("div",{className:"ml-3",children:st.jsx("p",{className:"text-sm font-medium",children:j.message})})]})}),st.jsxs("div",{className:"flex space-x-3 mt-6",children:[st.jsx("button",{onClick:N,disabled:b||!m.email||!m.password,className:`flex-1 px-4 py-2 text-sm font-medium rounded-lg border transition-colors ${"gold"===a?"border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border-gray-300 text-gray-700 hover:bg-gray-50"} disabled:opacity-50 disabled:cursor-not-allowed`,children:b?st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),"Testing..."]}):st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx(le,{className:"h-4 w-4 mr-2"}),"Test Connection"]})}),st.jsx("button",{onClick:w,disabled:y||!m.email||!m.password||!m.name,className:`flex-1 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${"gold"===a?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50 disabled:cursor-not-allowed`,children:y?st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),"Connecting..."]}):st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx(oe,{className:"h-4 w-4 mr-2"}),"Connect Gmail"]})})]})]}),st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===a?"bg-green-500/10 border border-green-500/20":"bg-green-50 border border-green-200"),children:[st.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[st.jsx(Se,{className:"h-4 w-4 "+("gold"===a?"text-green-400":"text-green-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===a?"text-green-400":"text-green-700"),children:"Your data is secure"})]}),st.jsxs("ul",{className:"text-xs space-y-1 "+("gold"===a?"text-green-300":"text-green-600"),children:[st.jsx("li",{children:"• App passwords are safer than regular passwords"}),st.jsx("li",{children:"• Your credentials are encrypted and stored securely"}),st.jsx("li",{children:"• You can revoke app passwords anytime in Google settings"}),st.jsx("li",{children:"• We only use this to send emails on your behalf"})]})]}),st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===a?"bg-blue-500/10 border border-blue-500/20":"bg-blue-50 border border-blue-200"),children:[st.jsx("h4",{className:"text-sm font-medium mb-2 "+("gold"===a?"text-blue-400":"text-blue-700"),children:"✅ What you get with Gmail connection:"}),st.jsxs("ul",{className:"text-sm space-y-1 "+("gold"===a?"text-blue-300":"text-blue-600"),children:[st.jsx("li",{children:"• Send emails directly from your Gmail account"}),st.jsx("li",{children:"• Higher deliverability rates"}),st.jsx("li",{children:"• Automatic reply tracking in your Gmail"}),st.jsx("li",{children:"• Professional sender reputation"}),st.jsx("li",{children:"• Integration with your existing email workflow"})]})]})]}):null:st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{className:"flex items-center space-x-4",children:[st.jsx("button",{onClick:e,className:"p-2 rounded-lg transition-colors "+("gold"===a?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"),children:st.jsx(pe,{className:"h-5 w-5"})}),st.jsxs("div",{children:[st.jsx("h2",{className:"text-xl font-bold "+("gold"===a?"text-gray-200":"text-gray-900"),children:"Connect existing accounts"}),st.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[st.jsxs("div",{className:"flex items-center text-sm "+("gold"===a?"text-green-400":"text-green-600"),children:[st.jsx($,{className:"h-4 w-4 mr-2"}),"Connect any IMAP or SMTP email provider"]}),st.jsxs("div",{className:"flex items-center text-sm "+("gold"===a?"text-green-400":"text-green-600"),children:[st.jsx($,{className:"h-4 w-4 mr-2"}),"Sync up replies in the Inbox"]})]})]})]}),st.jsxs("div",{className:"space-y-4",children:[st.jsxs("div",{onClick:()=>d("app-password"),className:"flex items-center p-4 rounded-xl border-2 cursor-pointer transition-all hover:scale-[1.02] "+("gold"===a?"border-yellow-400/30 bg-yellow-400/5 hover:bg-yellow-400/10":"border-gray-200 bg-white hover:bg-gray-50"),children:[st.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-red-500 rounded-xl flex items-center justify-center mr-4",children:st.jsxs("svg",{className:"w-7 h-7 text-white",viewBox:"0 0 24 24",children:[st.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),st.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),st.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),st.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}),st.jsxs("div",{className:"flex-1",children:[st.jsx("h3",{className:"text-lg font-semibold "+("gold"===a?"text-gray-200":"text-gray-900"),children:"Google"}),st.jsx("p",{className:"text-sm "+("gold"===a?"text-gray-400":"text-gray-600"),children:"Gmail / G-Suite"})]}),st.jsx("div",{className:"text-sm "+("gold"===a?"text-yellow-400":"text-blue-600"),children:"→"})]}),st.jsxs("div",{className:"flex items-center p-4 rounded-xl border-2 opacity-50 cursor-not-allowed "+("gold"===a?"border-gray-600 bg-gray-800/50":"border-gray-200 bg-gray-50"),children:[st.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-600 to-blue-800 rounded-xl flex items-center justify-center mr-4",children:st.jsx("svg",{className:"w-7 h-7 text-white",viewBox:"0 0 24 24",children:st.jsx("path",{fill:"currentColor",d:"M7 18h10v-2H7v2zM7 14h10v-2H7v2zM7 10h10V8H7v2zM19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})})}),st.jsxs("div",{className:"flex-1",children:[st.jsx("h3",{className:"text-lg font-semibold "+("gold"===a?"text-gray-400":"text-gray-500"),children:"Microsoft"}),st.jsx("p",{className:"text-sm "+("gold"===a?"text-gray-500":"text-gray-400"),children:"Office 365 / Outlook (Coming Soon)"})]})]}),st.jsxs("div",{className:"flex items-center p-4 rounded-xl border-2 opacity-50 cursor-not-allowed "+("gold"===a?"border-gray-600 bg-gray-800/50":"border-gray-200 bg-gray-50"),children:[st.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center mr-4 "+("gold"===a?"bg-gray-700":"bg-gray-200"),children:st.jsx(L,{className:"h-7 w-7 "+("gold"===a?"text-gray-400":"text-gray-500")})}),st.jsxs("div",{className:"flex-1",children:[st.jsx("h3",{className:"text-lg font-semibold "+("gold"===a?"text-gray-400":"text-gray-500"),children:"Any Provider"}),st.jsx("p",{className:"text-sm "+("gold"===a?"text-gray-500":"text-gray-400"),children:"IMAP / SMTP (Coming Soon)"})]})]})]})]})}function Ft({onClose:e,onSuccess:t}){const{user:s}=nt(),{theme:l}=gt(),[r,a]=g.useState({channel_type:"voice",provider:"",name:"",sender_id:"",credentials:{},max_usage:100,is_active:!0}),[o,d]=g.useState(!1),[m,x]=g.useState(!1),[u,h]=g.useState(null),[y,p]=g.useState(!1),[b,f]=g.useState(!1);return st.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto "+("gold"===l?"bg-black/75":"bg-gray-900/50"),children:st.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:st.jsxs("div",{className:"w-full max-w-2xl rounded-xl shadow-2xl "+("gold"===l?"black-card gold-border":"bg-white border border-gray-200"),children:[st.jsx("div",{className:"p-6 border-b "+("gold"===l?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsx("h2",{className:"text-xl font-bold "+("gold"===l?"text-gray-200":"text-gray-900"),children:"Connect Channel"}),st.jsx("button",{onClick:e,className:"p-2 rounded-lg transition-colors "+("gold"===l?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"),children:st.jsx(ee,{className:"h-5 w-5"})})]})}),st.jsx("div",{className:"p-6 space-y-6",children:b?st.jsx($t,{onBack:()=>f(!1),onSuccess:s=>{t(),e()},onError:e=>{h({success:!1,message:e}),f(!1)},channelName:r.name||"Gmail Account",forceOAuth:!0}):st.jsxs("form",{onSubmit:l=>c(this,null,function*(){if(l.preventDefault(),s)if(r.name.trim())if(r.provider){d(!0),h(null);try{const l={user_id:s.id,name:ht.sanitizeInput(r.name),provider:r.provider,channel_type:r.channel_type,sender_id:r.sender_id?ht.sanitizeInput(r.sender_id):null,credentials:r.credentials,max_usage:r.max_usage,is_active:r.is_active},{error:a}=yield at.from("channels").insert([l]);if(a)throw a;h({success:!0,message:"Channel connected successfully!"}),setTimeout(()=>{t(),e()},1500)}catch(a){console.error("Error saving channel:",a),h({success:!1,message:a instanceof Error?a.message:"Failed to save channel"})}finally{d(!1)}}else h({success:!1,message:"Provider is required"});else h({success:!1,message:"Channel name is required"})}),className:"space-y-6",children:[st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-3 "+("gold"===l?"text-gray-300":"text-gray-700"),children:"Channel Type *"}),st.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[{key:"voice",label:"Voice (Vapi)",icon:J},{key:"sms",label:"SMS (Twilio)",icon:O},{key:"whatsapp",label:"WhatsApp (Twilio)",icon:O},{key:"email",label:"Email (Gmail)",icon:L}].map(e=>{const t=e.icon;return st.jsx("button",{type:"button",onClick:()=>(e=>{var t;const s=(e=>{switch(e){case"voice":return[{value:"vapi",label:"Vapi"}];case"sms":case"whatsapp":return[{value:"twilio",label:"Twilio"}];case"email":return[{value:"gmail",label:"Gmail API"}];default:return[]}})(e);a(n(i({},r),{channel_type:e,provider:(null==(t=s[0])?void 0:t.value)||"",credentials:{},name:"",sender_id:""})),f(!1)})(e.key),className:"p-3 rounded-lg border-2 transition-all "+(r.channel_type===e.key?"gold"===l?"border-yellow-400 bg-yellow-400/10":"border-blue-500 bg-blue-50":"gold"===l?"border-gray-600 hover:border-gray-500":"border-gray-200 hover:border-gray-300"),children:st.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[st.jsx(t,{className:"h-5 w-5 "+(r.channel_type===e.key?"gold"===l?"text-yellow-400":"text-blue-600":"gold"===l?"text-gray-400":"text-gray-500")}),st.jsx("span",{className:"text-xs font-medium text-center "+(r.channel_type===e.key?"gold"===l?"text-yellow-400":"text-blue-600":"gold"===l?"text-gray-300":"text-gray-700"),children:e.label})]})},e.key)})})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===l?"text-gray-300":"text-gray-700"),children:"Channel Name *"}),st.jsx("input",{type:"text",value:r.name,onChange:e=>a(n(i({},r),{name:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"e.g., Main Sales Line, Support Voice, Marketing SMS",required:!0}),st.jsx("p",{className:"text-xs mt-1 text-gray-500",children:"This name will be displayed in your channels list"})]}),"email"===r.channel_type&&"gmail"===r.provider?st.jsx("div",{className:"space-y-4",children:st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===l?"border-yellow-400/20 bg-yellow-400/5":"border-blue-200 bg-blue-50"),children:[st.jsx("h4",{className:"text-sm font-medium mb-3 "+("gold"===l?"text-yellow-400":"text-blue-700"),children:"Choose Gmail Connection Method"}),st.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[st.jsxs("button",{type:"button",onClick:()=>f(!0),className:"p-4 rounded-lg border-2 transition-all text-left "+("gold"===l?"border-yellow-400 bg-yellow-400/10 hover:bg-yellow-400/20":"border-blue-500 bg-blue-50 hover:bg-blue-100"),children:[st.jsx("div",{className:"font-medium mb-1 "+("gold"===l?"text-yellow-400":"text-blue-600"),children:"OAuth2 API (Recommended)"}),st.jsx("div",{className:"text-xs "+("gold"===l?"text-yellow-300":"text-blue-500"),children:"For n8n Gmail API integration"})]}),st.jsxs("div",{className:"p-4 rounded-lg border-2 opacity-50 "+("gold"===l?"border-gray-600 bg-gray-800/50":"border-gray-300 bg-gray-50"),children:[st.jsx("div",{className:"font-medium mb-1 "+("gold"===l?"text-gray-400":"text-gray-500"),children:"SMTP (Legacy)"}),st.jsx("div",{className:"text-xs "+("gold"===l?"text-gray-500":"text-gray-400"),children:"App passwords (not for n8n)"})]})]})]})}):(()=>{const{channel_type:e,provider:t}=r;return"voice"===e&&"vapi"===t?st.jsxs("div",{className:"space-y-4",children:[st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===l?"text-gray-300":"text-gray-700"),children:"Vapi API Key *"}),st.jsxs("div",{className:"relative",children:[st.jsx("input",{type:y?"text":"password",value:r.credentials.api_key||"",onChange:e=>a(n(i({},r),{credentials:n(i({},r.credentials),{api_key:e.target.value})})),className:"w-full px-3 py-2 pr-10 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"sk-...",required:!0}),st.jsx("button",{type:"button",onClick:()=>p(!y),className:"absolute right-3 top-1/2 transform -translate-y-1/2 "+("gold"===l?"text-gray-400":"text-gray-500"),children:y?st.jsx(P,{className:"h-4 w-4"}):st.jsx(R,{className:"h-4 w-4"})})]})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===l?"text-gray-300":"text-gray-700"),children:"Vapi Phone Number ID *"}),st.jsx("input",{type:"text",value:r.credentials.phone_number_id||"",onChange:e=>a(n(i({},r),{credentials:n(i({},r.credentials),{phone_number_id:e.target.value})})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"e.g., 1234567890",required:!0}),st.jsx("p",{className:"text-xs mt-1 text-gray-500",children:"Phone Number ID from your Vapi dashboard"})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===l?"text-gray-300":"text-gray-700"),children:"Vapi Assistant ID *"}),st.jsx("input",{type:"text",value:r.credentials.assistant_id||"",onChange:e=>a(n(i({},r),{credentials:n(i({},r.credentials),{assistant_id:e.target.value})})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"e.g., asst_...",required:!0}),st.jsx("p",{className:"text-xs mt-1 text-gray-500",children:"Assistant ID from your Vapi dashboard"})]})]}):"sms"!==e&&"whatsapp"!==e||"twilio"!==t?null:st.jsxs("div",{className:"space-y-4",children:[st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===l?"text-gray-300":"text-gray-700"),children:"Twilio Account SID *"}),st.jsx("input",{type:"text",value:r.credentials.account_sid||"",onChange:e=>a(n(i({},r),{credentials:n(i({},r.credentials),{account_sid:e.target.value})})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"AC...",required:!0})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===l?"text-gray-300":"text-gray-700"),children:"Twilio Auth Token *"}),st.jsxs("div",{className:"relative",children:[st.jsx("input",{type:y?"text":"password",value:r.credentials.auth_token||"",onChange:e=>a(n(i({},r),{credentials:n(i({},r.credentials),{auth_token:e.target.value})})),className:"w-full px-3 py-2 pr-10 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"Auth Token",required:!0}),st.jsx("button",{type:"button",onClick:()=>p(!y),className:"absolute right-3 top-1/2 transform -translate-y-1/2 "+("gold"===l?"text-gray-400":"text-gray-500"),children:y?st.jsx(P,{className:"h-4 w-4"}):st.jsx(R,{className:"h-4 w-4"})})]})]}),st.jsxs("div",{children:[st.jsxs("label",{className:"block text-sm font-medium mb-2 "+("gold"===l?"text-gray-300":"text-gray-700"),children:["whatsapp"===e?"WhatsApp Number":"Twilio Phone Number"," *"]}),st.jsx("input",{type:"tel",value:r.sender_id,onChange:e=>a(n(i({},r),{sender_id:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"whatsapp"===e?"whatsapp:+1234567890":"+1234567890",required:!0})]})]})})(),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===l?"text-gray-300":"text-gray-700"),children:"Daily Limit"}),st.jsx("input",{type:"number",min:"1",max:"10000",value:r.max_usage,onChange:e=>a(n(i({},r),{max_usage:parseInt(e.target.value)||100})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500")})]}),st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{children:[st.jsx("div",{className:"text-sm font-medium "+("gold"===l?"text-gray-300":"text-gray-700"),children:"Active Channel"}),st.jsx("div",{className:"text-xs text-gray-500",children:"Enable this channel for campaigns"})]}),st.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[st.jsx("input",{type:"checkbox",checked:r.is_active,onChange:e=>a(n(i({},r),{is_active:e.target.checked})),className:"sr-only peer"}),st.jsx("div",{className:`relative w-11 h-6 rounded-full peer ${"gold"===l?"bg-gray-700 peer-checked:bg-yellow-400":"bg-gray-200 peer-checked:bg-blue-600"} peer-focus:outline-none peer-focus:ring-4 ${"gold"===l?"peer-focus:ring-yellow-400/25":"peer-focus:ring-blue-300"} peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all`})]})]}),u&&st.jsx("div",{className:"rounded-lg border p-4 "+(u.success?"gold"===l?"bg-green-500/10 border-green-500/30 text-green-400":"bg-green-50 border-green-200 text-green-800":"gold"===l?"bg-red-500/10 border-red-500/30 text-red-400":"bg-red-50 border-red-200 text-red-800"),children:st.jsxs("div",{className:"flex items-start",children:[st.jsx("div",{className:"flex-shrink-0",children:u.success?st.jsx($,{className:"h-5 w-5"}):st.jsx(I,{className:"h-5 w-5"})}),st.jsx("div",{className:"ml-3",children:st.jsx("p",{className:"text-sm font-medium",children:u.message})})]})}),st.jsxs("div",{className:"flex space-x-3",children:[st.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 text-sm rounded-lg transition-colors "+("gold"===l?"text-gray-400 bg-gray-800 border border-gray-600 hover:bg-gray-700":"text-gray-700 bg-gray-200 hover:bg-gray-300"),children:"Cancel"}),"email"!==r.channel_type&&st.jsx("button",{type:"button",onClick:()=>c(this,null,function*(){x(!0),h(null),setTimeout(()=>{h({success:!0,message:"Connection test successful!"}),x(!1)},2e3)}),disabled:m,className:`px-4 py-2 text-sm font-medium rounded-lg border transition-colors ${"gold"===l?"border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border-gray-300 text-gray-700 hover:bg-gray-50"} disabled:opacity-50`,children:m?st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),"Testing..."]}):st.jsxs(st.Fragment,{children:[st.jsx(le,{className:"h-4 w-4 mr-2"}),"Test Connection"]})}),st.jsx("button",{type:"submit",disabled:o,className:`flex-1 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${"gold"===l?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50`,children:o?st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),"Connecting..."]}):st.jsxs(st.Fragment,{children:[st.jsx(oe,{className:"h-4 w-4 mr-2"}),"Connect Channel"]})})]})]})})]})})})}function Ot({actor:e,onClose:t,onSuccess:s}){const{user:l}=nt(),{theme:r}=gt(),[a,o]=g.useState("consent"),[d,m]=g.useState(null),[u,h]=g.useState(null),[y,p]=g.useState({}),[b,f]=g.useState(!1),[j,v]=g.useState(null),[w,N]=g.useState(!1),k=e.fields.filter(e=>"password"===e.type&&"userAgent"!==e.key).map(e=>e.key),_={cookieNames:k,domain:e.targetDomain,purpose:`Authenticate your ${e.title} account for lead discovery`};g.useEffect(()=>{const e=e=>{e.origin===window.location.origin&&("cookies_captured"===e.data.type?(h(e.data.data),o("preview"),N(!1),d&&(d.close(),m(null))):"capture_error"===e.data.type&&(v(e.data.error),N(!1)))};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[d]);const C=()=>{o("capture"),v(null),N(!0);const t=`https://${e.targetDomain}`,s=window.open(t,"cookie-capture-helper","width=800,height=600,scrollbars=yes,resizable=yes,toolbar=no,menubar=no");if(!s)return v("Popup blocked. Please allow popups for this site."),void N(!1);m(s);const l=setInterval(()=>{try{if(s.closed)return clearInterval(l),N(!1),void o("consent");s.location.hostname===e.targetDomain&&(clearInterval(l),S(s))}catch(t){}},1e3);setTimeout(()=>{s&&!s.closed&&E()},3e3)},S=e=>{try{const t=`\n        // Create capture overlay\n        const overlay = document.createElement('div');\n        overlay.style.cssText = \`\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n          background: rgba(0, 0, 0, 0.8);\n          z-index: 999999;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n        \`;\n\n        const captureBox = document.createElement('div');\n        captureBox.style.cssText = \`\n          background: white;\n          padding: 30px;\n          border-radius: 12px;\n          box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);\n          text-align: center;\n          max-width: 400px;\n          margin: 20px;\n        \`;\n\n        captureBox.innerHTML = \`\n          <div style="margin-bottom: 20px;">\n            <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 50%; margin: 0 auto 15px; display: flex; align-items: center; justify-content: center;">\n              <span style="color: white; font-size: 24px;">🍪</span>\n            </div>\n            <h2 style="margin: 0 0 10px; color: #333; font-size: 18px; font-weight: 600;">Ready to Capture</h2>\n            <p style="margin: 0 0 20px; color: #666; font-size: 14px;">Make sure you're logged in, then click capture to securely read your authentication cookies.</p>\n          </div>\n          \n          <div style="margin-bottom: 20px;">\n            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">\n              <h4 style="margin: 0 0 8px; color: #495057; font-size: 12px; font-weight: 600; text-transform: uppercase;">Will capture these cookies:</h4>\n              <div style="font-family: monospace; font-size: 11px; color: #6c757d;">\n                ${k.join(", ")}\n              </div>\n            </div>\n          </div>\n\n          <button id="captureBtn" style="\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            border: none;\n            padding: 12px 24px;\n            border-radius: 8px;\n            font-size: 14px;\n            font-weight: 600;\n            cursor: pointer;\n            margin-right: 10px;\n            transition: transform 0.2s;\n          " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">\n            🍪 Capture Cookies\n          </button>\n          \n          <button id="cancelBtn" style="\n            background: #6c757d;\n            color: white;\n            border: none;\n            padding: 12px 24px;\n            border-radius: 8px;\n            font-size: 14px;\n            cursor: pointer;\n          ">\n            Cancel\n          </button>\n        \`;\n\n        overlay.appendChild(captureBox);\n        document.body.appendChild(overlay);\n\n        // Handle capture button click\n        document.getElementById('captureBtn').onclick = () => {\n          try {\n            const cookies = {};\n            const cookieString = document.cookie;\n            \n            // Parse cookies\n            cookieString.split(';').forEach(cookie => {\n              const [key, ...valueParts] = cookie.split('=');\n              if (key && valueParts.length > 0) {\n                const cleanKey = key.trim();\n                const cleanValue = valueParts.join('=').trim();\n                if (cleanKey && cleanValue) {\n                  cookies[cleanKey] = cleanValue;\n                }\n              }\n            });\n\n            // Filter to only required cookies\n            const filteredCookies = {};\n            ${JSON.stringify(k)}.forEach(cookieName => {\n              if (cookies[cookieName]) {\n                filteredCookies[cookieName] = cookies[cookieName];\n              }\n            });\n\n            // Send captured data back to parent\n            window.opener.postMessage({\n              type: 'cookies_captured',\n              data: {\n                cookies: filteredCookies,\n                userAgent: navigator.userAgent,\n                domain: window.location.hostname,\n                timestamp: new Date().toISOString()\n              }\n            }, '*');\n\n          } catch (error) {\n            window.opener.postMessage({\n              type: 'capture_error',\n              error: 'Failed to capture cookies: ' + error.message\n            }, '*');\n          }\n        };\n\n        // Handle cancel button\n        document.getElementById('cancelBtn').onclick = () => {\n          window.close();\n        };\n      `;e.eval(t)}catch(t){console.error("Failed to inject capture script:",t),v("Failed to inject capture script. Please use manual setup.")}},E=e=>{v("Auto-capture requires same-origin access. Please use manual setup or browser extension.")},A=()=>c(this,null,function*(){if(u&&l){f(!0);try{const r={};e.fields.forEach(e=>{"userAgent"===e.key?r[e.key]=u.userAgent:u.cookies[e.key]&&(r[e.key]=u.cookies[e.key])});const a=e.fields.filter(e=>{var t;return e.required&&!(null==(t=r[e.key])?void 0:t.trim())}).map(e=>e.label);if(a.length>0)throw new Error(`Missing required cookies: ${a.join(", ")}`);const i=yield fetch("https://zhlaaaysvzqixnugqbna.supabase.co/functions/v1/store-credentials",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpobGFhYXlzdnpxaXhudWdxYm5hIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE0MDYwOTUsImV4cCI6MjA2Njk4MjA5NX0.oS03M7cfw3JiQObDL5uwvTPc1F54awaOfdmqUBcIVTc","Content-Type":"application/json"},body:JSON.stringify({user_id:l.id,actor_slug:e.slug,payload:{actor_slug:e.slug,fields:r,user_agent:u.userAgent,created_at:u.timestamp,capture_method:"auto"}})});if(!i.ok){const e=yield i.json();throw new Error(e.error||"Failed to save credentials")}o("save"),setTimeout(()=>{s(),t()},2e3)}catch(r){console.error("Error saving captured data:",r),v(r instanceof Error?r.message:"Failed to save credentials")}finally{f(!1)}}});return st.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto "+("gold"===r?"bg-black/75":"bg-gray-900/50"),children:st.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:st.jsxs("div",{className:"w-full max-w-2xl rounded-xl shadow-2xl "+("gold"===r?"black-card gold-border":"bg-white border border-gray-200"),children:[st.jsx("div",{className:"p-6 border-b "+("gold"===r?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"text-2xl",children:"social"===e.category?"👥":"maps"===e.category?"🗺️":"jobs"===e.category?"💼":"enrichment"===e.category?"🔍":"search"===e.category?"🔎":"developer"===e.category?"👨‍💻":"academic"===e.category?"🎓":"community"===e.category?"💬":"⚙️"}),st.jsxs("div",{children:[st.jsxs("h2",{className:"text-xl font-bold "+("gold"===r?"text-gray-200":"text-gray-900"),children:["Auto-Capture: ",e.title]}),st.jsxs("p",{className:"text-sm "+("gold"===r?"text-gray-400":"text-gray-600"),children:["Secure cookie capture from ",e.targetDomain]})]})]}),st.jsx("button",{onClick:t,className:"p-2 rounded-lg transition-colors "+("gold"===r?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"),children:st.jsx(ee,{className:"h-5 w-5"})})]})}),st.jsx("div",{className:"p-4 border-b "+("gold"===r?"border-yellow-400/20":"border-gray-200"),children:st.jsx("div",{className:"flex items-center space-x-2",children:["consent","capture","preview","save"].map((e,t)=>st.jsxs(x.Fragment,{children:[st.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold "+(a===e?"gold"===r?"gold-gradient text-black":"bg-blue-600 text-white":["consent","capture","preview"].indexOf(a)>t?"gold"===r?"bg-green-500/20 text-green-400":"bg-green-100 text-green-600":"gold"===r?"bg-gray-700 text-gray-500":"bg-gray-200 text-gray-500"),children:["consent","capture","preview"].indexOf(a)>t?st.jsx($,{className:"h-4 w-4"}):t+1}),t<3&&st.jsx("div",{className:"flex-1 h-0.5 "+(["consent","capture","preview"].indexOf(a)>t?"gold"===r?"bg-green-400":"bg-green-500":"gold"===r?"bg-gray-700":"bg-gray-300")})]},e))})}),st.jsx("div",{className:"p-6",children:(()=>{switch(a){case"consent":return st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{className:"text-center",children:[st.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 "+("gold"===r?"gold-gradient":"bg-blue-100"),children:st.jsx(Se,{className:"h-8 w-8 "+("gold"===r?"text-black":"text-blue-600")})}),st.jsx("h3",{className:"text-xl font-bold mb-2 "+("gold"===r?"text-gray-200":"text-gray-900"),children:"Cookie Capture Consent"}),st.jsx("p",{className:"text-sm "+("gold"===r?"text-gray-400":"text-gray-600"),children:"We need your permission to read authentication cookies from your browser"})]}),st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===r?"border-yellow-400/20 bg-yellow-400/5":"border-blue-200 bg-blue-50"),children:[st.jsxs("h4",{className:"text-sm font-medium mb-3 "+("gold"===r?"text-yellow-400":"text-blue-700"),children:["What we will capture from ",_.domain,":"]}),st.jsxs("div",{className:"space-y-2",children:[_.cookieNames.map(t=>{var s,l;return st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx(Ee,{className:"h-4 w-4 "+("gold"===r?"text-yellow-400":"text-blue-600")}),st.jsx("code",{className:"text-sm font-mono "+("gold"===r?"text-gray-200":"text-gray-900"),children:t}),st.jsx("span",{className:"text-xs px-2 py-1 rounded-full "+((null==(s=e.fields.find(e=>e.key===t))?void 0:s.required)?"gold"===r?"bg-red-500/20 text-red-400":"bg-red-100 text-red-800":"gold"===r?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-800"),children:(null==(l=e.fields.find(e=>e.key===t))?void 0:l.required)?"Required":"Optional"})]},t)}),st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx(Ie,{className:"h-4 w-4 "+("gold"===r?"text-yellow-400":"text-blue-600")}),st.jsx("span",{className:"text-sm "+("gold"===r?"text-gray-200":"text-gray-900"),children:"User Agent (browser information)"})]})]})]}),st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===r?"bg-green-500/10 border border-green-500/20":"bg-green-50 border border-green-200"),children:[st.jsx("h4",{className:"text-sm font-medium mb-2 "+("gold"===r?"text-green-400":"text-green-700"),children:"🔒 Privacy & Security Guarantees"}),st.jsxs("ul",{className:"text-sm space-y-1 "+("gold"===r?"text-green-300":"text-green-600"),children:[st.jsx("li",{children:"• Only captures cookies from your own logged-in session"}),st.jsx("li",{children:"• No passwords or sensitive personal data collected"}),st.jsx("li",{children:"• Credentials encrypted with AES-256 before storage"}),st.jsx("li",{children:"• You can revoke access anytime by deleting credentials"}),st.jsx("li",{children:"• Only used to access data you're already entitled to see"})]})]}),st.jsxs("div",{className:"flex space-x-3",children:[st.jsx("button",{onClick:t,className:"flex-1 px-4 py-2 text-sm rounded-lg transition-colors "+("gold"===r?"text-gray-400 bg-gray-800 border border-gray-600 hover:bg-gray-700":"text-gray-700 bg-gray-200 hover:bg-gray-300"),children:"Cancel"}),st.jsxs("button",{onClick:C,className:"flex-1 px-4 py-2 text-sm font-medium rounded-lg transition-colors "+("gold"===r?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[st.jsx(Se,{className:"h-4 w-4 mr-2"}),"I Consent - Start Capture"]})]})]});case"capture":return st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{className:"text-center",children:[st.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 "+("gold"===r?"gold-gradient":"bg-blue-100"),children:w?st.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-transparent "+("gold"===r?"border-t-black":"border-t-blue-600")}):st.jsx(Ie,{className:"h-8 w-8 "+("gold"===r?"text-black":"text-blue-600")})}),st.jsx("h3",{className:"text-xl font-bold mb-2 "+("gold"===r?"text-gray-200":"text-gray-900"),children:w?"Waiting for Capture...":"Helper Window Opened"}),st.jsx("p",{className:"text-sm "+("gold"===r?"text-gray-400":"text-gray-600"),children:w?"Complete the steps in the helper window to capture your cookies":"A helper window has been opened to capture your cookies"})]}),st.jsxs("div",{className:"p-6 rounded-lg border "+("gold"===r?"border-yellow-400/20 bg-yellow-400/5":"border-blue-200 bg-blue-50"),children:[st.jsx("h4",{className:"text-lg font-semibold mb-4 "+("gold"===r?"text-yellow-400":"text-blue-700"),children:"Follow these steps in the helper window:"}),st.jsxs("ol",{className:"space-y-3 text-sm "+("gold"===r?"text-yellow-300":"text-blue-600"),children:[st.jsxs("li",{className:"flex items-start space-x-3",children:[st.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded-full text-xs font-bold "+("gold"===r?"bg-yellow-400 text-black":"bg-blue-600 text-white"),children:"1"}),st.jsxs("span",{children:["Log in to your ",e.title," account (if not already logged in)"]})]}),st.jsxs("li",{className:"flex items-start space-x-3",children:[st.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded-full text-xs font-bold "+("gold"===r?"bg-yellow-400 text-black":"bg-blue-600 text-white"),children:"2"}),st.jsx("span",{children:'Click the "🍪 Capture Cookies" button when it appears'})]}),st.jsxs("li",{className:"flex items-start space-x-3",children:[st.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded-full text-xs font-bold "+("gold"===r?"bg-yellow-400 text-black":"bg-blue-600 text-white"),children:"3"}),st.jsx("span",{children:"The window will close automatically after capture"})]})]})]}),j&&st.jsx("div",{className:"p-4 rounded-lg border "+("gold"===r?"bg-red-500/10 border-red-500/30 text-red-400":"bg-red-50 border-red-200 text-red-800"),children:st.jsxs("div",{className:"flex items-center",children:[st.jsx(I,{className:"h-4 w-4 mr-2"}),st.jsx("span",{className:"text-sm font-medium",children:j})]})}),st.jsxs("div",{className:"flex space-x-3",children:[st.jsx("button",{onClick:()=>{d&&d.close(),o("consent"),N(!1)},className:"flex-1 px-4 py-2 text-sm rounded-lg transition-colors "+("gold"===r?"text-gray-400 bg-gray-800 border border-gray-600 hover:bg-gray-700":"text-gray-700 bg-gray-200 hover:bg-gray-300"),children:"Cancel"}),st.jsxs("button",{onClick:()=>{d&&!d.closed?d.focus():C()},className:"px-4 py-2 text-sm font-medium rounded-lg border transition-colors "+("gold"===r?"border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border-gray-300 text-gray-700 hover:bg-gray-50"),children:[st.jsx(ve,{className:"h-4 w-4 mr-2"}),"Focus Helper Window"]})]})]});case"preview":return st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{className:"text-center",children:[st.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 "+("gold"===r?"bg-green-500/20":"bg-green-100"),children:st.jsx($,{className:"h-8 w-8 "+("gold"===r?"text-green-400":"text-green-600")})}),st.jsx("h3",{className:"text-xl font-bold mb-2 "+("gold"===r?"text-gray-200":"text-gray-900"),children:"Cookies Captured Successfully!"}),st.jsx("p",{className:"text-sm "+("gold"===r?"text-gray-400":"text-gray-600"),children:"Review the captured data before saving"})]}),u&&st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===r?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-gray-50"),children:[st.jsx("h4",{className:"text-sm font-medium mb-3 "+("gold"===r?"text-gray-300":"text-gray-700"),children:"Captured Data Preview:"}),st.jsxs("div",{className:"space-y-3",children:[st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsx("span",{className:"text-sm "+("gold"===r?"text-gray-400":"text-gray-600"),children:"Domain:"}),st.jsx("span",{className:"text-sm font-mono "+("gold"===r?"text-gray-200":"text-gray-900"),children:u.domain})]}),st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsx("span",{className:"text-sm "+("gold"===r?"text-gray-400":"text-gray-600"),children:"User Agent:"}),st.jsxs("span",{className:"text-sm font-mono truncate max-w-xs "+("gold"===r?"text-gray-200":"text-gray-900"),children:[u.userAgent.substring(0,50),"..."]})]}),st.jsxs("div",{children:[st.jsx("span",{className:"text-sm "+("gold"===r?"text-gray-400":"text-gray-600"),children:"Cookies Captured:"}),st.jsx("div",{className:"mt-2 space-y-2",children:Object.entries(u.cookies).map(([e,t])=>st.jsxs("div",{className:"flex items-center justify-between p-2 rounded "+("gold"===r?"bg-black/30":"bg-white"),children:[st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx($,{className:"h-4 w-4 "+("gold"===r?"text-green-400":"text-green-600")}),st.jsx("code",{className:"text-sm font-mono "+("gold"===r?"text-gray-200":"text-gray-900"),children:e})]}),st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx("span",{className:"text-xs font-mono "+("gold"===r?"text-gray-400":"text-gray-600"),children:y[e]?t:"••••••••••••••••"}),st.jsx("button",{onClick:()=>p(t=>n(i({},t),{[e]:!t[e]})),className:"p-1 rounded transition-colors "+("gold"===r?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"),children:y[e]?st.jsx(P,{className:"h-3 w-3"}):st.jsx(R,{className:"h-3 w-3"})})]})]},e))})]})]})]}),st.jsxs("div",{className:"flex space-x-3",children:[st.jsx("button",{onClick:()=>o("consent"),className:"flex-1 px-4 py-2 text-sm rounded-lg transition-colors "+("gold"===r?"text-gray-400 bg-gray-800 border border-gray-600 hover:bg-gray-700":"text-gray-700 bg-gray-200 hover:bg-gray-300"),children:"Back"}),st.jsx("button",{onClick:A,disabled:b,className:`flex-1 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${"gold"===r?"gold-gradient text-black hover-gold":"bg-green-600 text-white hover:bg-green-700"} disabled:opacity-50`,children:b?st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),"Encrypting & Saving..."]}):st.jsxs(st.Fragment,{children:[st.jsx(T,{className:"h-4 w-4 mr-2"}),"Save & Encrypt"]})})]})]});case"save":return st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{className:"text-center",children:[st.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 "+("gold"===r?"bg-green-500/20":"bg-green-100"),children:st.jsx($,{className:"h-8 w-8 "+("gold"===r?"text-green-400":"text-green-600")})}),st.jsxs("h3",{className:"text-xl font-bold mb-2 "+("gold"===r?"text-gray-200":"text-gray-900"),children:[e.title," Connected Successfully!"]}),st.jsx("p",{className:"text-sm "+("gold"===r?"text-gray-400":"text-gray-600"),children:"Your credentials have been encrypted and stored securely"})]}),st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===r?"bg-green-500/10 border border-green-500/20":"bg-green-50 border border-green-200"),children:[st.jsx("h4",{className:"text-sm font-medium mb-2 "+("gold"===r?"text-green-400":"text-green-700"),children:"✅ What happens next:"}),st.jsxs("ul",{className:"text-sm space-y-1 "+("gold"===r?"text-green-300":"text-green-600"),children:[st.jsxs("li",{children:["• Your ",e.title," integration is now ready to use"]}),st.jsx("li",{children:"• Credentials will be automatically verified"}),st.jsxs("li",{children:["• You can now discover leads from ",e.title]}),st.jsx("li",{children:'• Integration status will show as "Connected"'})]})]})]});default:return null}})()})]})})})}const Mt=[{slug:"linkedin-basic",title:"LinkedIn (Basic)",category:"social",requiresCookies:!0,targetDomain:"linkedin.com",fields:[{key:"cookieString",label:"Raw Cookie String",type:"textarea",required:!1,mask:!1,helper:"Paste full document.cookie from .linkedin.com"},{key:"li_at",label:"li_at",type:"password",required:!0,mask:!0,helper:"Chrome → DevTools → Application → Cookies → .linkedin.com"},{key:"JSESSIONID",label:"JSESSIONID",type:"password",required:!0,mask:!0,helper:".linkedin.com"},{key:"userAgent",label:"User Agent",type:"text",required:!0,mask:!1,helper:"navigator.userAgent"}],verifyHint:"Fetch https://www.linkedin.com/feed/ and detect logged-in marker"},{slug:"linkedin-sales-navigator",title:"LinkedIn Sales Navigator",category:"social",requiresCookies:!0,targetDomain:"linkedin.com",fields:[{key:"cookieString",label:"Raw Cookie String",type:"textarea",required:!1,mask:!1,helper:"Paste full document.cookie from .linkedin.com"},{key:"li_at",label:"li_at",type:"password",required:!0,mask:!0},{key:"JSESSIONID",label:"JSESSIONID",type:"password",required:!0,mask:!0},{key:"li_a",label:"li_a (if present)",type:"password",required:!1,mask:!0},{key:"userAgent",label:"User Agent",type:"text",required:!0,mask:!1}],verifyHint:"Fetch a Sales Navigator page and ensure no auth redirect"},{slug:"x-twitter",title:"X / Twitter",category:"social",requiresCookies:!0,targetDomain:"x.com",fields:[{key:"cookieString",label:"Raw Cookie String",type:"textarea",required:!1,mask:!1,helper:"Paste from .x.com or .twitter.com"},{key:"auth_token",label:"auth_token",type:"password",required:!0,mask:!0},{key:"ct0",label:"ct0 (CSRF)",type:"password",required:!0,mask:!0}],verifyHint:"Fetch https://x.com/settings/account or who-am-I endpoint"},{slug:"facebook-groups",title:"Facebook (Groups)",category:"social",icon:"👥",targetDomain:"facebook.com",requiresCookies:!0,fields:[{key:"cookieString",label:"Raw Cookie String",type:"textarea",required:!1,mask:!1,helper:"Paste from .facebook.com"},{key:"c_user",label:"c_user",type:"password",required:!0,mask:!0},{key:"xs",label:"xs",type:"password",required:!0,mask:!0},{key:"fr",label:"fr",type:"password",required:!1,mask:!0},{key:"userAgent",label:"User Agent",type:"text",required:!0,mask:!1}],verifyHint:"Fetch a joined group page and ensure HTML contains user markers"},{slug:"facebook-groups",title:"Facebook (Groups)",category:"social",requiresCookies:!0,targetDomain:"facebook.com",fields:[{key:"cookieString",label:"Raw Cookie String",type:"textarea",required:!1,mask:!1,helper:"Paste from .facebook.com"},{key:"c_user",label:"c_user",type:"password",required:!0,mask:!0},{key:"xs",label:"xs",type:"password",required:!0,mask:!0},{key:"fr",label:"fr",type:"password",required:!1,mask:!0},{key:"userAgent",label:"User Agent",type:"text",required:!0,mask:!1}],verifyHint:"Fetch a joined group page and ensure HTML contains user markers"},{slug:"facebook-pages",title:"Facebook (Pages)",category:"social",requiresCookies:!0,targetDomain:"facebook.com",fields:[{key:"cookieString",label:"Raw Cookie String",type:"textarea",required:!1,mask:!1},{key:"c_user",label:"c_user",type:"password",required:!0,mask:!0},{key:"xs",label:"xs",type:"password",required:!0,mask:!0},{key:"fr",label:"fr",type:"password",required:!1,mask:!0},{key:"userAgent",label:"User Agent",type:"text",required:!0,mask:!1}],verifyHint:"Fetch /me or a managed page and detect login"},{slug:"instagram-basic",title:"Instagram",category:"social",requiresCookies:!0,targetDomain:"instagram.com",fields:[{key:"cookieString",label:"Raw Cookie String",type:"textarea",required:!1,mask:!1,helper:"Paste from .instagram.com"},{key:"sessionid",label:"sessionid",type:"password",required:!0,mask:!0},{key:"csrftoken",label:"csrftoken",type:"password",required:!0,mask:!0},{key:"userAgent",label:"User Agent",type:"text",required:!0,mask:!1}],verifyHint:"Fetch profile page and detect logged-in state"},{slug:"reddit-auth",title:"Reddit",category:"social",requiresCookies:!0,targetDomain:"reddit.com",fields:[{key:"cookieString",label:"Raw Cookie String",type:"textarea",required:!1,mask:!1,helper:"Paste from .reddit.com"},{key:"reddit_session",label:"reddit_session (or OAuth token)",type:"password",required:!0,mask:!0},{key:"userAgent",label:"User Agent",type:"text",required:!0,mask:!1}],verifyHint:"Fetch https://www.reddit.com/settings/ and ensure no redirect"},{slug:"google-maps",title:"Google Maps",category:"maps",requiresCookies:!0,targetDomain:"maps.google.com",fields:[{key:"cookieString",label:"Raw Cookie String",type:"textarea",required:!1,mask:!1,helper:"Paste from .google.com / .maps.google.com"},{key:"SAPISID",label:"SAPISID",type:"password",required:!0,mask:!0},{key:"__Secure-3PSAPISID",label:"__Secure-3PSAPISID",type:"password",required:!0,mask:!0},{key:"userAgent",label:"User Agent",type:"text",required:!0,mask:!1}],verifyHint:"Fetch a business page; ensure not blocked and cookie accepted"},{slug:"maps-business-details",title:"Maps Business Details",category:"maps",requiresCookies:!0,targetDomain:"maps.google.com",fields:[{key:"reuseFrom",label:"Reuse from Integration",type:"select",required:!1,mask:!1,helper:"Select 'google-maps' to reuse"},{key:"userAgent",label:"User Agent",type:"text",required:!0,mask:!1}],verifyHint:"Same as Google Maps; detail endpoint"},{slug:"indeed-jobs",title:"Indeed Jobs",category:"jobs",requiresCookies:!0,targetDomain:"indeed.com",fields:[{key:"cookieString",label:"Raw Cookie String",type:"textarea",required:!1,mask:!1,helper:"Paste from .indeed.com"},{key:"CTK",label:"CTK (session)",type:"password",required:!0,mask:!0},{key:"userAgent",label:"User Agent",type:"text",required:!0,mask:!1}],verifyHint:"Fetch a saved jobs page and ensure session is valid"},{slug:"glassdoor",title:"Glassdoor",category:"jobs",requiresCookies:!0,targetDomain:"glassdoor.com",fields:[{key:"cookieString",label:"Raw Cookie String",type:"textarea",required:!1,mask:!1,helper:"Paste from .glassdoor.com"},{key:"GDSession",label:"GDSession",type:"password",required:!0,mask:!0},{key:"TS*",label:"TS*",type:"password",required:!1,mask:!0,helper:"Security cookie often named TSxxxxx"},{key:"userAgent",label:"User Agent",type:"text",required:!0,mask:!1}],verifyHint:"Fetch /member/home and detect login"},{slug:"apollo-portal",title:"Apollo.io Portal",category:"enrichment",requiresCookies:!1,targetDomain:"apollo.io",fields:[{key:"apiKey",label:"API Key (preferred)",type:"password",required:!1,mask:!0},{key:"apollographql.session",label:"apollographql.session (cookie)",type:"password",required:!1,mask:!0},{key:"userAgent",label:"User Agent",type:"text",required:!1,mask:!1}],verifyHint:"Ping API key or fetch minimal GraphQL with cookie"},{slug:"contactout",title:"ContactOut",category:"enrichment",requiresCookies:!0,targetDomain:"contactout.com",fields:[{key:"cookieString",label:"Raw Cookie String",type:"textarea",required:!1,mask:!1,helper:"Paste from portal.contactout.com"},{key:"co_session",label:"Portal session (name may vary)",type:"password",required:!0,mask:!0},{key:"userAgent",label:"User Agent",type:"text",required:!0,mask:!1}],verifyHint:"Fetch dashboard page; ensure credits visible"},{slug:"hunter-io",title:"Hunter.io",category:"enrichment",requiresCookies:!1,targetDomain:"hunter.io",fields:[{key:"apiKey",label:"API Key",type:"password",required:!0,mask:!0}],verifyHint:"Ping account endpoint"},{slug:"people-data-labs",title:"People Data Labs",category:"enrichment",requiresCookies:!1,targetDomain:"peopledatalabs.com",fields:[{key:"apiKey",label:"API Key",type:"password",required:!0,mask:!0}],verifyHint:"Ping API key usage endpoint"},{slug:"dropcontact",title:"Dropcontact",category:"enrichment",requiresCookies:!1,targetDomain:"dropcontact.io",fields:[{key:"apiKey",label:"API Key",type:"password",required:!0,mask:!0}],verifyHint:"Ping status endpoint"},{slug:"serper-bing",title:"Serper / Bing API",category:"search",requiresCookies:!1,targetDomain:"serper.dev",fields:[{key:"apiKey",label:"API Key",type:"password",required:!0,mask:!0}],verifyHint:"Ping test search"},{slug:"github-scraper",title:"GitHub",category:"developer",requiresCookies:!0,targetDomain:"github.com",fields:[{key:"cookieString",label:"Raw Cookie String",type:"textarea",required:!1,mask:!1,helper:"Paste from .github.com"},{key:"userSession",label:"userSession (or token)",type:"password",required:!0,mask:!0},{key:"userAgent",label:"User Agent",type:"text",required:!0,mask:!1}],verifyHint:"Fetch profile page while authenticated"},{slug:"stackoverflow-jobs",title:"StackOverflow Jobs",category:"jobs",requiresCookies:!0,targetDomain:"stackoverflow.com",fields:[{key:"cookieString",label:"Raw Cookie String",type:"textarea",required:!1,mask:!1,helper:"Paste from .stackoverflow.com"},{key:"acct",label:"acct/session (name varies)",type:"password",required:!0,mask:!0},{key:"userAgent",label:"User Agent",type:"text",required:!0,mask:!1}],verifyHint:"Fetch saved jobs page"},{slug:"ycombinator-hn",title:"Hacker News",category:"community",requiresCookies:!1,targetDomain:"news.ycombinator.com",fields:[],verifyHint:"No auth required"},{slug:"google-scholar",title:"Google Scholar",category:"academic",requiresCookies:!0,targetDomain:"scholar.google.com",fields:[{key:"cookieString",label:"Raw Cookie String",type:"textarea",required:!1,mask:!1,helper:"Paste from .scholar.google.com"},{key:"SID",label:"SID (or SAPISID)",type:"password",required:!0,mask:!0},{key:"userAgent",label:"User Agent",type:"text",required:!0,mask:!1}],verifyHint:"Fetch profile/search page without captcha"}];function zt(){const{user:e}=nt(),{theme:t}=gt(),[s,l]=g.useState([]),[r,a]=g.useState(!0),[o,d]=g.useState(""),[m,x]=g.useState(""),[u,h]=g.useState(""),[y,p]=g.useState(null),[b,f]=g.useState(!1),[j,v]=g.useState(!1),[w,N]=g.useState("connect"),[k,_]=g.useState({}),[C,I]=g.useState(!1),[A,q]=g.useState(""),[D,L]=g.useState(!1),[F,O]=g.useState(null),[M,z]=g.useState({});g.useEffect(()=>{e&&B()},[e]);const B=()=>c(this,null,function*(){if(e)try{a(!0),l([])}catch(t){console.error("Error fetching credentials:",t),d("Failed to load credentials")}finally{a(!1)}}),V=e=>{p(e),_({}),q(""),I(!1),N("connect"),f(!0)},G=e=>c(this,null,function*(){O(e);try{setTimeout(()=>{O(null),B()},2e3)}catch(t){console.error("Error verifying credentials:",t)}}),W=e=>c(this,null,function*(){if(confirm("Are you sure you want to delete these credentials?"))try{B()}catch(e){console.error("Error deleting credentials:",e),d("Failed to delete credentials")}}),J=e=>{switch(e){case"connected":return"gold"===t?"text-green-400":"text-green-600";case"failed":case"expired":return"gold"===t?"text-red-400":"text-red-600";case"unverified":return"gold"===t?"text-yellow-400":"text-yellow-600";default:return"gold"===t?"text-gray-400":"text-gray-600"}},Y=e=>{switch(e){case"social":return"👥";case"maps":return"🗺️";case"jobs":return"💼";case"enrichment":return"🔍";case"search":return"🔎";case"developer":return"👨‍💻";case"academic":return"🎓";case"community":return"💬";default:return"⚙️"}},K=Mt.filter(e=>{const t=!m||e.title.toLowerCase().includes(m.toLowerCase()),s=!u||e.category===u;return t&&s}),X=[...new Set(Mt.map(e=>e.category))];return r?st.jsx(bt,{size:"lg",message:"Loading credentials vault...",className:"h-64"}):st.jsxs("div",{className:"space-y-6",children:[st.jsx("div",{className:"flex items-center justify-between",children:st.jsxs("div",{children:[st.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:["gold"===t?st.jsx(E,{className:"h-8 w-8 text-yellow-400"}):st.jsx(Se,{className:"h-8 w-8 text-blue-600"}),st.jsx("h1",{className:"text-3xl font-bold "+("gold"===t?"gold-text-gradient":"text-gray-900"),children:"Credentials Vault"})]}),st.jsxs("p",{className:"gold"===t?"text-gray-400":"text-gray-600",children:["Securely manage cookies and API keys for ",Mt.length," scraping integrations"]})]})}),o&&st.jsx(pt,{message:o,onDismiss:()=>d("")}),st.jsx("div",{className:"p-4 rounded-xl border "+("gold"===t?"black-card gold-border":"bg-white border-gray-200"),children:st.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[st.jsx("div",{className:"flex-1 max-w-md",children:st.jsxs("div",{className:"relative",children:[st.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 "+("gold"===t?"text-yellow-400":"text-gray-400")}),st.jsx("input",{type:"text",placeholder:"Search integrations...",value:m,onChange:e=>x(e.target.value),className:`w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 ${"gold"===t?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"} focus:border-transparent`})]})}),st.jsx("div",{className:"flex items-center space-x-3",children:st.jsxs("select",{value:u,onChange:e=>h(e.target.value),className:`px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${"gold"===t?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"} focus:border-transparent`,children:[st.jsx("option",{value:"",children:"All Categories"}),X.map(e=>st.jsxs("option",{value:e,children:[Y(e)," ",e.charAt(0).toUpperCase()+e.slice(1)]},e))]})})]})}),st.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:K.map(e=>{const l=(r=e.slug,s.find(e=>e.actor_slug===r));var r;const a=(e=>{switch(e){case"connected":return $;case"failed":case"expired":return S;case"unverified":return se;default:return xe}})((null==l?void 0:l.status)||"unverified");return st.jsxs("div",{className:"p-6 rounded-xl border transition-all hover:shadow-md "+("gold"===t?"black-card gold-border hover:gold-shadow":"bg-white border-gray-200 hover:shadow-lg"),children:[st.jsxs("div",{className:"flex items-start justify-between mb-4",children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"text-2xl",children:Y(e.category)}),st.jsxs("div",{children:[st.jsx("h3",{className:"font-semibold "+("gold"===t?"text-gray-200":"text-gray-900"),children:e.title}),st.jsx("p",{className:"text-sm "+("gold"===t?"text-gray-400":"text-gray-600"),children:e.targetDomain})]})]}),st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx(a,{className:`h-5 w-5 ${J((null==l?void 0:l.status)||"unverified")}`}),st.jsx("span",{className:"text-xs px-2 py-1 rounded-full "+("connected"===(null==l?void 0:l.status)?"gold"===t?"bg-green-500/20 text-green-400":"bg-green-100 text-green-800":"failed"===(null==l?void 0:l.status)||"expired"===(null==l?void 0:l.status)?"gold"===t?"bg-red-500/20 text-red-400":"bg-red-100 text-red-800":"unverified"===(null==l?void 0:l.status)?"gold"===t?"bg-yellow-500/20 text-yellow-400":"bg-yellow-100 text-yellow-800":"gold"===t?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-800"),children:"connected"===(null==l?void 0:l.status)?"Connected":"failed"===(null==l?void 0:l.status)?"Failed":"expired"===(null==l?void 0:l.status)?"Expired":"unverified"===(null==l?void 0:l.status)?"Unverified":"Not Connected"})]})]}),st.jsxs("div",{className:"mb-4 space-y-2",children:[st.jsx("div",{className:"text-xs text-gray-500",children:"Requires:"}),st.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.requiresCookies?st.jsxs("span",{className:"text-xs px-2 py-1 rounded-full "+("gold"===t?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-700"),children:[st.jsx(Ee,{className:"h-3 w-3 inline mr-1"}),"Cookies"]}):st.jsxs("span",{className:"text-xs px-2 py-1 rounded-full "+("gold"===t?"bg-green-500/20 text-green-400":"bg-green-100 text-green-700"),children:[st.jsx(Ae,{className:"h-3 w-3 inline mr-1"}),"API Key"]}),st.jsxs("span",{className:"text-xs px-2 py-1 rounded-full "+("gold"===t?"bg-purple-500/20 text-purple-400":"bg-purple-100 text-purple-700"),children:[st.jsx(qe,{className:"h-3 w-3 inline mr-1"}),"User Agent"]})]})]}),(null==l?void 0:l.last_verified_at)&&st.jsxs("div",{className:"text-xs mb-4 text-gray-500",children:["Last verified: ",new Date(l.last_verified_at).toLocaleDateString()]}),st.jsx("div",{className:"space-y-2",children:l?st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsxs("button",{onClick:()=>G(e.slug),disabled:F===e.slug,className:`flex-1 inline-flex items-center justify-center px-3 py-2 text-sm rounded-lg transition-colors ${"gold"===t?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-50"} disabled:opacity-50`,children:[F===e.slug?st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}):st.jsx(le,{className:"h-4 w-4 mr-2"}),F===e.slug?"Testing...":"Verify"]}),st.jsx("button",{onClick:()=>V(e),className:"p-2 rounded-lg transition-colors "+("gold"===t?"text-gray-400 hover:bg-gray-800":"text-gray-600 hover:bg-gray-100"),title:"Edit credentials",children:st.jsx(U,{className:"h-4 w-4"})}),st.jsx("button",{onClick:()=>W(e.slug),className:"p-2 rounded-lg transition-colors "+("gold"===t?"text-red-400 hover:bg-red-400/10":"text-red-600 hover:bg-red-50"),title:"Delete credentials",children:st.jsx(Z,{className:"h-4 w-4"})})]}):st.jsxs("div",{className:"space-y-2",children:[e.requiresCookies&&st.jsxs("button",{onClick:()=>{p(e),v(!0)},className:"w-full inline-flex items-center justify-center px-4 py-3 text-sm font-medium rounded-lg transition-colors "+("gold"===t?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[st.jsx(De,{className:"h-4 w-4 mr-2"}),"Connect Automatically",st.jsx("span",{className:"ml-2 text-xs px-2 py-1 rounded-full "+("gold"===t?"bg-black/20":"bg-blue-500"),children:"Recommended"})]}),st.jsxs("button",{onClick:()=>V(e),className:"w-full inline-flex items-center justify-center px-4 py-2 text-sm rounded-lg border transition-colors "+("gold"===t?"border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border-gray-300 text-gray-700 hover:bg-gray-50"),children:[st.jsx(U,{className:"h-4 w-4 mr-2"}),e.requiresCookies?"Manual Setup":"Connect"]})]})})]},e.slug)})}),j&&y&&st.jsx(Ot,{actor:y,onClose:()=>{v(!1),p(null)},onSuccess:()=>{v(!1),p(null),B()}}),b&&y&&st.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto "+("gold"===t?"bg-black/75":"bg-gray-900/50"),children:st.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:st.jsxs("div",{className:"w-full max-w-4xl rounded-xl shadow-2xl "+("gold"===t?"black-card gold-border":"bg-white border border-gray-200"),children:[st.jsx("div",{className:"p-6 border-b "+("gold"===t?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"text-2xl",children:Y(y.category)}),st.jsxs("div",{children:[st.jsxs("h2",{className:"text-xl font-bold "+("gold"===t?"text-gray-200":"text-gray-900"),children:["Connect ",y.title]}),st.jsx("p",{className:"text-sm "+("gold"===t?"text-gray-400":"text-gray-600"),children:y.targetDomain})]})]}),st.jsx("button",{onClick:()=>f(!1),className:"p-2 rounded-lg transition-colors "+("gold"===t?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"),children:st.jsx(ee,{className:"h-5 w-5"})})]})}),st.jsx("div",{className:"border-b "+("gold"===t?"border-yellow-400/20":"border-gray-200"),children:st.jsx("nav",{className:"flex px-6",children:[{key:"connect",label:"Connect",icon:H},{key:"how-to",label:"How to get cookies",icon:Ee},{key:"verify",label:"Test & Verify",icon:le},{key:"advanced",label:"Advanced",icon:U}].map(e=>{const s=e.icon;return st.jsxs("button",{onClick:()=>N(e.key),className:"py-4 px-4 border-b-2 font-medium text-sm whitespace-nowrap flex items-center space-x-2 "+(w===e.key?"gold"===t?"border-yellow-400 text-yellow-400":"border-blue-500 text-blue-600":"gold"===t?"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[st.jsx(s,{className:"h-4 w-4"}),st.jsx("span",{children:e.label})]},e.key)})})}),st.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:["connect"===w&&st.jsxs("div",{className:"space-y-6",children:[y.requiresCookies&&st.jsxs("div",{className:"p-6 rounded-lg border-2 "+("gold"===t?"border-yellow-400 bg-yellow-400/10":"border-blue-500 bg-blue-50"),children:[st.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[st.jsx(De,{className:"h-6 w-6 "+("gold"===t?"text-yellow-400":"text-blue-600")}),st.jsxs("div",{children:[st.jsx("h3",{className:"text-lg font-bold "+("gold"===t?"text-yellow-400":"text-blue-600"),children:"Connect Automatically (Recommended)"}),st.jsx("p",{className:"text-sm "+("gold"===t?"text-yellow-300":"text-blue-500"),children:"Secure one-click setup with guided cookie capture"})]})]}),st.jsxs("div",{className:"mb-4 p-3 rounded-lg "+("gold"===t?"bg-black/20":"bg-white"),children:[st.jsx("h4",{className:"text-sm font-medium mb-2 "+("gold"===t?"text-gray-200":"text-gray-900"),children:"How it works:"}),st.jsxs("ol",{className:"text-sm space-y-1 list-decimal list-inside "+("gold"===t?"text-gray-300":"text-gray-700"),children:[st.jsxs("li",{children:["Opens secure helper window to ",y.targetDomain]}),st.jsx("li",{children:"Log in to your account (if needed)"}),st.jsx("li",{children:'Click "Capture Cookies" when ready'}),st.jsx("li",{children:"Review and confirm the captured data"}),st.jsx("li",{children:"Credentials are encrypted and stored securely"})]})]}),st.jsxs("button",{onClick:()=>{f(!1),v(!0)},className:"inline-flex items-center px-4 py-2 text-sm rounded-lg border transition-colors "+("gold"===t?"border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border-gray-300 text-gray-700 hover:bg-gray-50"),children:[st.jsx(De,{className:"h-4 w-4 mr-2"}),"Start Auto-Capture"]})]}),st.jsxs("div",{className:"p-6 rounded-lg border "+("gold"===t?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-gray-50"),children:[st.jsx("h3",{className:"text-lg font-semibold mb-4 "+("gold"===t?"text-gray-200":"text-gray-900"),children:"Manual Setup"}),y.requiresCookies&&st.jsx("div",{className:"mb-6",children:st.jsxs("div",{className:"flex rounded-lg overflow-hidden border",children:[st.jsx("button",{onClick:()=>I(!1),className:"flex-1 px-4 py-2 text-sm font-medium transition-colors "+(C?"gold"===t?"text-gray-400 hover:bg-gray-800":"text-gray-600 hover:bg-gray-100":"gold"===t?"gold-gradient text-black":"bg-blue-600 text-white"),children:"Individual Fields"}),st.jsx("button",{onClick:()=>I(!0),className:"flex-1 px-4 py-2 text-sm font-medium transition-colors "+(C?"gold"===t?"gold-gradient text-black":"bg-blue-600 text-white":"gold"===t?"text-gray-400 hover:bg-gray-800":"text-gray-600 hover:bg-gray-100"),children:"Paste Cookie String"})]})}),C&&y.requiresCookies&&st.jsxs("div",{className:"mb-6 space-y-4",children:[st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===t?"text-gray-300":"text-gray-700"),children:"Raw Cookie String"}),st.jsx("textarea",{value:A,onChange:e=>q(e.target.value),rows:4,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===t?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"Paste your browser cookies here..."}),st.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:["Chrome: DevTools (F12) → Application → Cookies → ",y.targetDomain]})]}),st.jsxs("button",{onClick:()=>{if(!A.trim()||!y)return;const e=(e=>{const t={};return e.split(";").forEach(e=>{const[s,...l]=e.split("=");if(s&&l.length>0){const e=s.trim(),r=l.join("=").trim();e&&r&&(t[e]=r)}}),t})(A),t=i({},k);y.fields.forEach(s=>{"password"===s.type&&e[s.key]&&(t[s.key]=e[s.key])}),t.userAgent=navigator.userAgent,_(t)},disabled:!A.trim(),className:`inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors ${"gold"===t?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-50"} disabled:opacity-50`,children:[st.jsx(qe,{className:"h-4 w-4 mr-2"}),"Parse Cookies"]})]}),st.jsx("div",{className:"space-y-4",children:y.fields.filter(e=>"cookieString"!==e.key).map(e=>{const s=e.mask||"password"===e.type,l=M[e.key]||!1;return st.jsxs("div",{children:[st.jsxs("label",{className:"block text-sm font-medium mb-2 "+("gold"===t?"text-gray-300":"text-gray-700"),children:[e.label,e.required&&st.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),st.jsxs("div",{className:"relative",children:["textarea"===e.type?st.jsx("textarea",{value:k[e.key]||"",onChange:t=>_(s=>n(i({},s),{[e.key]:t.target.value})),rows:3,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===t?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:e.helper||""}):"select"===e.type?st.jsxs("select",{value:k[e.key]||"",onChange:t=>_(s=>n(i({},s),{[e.key]:t.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===t?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),children:[st.jsx("option",{value:"",children:"Select..."}),st.jsx("option",{value:"google-maps",children:"Google Maps"})]}):st.jsx("input",{type:s&&!l?"password":"text",value:k[e.key]||("userAgent"===e.key?navigator.userAgent:""),onChange:t=>_(s=>n(i({},s),{[e.key]:t.target.value})),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${s?"pr-10":""} ${"gold"===t?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"}`,placeholder:e.helper||"",required:e.required}),s&&st.jsx("button",{type:"button",onClick:()=>z(t=>n(i({},t),{[e.key]:!l})),className:"absolute right-3 top-1/2 transform -translate-y-1/2 "+("gold"===t?"text-gray-400":"text-gray-500"),children:l?st.jsx(P,{className:"h-4 w-4"}):st.jsx(R,{className:"h-4 w-4"})})]}),e.helper&&st.jsx("p",{className:"text-xs mt-1 text-gray-500",children:e.helper})]},e.key)})}),st.jsxs("div",{className:"flex space-x-3 mt-6",children:[st.jsx("button",{onClick:()=>f(!1),className:"flex-1 px-4 py-2 text-sm rounded-lg transition-colors "+("gold"===t?"text-gray-400 bg-gray-800 border border-gray-600 hover:bg-gray-700":"text-gray-700 bg-gray-200 hover:bg-gray-300"),children:"Cancel"}),st.jsx("button",{onClick:()=>c(this,null,function*(){if(y&&e){L(!0);try{const e=y.fields.filter(e=>{var t;return e.required&&!(null==(t=k[e.key])?void 0:t.trim())}).map(e=>e.label);if(e.length>0)throw new Error(`Missing required fields: ${e.join(", ")}`);console.log("Would save credentials for:",y.slug,k),f(!1),B()}catch(t){console.error("Error saving credentials:",t),d(t instanceof Error?t.message:"Failed to save credentials")}finally{L(!1)}}}),disabled:D,className:`flex-1 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${"gold"===t?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50`,children:D?st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),"Saving..."]}):st.jsxs(st.Fragment,{children:[st.jsx(oe,{className:"h-4 w-4 mr-2"}),"Save & Encrypt"]})})]})]})]}),"how-to"===w&&st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===t?"bg-blue-500/10 border border-blue-500/20":"bg-blue-50 border border-blue-200"),children:[st.jsxs("h4",{className:"text-sm font-medium mb-3 "+("gold"===t?"text-blue-400":"text-blue-700"),children:["🍪 How to Get Cookies from ",y.title]}),st.jsxs("div",{className:"text-sm space-y-2 "+("gold"===t?"text-blue-300":"text-blue-600"),children:[st.jsxs("p",{children:[st.jsx("strong",{children:"Step 1:"})," Open ",y.targetDomain," in Chrome"]}),st.jsxs("p",{children:[st.jsx("strong",{children:"Step 2:"})," Log in to your account"]}),st.jsxs("p",{children:[st.jsx("strong",{children:"Step 3:"})," Press F12 to open DevTools"]}),st.jsxs("p",{children:[st.jsx("strong",{children:"Step 4:"})," Go to Application → Cookies → .",y.targetDomain]}),st.jsxs("p",{children:[st.jsx("strong",{children:"Step 5:"})," Copy the required cookie values listed below"]})]})]}),st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===t?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-gray-50"),children:[st.jsx("h4",{className:"text-sm font-medium mb-3 "+("gold"===t?"text-gray-300":"text-gray-700"),children:"Required Cookies:"}),st.jsx("div",{className:"space-y-2",children:y.fields.filter(e=>"password"===e.type&&"userAgent"!==e.key).map(e=>st.jsxs("div",{className:"flex items-center justify-between p-2 rounded "+("gold"===t?"bg-black/30":"bg-white"),children:[st.jsx("span",{className:"text-sm font-mono "+("gold"===t?"text-gray-200":"text-gray-900"),children:e.key}),st.jsx("span",{className:"text-xs px-2 py-1 rounded-full "+(e.required?"gold"===t?"bg-red-500/20 text-red-400":"bg-red-100 text-red-800":"gold"===t?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-800"),children:e.required?"Required":"Optional"})]},e.key))})]})]}),"verify"===w&&st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===t?"bg-green-500/10 border border-green-500/20":"bg-green-50 border border-green-200"),children:[st.jsx("h4",{className:"text-sm font-medium mb-2 "+("gold"===t?"text-green-400":"text-green-700"),children:"🔍 Verification Process"}),st.jsx("p",{className:"text-sm "+("gold"===t?"text-green-300":"text-green-600"),children:y.verifyHint})]}),st.jsx("button",{onClick:()=>G(y.slug),disabled:F===y.slug,className:`w-full py-3 px-4 rounded-lg font-medium transition-all ${"gold"===t?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50`,children:F===y.slug?st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),"Verifying..."]}):st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx(le,{className:"h-4 w-4 mr-2"}),"Test Connection"]})})]}),"advanced"===w&&st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===t?"bg-yellow-500/10 border border-yellow-500/20":"bg-yellow-50 border border-yellow-200"),children:[st.jsx("h4",{className:"text-sm font-medium mb-2 "+("gold"===t?"text-yellow-400":"text-yellow-700"),children:"🔒 Security & Compliance"}),st.jsxs("ul",{className:"text-sm space-y-1 "+("gold"===t?"text-yellow-300":"text-yellow-600"),children:[st.jsx("li",{children:"• Credentials are encrypted at rest using AES-256"}),st.jsx("li",{children:"• Only you can access your stored credentials"}),st.jsx("li",{children:"• Verification is rate-limited to prevent abuse"}),st.jsx("li",{children:"• You can revoke access anytime by deleting credentials"}),st.jsx("li",{children:"• We only access data you're entitled to see"})]})]}),st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===t?"bg-gray-500/10 border border-gray-500/20":"bg-gray-50 border border-gray-200"),children:[st.jsx("h4",{className:"text-sm font-medium mb-2 "+("gold"===t?"text-gray-400":"text-gray-700"),children:"🔧 Troubleshooting"}),st.jsxs("ul",{className:"text-sm space-y-1 "+("gold"===t?"text-gray-300":"text-gray-600"),children:[st.jsxs("li",{children:["• ",st.jsx("strong",{children:"Verification fails:"})," Check if you're logged in to ",y.targetDomain]}),st.jsxs("li",{children:["• ",st.jsx("strong",{children:"Cookies expire:"})," Re-capture cookies after logging in again"]}),st.jsxs("li",{children:["• ",st.jsx("strong",{children:"Rate limited:"})," Wait before trying verification again"]}),st.jsxs("li",{children:["• ",st.jsx("strong",{children:"Auto-capture blocked:"})," Use manual setup as fallback"]})]})]})]})]})]})})}),st.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[st.jsx("div",{className:"p-6 rounded-xl border "+("gold"===t?"black-card gold-border":"bg-white border-gray-200"),children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"p-2 rounded-lg "+("gold"===t?"bg-blue-500/20":"bg-blue-100"),children:st.jsx(Le,{className:"h-6 w-6 "+("gold"===t?"text-blue-400":"text-blue-600")})}),st.jsxs("div",{className:"ml-4",children:[st.jsx("p",{className:"text-2xl font-bold "+("gold"===t?"text-yellow-400":"text-gray-900"),children:Mt.length}),st.jsx("p",{className:"text-sm "+("gold"===t?"text-gray-400":"text-gray-600"),children:"Available Integrations"})]})]})}),st.jsx("div",{className:"p-6 rounded-xl border "+("gold"===t?"black-card gold-border":"bg-white border-gray-200"),children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"p-2 rounded-lg "+("gold"===t?"bg-green-500/20":"bg-green-100"),children:st.jsx($,{className:"h-6 w-6 "+("gold"===t?"text-green-400":"text-green-600")})}),st.jsxs("div",{className:"ml-4",children:[st.jsx("p",{className:"text-2xl font-bold "+("gold"===t?"text-yellow-400":"text-gray-900"),children:s.filter(e=>"connected"===e.status).length}),st.jsx("p",{className:"text-sm "+("gold"===t?"text-gray-400":"text-gray-600"),children:"Connected"})]})]})}),st.jsx("div",{className:"p-6 rounded-xl border "+("gold"===t?"black-card gold-border":"bg-white border-gray-200"),children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"p-2 rounded-lg "+("gold"===t?"bg-yellow-500/20":"bg-yellow-100"),children:st.jsx(se,{className:"h-6 w-6 "+("gold"===t?"text-yellow-400":"text-yellow-600")})}),st.jsxs("div",{className:"ml-4",children:[st.jsx("p",{className:"text-2xl font-bold "+("gold"===t?"text-yellow-400":"text-gray-900"),children:s.filter(e=>"failed"===e.status||"expired"===e.status).length}),st.jsx("p",{className:"text-sm "+("gold"===t?"text-gray-400":"text-gray-600"),children:"Need Attention"})]})]})}),st.jsx("div",{className:"p-6 rounded-xl border "+("gold"===t?"black-card gold-border":"bg-white border-gray-200"),children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"p-2 rounded-lg "+("gold"===t?"bg-purple-500/20":"bg-purple-100"),children:st.jsx(T,{className:"h-6 w-6 "+("gold"===t?"text-purple-400":"text-purple-600")})}),st.jsxs("div",{className:"ml-4",children:[st.jsx("p",{className:"text-2xl font-bold "+("gold"===t?"text-yellow-400":"text-gray-900"),children:s.length}),st.jsx("p",{className:"text-sm "+("gold"===t?"text-gray-400":"text-gray-600"),children:"Total Stored"})]})]})})]})]})}function Ut(){var e;const{user:t}=nt(),{theme:s,toggleTheme:l}=gt(),[r,a]=g.useState("channels"),[o,i]=g.useState([]),[n,d]=g.useState(!0),[m,x]=g.useState(!1),u=[{key:"profile",label:"Profile",icon:D},{key:"notifications",label:"Notifications",icon:Te},{key:"security",label:"Security",icon:Se},{key:"appearance",label:"Appearance",icon:Pe},{key:"channels",label:"Channels",icon:O},{key:"vault",label:"Credentials Vault",icon:Le}];g.useEffect(()=>{t&&"channels"===r&&h()},[t,r]);const h=()=>c(this,null,function*(){if(t)try{const{data:e,error:s}=yield at.from("channels").select("*").eq("user_id",t.id).order("created_at",{ascending:!1});if(s)throw s;i(e||[])}catch(e){console.error("Error fetching channels:",e)}finally{d(!1)}}),y=e=>c(this,null,function*(){if(confirm("Are you sure you want to delete this channel?"))try{const{error:s}=yield at.from("channels").delete().eq("id",e).eq("user_id",null==t?void 0:t.id);if(s)throw s;h()}catch(s){console.error("Error deleting channel:",s)}}),p=e=>{switch(e){case"voice":return"gold"===s?"text-yellow-400":"text-blue-600";case"sms":return"gold"===s?"text-yellow-400":"text-green-600";case"whatsapp":return"gold"===s?"text-yellow-400":"text-emerald-600";case"email":return"gold"===s?"text-yellow-400":"text-purple-600";default:return"gold"===s?"text-gray-400":"text-gray-600"}};return st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{children:[st.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:["gold"===s?st.jsx(E,{className:"h-8 w-8 text-yellow-400"}):st.jsx(U,{className:"h-8 w-8 text-blue-600"}),st.jsx("h1",{className:"text-3xl font-bold "+("gold"===s?"gold-text-gradient":"text-gray-900"),children:"Settings"})]}),st.jsx("p",{className:"gold"===s?"text-gray-400":"text-gray-600",children:"Manage your account settings and preferences"})]}),st.jsxs("div",{className:"rounded-xl shadow-sm border "+("gold"===s?"black-card gold-border":"bg-white border-gray-200"),children:[st.jsx("div",{className:"border-b "+("gold"===s?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("nav",{className:"flex overflow-x-auto px-4 sm:px-6",children:[u.map(e=>{const t=e.icon;return st.jsxs("button",{onClick:()=>a(e.key),className:"py-4 px-4 border-b-2 font-medium text-sm whitespace-nowrap flex items-center space-x-2 "+(r===e.key?"gold"===s?"border-yellow-400 text-yellow-400":"border-blue-500 text-blue-600":"gold"===s?"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[st.jsx(t,{className:"h-4 w-4"}),st.jsx("span",{children:e.label})]},e.key)}),st.jsx("button",{onClick:()=>a("vault"),className:"py-4 px-1 border-b-2 font-medium text-sm "+("vault"===r?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Credentials Vault"})]})}),st.jsxs("div",{className:"p-4 sm:p-6",children:["profile"===r&&st.jsx("div",{className:"space-y-6",children:st.jsxs("div",{children:[st.jsx("h3",{className:"text-lg font-semibold mb-4 "+("gold"===s?"text-gray-200":"text-gray-900"),children:"Profile Information"}),st.jsxs("div",{className:"space-y-4",children:[st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Full Name"}),st.jsx("input",{type:"text",defaultValue:(null==(e=null==t?void 0:t.user_metadata)?void 0:e.full_name)||"",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===s?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500")})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Email Address"}),st.jsx("input",{type:"email",defaultValue:(null==t?void 0:t.email)||"",disabled:!0,className:"w-full px-3 py-2 border rounded-lg "+("gold"===s?"border-gray-600 bg-gray-800 text-gray-500":"border-gray-300 bg-gray-50 text-gray-500")}),st.jsx("p",{className:"text-xs mt-1 text-gray-500",children:"Email cannot be changed"})]}),st.jsx("div",{className:"flex justify-end",children:st.jsx("button",{className:"px-4 py-2 text-sm font-medium rounded-lg transition-colors "+("gold"===s?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:"Save Changes"})})]})]})}),"appearance"===r&&st.jsx("div",{className:"space-y-6",children:st.jsxs("div",{children:[st.jsx("h3",{className:"text-lg font-semibold mb-4 "+("gold"===s?"text-gray-200":"text-gray-900"),children:"Appearance Settings"}),st.jsx("div",{className:"space-y-4",children:st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===s?"bg-black/20":"bg-gray-50"),children:[st.jsx("div",{className:"font-medium mb-2 "+("gold"===s?"text-gray-200":"text-gray-900"),children:"Theme"}),st.jsx("div",{className:"text-sm mb-4 "+("gold"===s?"text-gray-400":"text-gray-600"),children:"Choose your preferred theme"}),st.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[st.jsx("button",{onClick:()=>"gold"===s&&l(),className:"p-4 rounded-lg border-2 transition-all "+("blue"===s?"border-blue-500 bg-blue-50":"gold"===s?"border-gray-600 hover:border-gray-500":"border-gray-300 hover:border-gray-400"),children:st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:st.jsx(D,{className:"h-4 w-4 text-white"})}),st.jsxs("div",{className:"text-left",children:[st.jsx("div",{className:"font-medium "+("gold"===s?"text-gray-200":"text-gray-900"),children:"Professional"}),st.jsx("div",{className:"text-sm "+("gold"===s?"text-gray-400":"text-gray-600"),children:"Clean blue theme"})]}),"blue"===s&&st.jsx(Re,{className:"h-5 w-5 text-blue-600 ml-auto"})]})}),st.jsx("button",{onClick:()=>"blue"===s&&l(),className:"p-4 rounded-lg border-2 transition-all "+("gold"===s?"border-yellow-400 bg-yellow-400/10":"border-gray-300 hover:border-gray-400"),children:st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-yellow-400 to-yellow-600 rounded-lg flex items-center justify-center",children:st.jsx(E,{className:"h-4 w-4 text-black"})}),st.jsxs("div",{className:"text-left",children:[st.jsx("div",{className:"font-medium "+("gold"===s?"text-gray-200":"text-gray-900"),children:"Premium Gold"}),st.jsx("div",{className:"text-sm "+("gold"===s?"text-gray-400":"text-gray-600"),children:"Luxury gold theme"})]}),"gold"===s&&st.jsx(Re,{className:"h-5 w-5 text-yellow-400 ml-auto"})]})})]})]})})]})}),"channels"===r&&st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{children:[st.jsx("h3",{className:"text-lg font-semibold "+("gold"===s?"text-gray-200":"text-gray-900"),children:"Connected Channels"}),st.jsx("p",{className:"text-sm "+("gold"===s?"text-gray-400":"text-gray-600"),children:"Manage your communication channel integrations"})]}),st.jsxs("button",{onClick:()=>x(!0),className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors "+("gold"===s?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[st.jsx(H,{className:"h-4 w-4 mr-2"}),"Add Channel"]})]}),n?st.jsx("div",{className:"flex items-center justify-center h-32",children:st.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-transparent "+("gold"===s?"border-t-yellow-400":"border-t-blue-600")})}):0===o.length?st.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg "+("gold"===s?"border-yellow-400/30 text-gray-400":"border-gray-300 text-gray-500"),children:[st.jsx(O,{className:"h-12 w-12 mx-auto mb-4 opacity-50 "+("gold"===s?"text-gray-600":"text-gray-400")}),st.jsx("h3",{className:"text-lg font-medium mb-2 "+("gold"===s?"text-gray-200":"text-gray-900"),children:"No channels configured"}),st.jsx("p",{className:"mb-4",children:"Add your first communication channel to start outreach"}),st.jsxs("button",{onClick:()=>x(!0),className:"inline-flex items-center px-6 py-3 text-sm font-medium rounded-lg transition-colors "+("gold"===s?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[st.jsx(H,{className:"h-4 w-4 mr-2"}),"Add First Channel"]})]}):st.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:o.map(e=>{const t=(e=>{switch(e){case"voice":return J;case"sms":case"whatsapp":default:return O;case"email":return L}})(e.channel_type);return st.jsxs("div",{className:"p-6 rounded-xl border transition-all hover:shadow-md "+("gold"===s?"black-card gold-border hover:gold-shadow":"bg-white border-gray-200 hover:shadow-lg"),children:[st.jsxs("div",{className:"flex items-start justify-between mb-4",children:[st.jsxs("div",{className:"flex items-center space-x-4",children:[st.jsx("div",{className:"p-3 rounded-lg "+("gold"===s?"gold-gradient":"bg-blue-100"),children:st.jsx(t,{className:`h-6 w-6 ${"gold"===s?"text-black":p(e.channel_type).replace("text-yellow-400","text-blue-600")}`})}),st.jsxs("div",{children:[st.jsx("h4",{className:"text-lg font-semibold "+("gold"===s?"text-gray-200":"text-gray-900"),children:e.name}),st.jsxs("p",{className:"text-sm "+("gold"===s?"text-gray-400":"text-gray-600"),children:[e.provider.charAt(0).toUpperCase()+e.provider.slice(1)," • ",e.channel_type.charAt(0).toUpperCase()+e.channel_type.slice(1)]}),(e.sender_id||e.email_address)&&st.jsx("p",{className:"text-xs text-gray-500",children:e.email_address||e.sender_id})]})]}),st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full "+(e.is_active?"gold"===s?"bg-green-500/20 text-green-400":"bg-green-100 text-green-800":"gold"===s?"bg-red-500/20 text-red-400":"bg-red-100 text-red-800"),children:e.is_active?"Active":"Inactive"}),st.jsx("button",{onClick:()=>y(e.id),className:"p-2 rounded-lg transition-colors "+("gold"===s?"text-gray-400 hover:text-red-400 hover:bg-red-400/10":"text-gray-400 hover:text-red-600 hover:bg-red-50"),title:"Delete channel",children:st.jsx(Z,{className:"h-4 w-4"})})]})]}),st.jsxs("div",{className:"space-y-3",children:[st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsx("span",{className:"text-sm "+("gold"===s?"text-gray-400":"text-gray-600"),children:"Usage"}),st.jsxs("span",{className:"text-sm font-medium "+("gold"===s?"text-yellow-400":"text-blue-600"),children:[e.usage_count||0," / ",e.max_usage||100]})]}),st.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 "+("gold"===s?"bg-gray-700":"bg-gray-200"),children:st.jsx("div",{className:"h-2 rounded-full "+("gold"===s?"gold-gradient":"bg-blue-600"),style:{width:`${Math.min((e.usage_count||0)/(e.max_usage||100)*100,100)}%`}})}),st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("span",{className:"text-xs text-gray-500",children:["Added ",new Date(e.created_at).toLocaleDateString()]}),"vapi"===e.provider&&st.jsxs("a",{href:"https://dashboard.vapi.ai",target:"_blank",rel:"noopener noreferrer",className:"text-xs hover:underline flex items-center "+("gold"===s?"text-yellow-400":"text-blue-600"),children:[st.jsx(ve,{className:"h-3 w-3 mr-1"}),"Vapi Dashboard"]}),"twilio"===e.provider&&st.jsxs("a",{href:"https://console.twilio.com",target:"_blank",rel:"noopener noreferrer",className:"text-xs hover:underline flex items-center "+("gold"===s?"text-yellow-400":"text-blue-600"),children:[st.jsx(ve,{className:"h-3 w-3 mr-1"}),"Twilio Console"]}),"gmail"===e.provider&&st.jsxs("a",{href:"https://myaccount.google.com/security",target:"_blank",rel:"noopener noreferrer",className:"text-xs hover:underline flex items-center "+("gold"===s?"text-yellow-400":"text-blue-600"),children:[st.jsx(ve,{className:"h-3 w-3 mr-1"}),"Google Security"]})]})]})]},e.id)})}),st.jsxs("div",{className:"p-6 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-yellow-400/5":"border-blue-200 bg-blue-50"),children:[st.jsx("h4",{className:"text-sm font-medium mb-3 "+("gold"===s?"text-yellow-400":"text-blue-700"),children:"📋 Supported Channels"}),st.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[st.jsxs("div",{className:"space-y-2",children:[st.jsxs("div",{className:"flex items-center text-sm "+("gold"===s?"text-yellow-300":"text-blue-600"),children:[st.jsx(J,{className:"h-4 w-4 mr-2"}),st.jsx("strong",{children:"Voice Calls:"})," Vapi AI"]}),st.jsxs("div",{className:"flex items-center text-sm "+("gold"===s?"text-yellow-300":"text-blue-600"),children:[st.jsx(O,{className:"h-4 w-4 mr-2"}),st.jsx("strong",{children:"SMS:"})," Twilio"]})]}),st.jsxs("div",{className:"space-y-2",children:[st.jsxs("div",{className:"flex items-center text-sm "+("gold"===s?"text-yellow-300":"text-blue-600"),children:[st.jsx(O,{className:"h-4 w-4 mr-2"}),st.jsx("strong",{children:"WhatsApp:"})," Twilio"]}),st.jsxs("div",{className:"flex items-center text-sm "+("gold"===s?"text-yellow-300":"text-blue-600"),children:[st.jsx(L,{className:"h-4 w-4 mr-2"}),st.jsx("strong",{children:"Email:"})," Gmail API"]})]})]})]})]}),"notifications"===r&&st.jsxs("div",{className:"space-y-6",children:[st.jsx("h3",{className:"text-lg font-semibold "+("gold"===s?"text-gray-200":"text-gray-900"),children:"Notification Settings"}),st.jsx("p",{className:"text-sm "+("gold"===s?"text-gray-400":"text-gray-600"),children:"Notification preferences will be available soon."})]}),"security"===r&&st.jsxs("div",{className:"space-y-6",children:[st.jsx("h3",{className:"text-lg font-semibold "+("gold"===s?"text-gray-200":"text-gray-900"),children:"Security Settings"}),st.jsx("p",{className:"text-sm "+("gold"===s?"text-gray-400":"text-gray-600"),children:"Security settings will be available soon."})]}),"vault"===r&&st.jsx(zt,{})]})]}),m&&st.jsx(Ft,{onClose:()=>x(!1),onSuccess:()=>{x(!1),h()}})]})}function Bt(){const{theme:e}=gt(),[t,s]=g.useState([{id:"1",content:"Welcome to the future of cold outreach. Soon, you'll be able to control everything from here. Wait for the surprise... 🚀",sender:"ai",timestamp:new Date}]),[l,r]=g.useState(""),[a,o]=g.useState(!1),i=()=>c(this,null,function*(){if(!l.trim())return;const e={id:Date.now().toString(),content:l,sender:"user",timestamp:new Date};s(t=>[...t,e]),r(""),o(!0),setTimeout(()=>{const e=["The future is coming... You'll soon be able to control your entire outreach empire from this chat interface. 🌟","Imagine managing thousands of leads, optimizing campaigns, and scaling to 100k+ monthly revenue - all through simple conversations with AI. Coming very soon! ⚡","The surprise is bigger than you think. This chat will become your command center for everything. Stay tuned... 🎯","Soon, you'll just tell me what you want to achieve, and I'll handle the rest - campaigns, leads, sequences, analytics, everything. The future is almost here! 🚀"],t={id:(Date.now()+1).toString(),content:e[Math.floor(Math.random()*e.length)],sender:"ai",timestamp:new Date};s(e=>[...e,t]),o(!1)},1500)});return st.jsxs("div",{className:"min-h-screen relative overflow-hidden "+("gold"===e?"bg-gradient-to-br from-black via-gray-900 to-black":"bg-gradient-to-br from-blue-50 via-white to-purple-50"),children:[st.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[st.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 rounded-full blur-3xl opacity-20 animate-pulse "+("gold"===e?"bg-yellow-400":"bg-blue-400")}),st.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-64 h-64 rounded-full blur-3xl opacity-20 animate-pulse bg-purple-400",style:{animationDelay:"1s"}}),st.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-32 h-32 rounded-full blur-2xl opacity-30 animate-bounce "+("gold"===e?"bg-yellow-300":"bg-blue-300"),style:{animationDelay:"2s"}})]}),st.jsxs("div",{className:"relative z-10 max-w-4xl mx-auto px-4 py-8",children:[st.jsxs("div",{className:"text-center mb-12",children:[st.jsx("div",{className:"flex items-center justify-center space-x-4 mb-6",children:st.jsxs("div",{className:"relative p-4 rounded-2xl "+("gold"===e?"gold-gradient":"bg-gradient-to-r from-blue-600 to-purple-600"),children:[st.jsx($e,{className:"h-12 w-12 "+("gold"===e?"text-black":"text-white")}),st.jsx("div",{className:"absolute -top-1 -right-1 w-6 h-6 rounded-full flex items-center justify-center "+("gold"===e?"bg-yellow-300":"bg-blue-400"),children:st.jsx(De,{className:"h-3 w-3 "+("gold"===e?"text-black":"text-white")})})]})}),st.jsx("h1",{className:"text-5xl font-bold mb-4 "+("gold"===e?"bg-gradient-to-r from-yellow-400 via-yellow-300 to-yellow-500 bg-clip-text text-transparent":"bg-gradient-to-r from-blue-600 via-purple-600 to-blue-800 bg-clip-text text-transparent"),children:"AI Controller"}),st.jsx("p",{className:"text-xl mb-8 "+("gold"===e?"text-gray-300":"text-gray-600"),children:"You will be able to control everything from here"}),st.jsxs("div",{className:"inline-flex items-center px-8 py-4 rounded-full border-2 backdrop-blur-sm "+("gold"===e?"border-yellow-400/30 bg-yellow-400/10 text-yellow-400":"border-blue-300/50 bg-blue-100/50 text-blue-700"),children:[st.jsx(xe,{className:"h-6 w-6 mr-3"}),st.jsx("span",{className:"text-lg font-semibold",children:"Wait for the surprise..."}),st.jsx(A,{className:"h-6 w-6 ml-3 animate-pulse"})]})]}),st.jsxs("div",{className:"rounded-2xl border backdrop-blur-sm shadow-2xl "+("gold"===e?"bg-black/40 border-yellow-400/20":"bg-white/70 border-blue-200/50"),children:[st.jsx("div",{className:"p-6 border-b "+("gold"===e?"border-yellow-400/20":"border-blue-200/50"),children:st.jsxs("div",{className:"flex items-center space-x-4",children:[st.jsxs("div",{className:"relative p-3 rounded-xl "+("gold"===e?"gold-gradient":"bg-gradient-to-r from-blue-500 to-purple-500"),children:[st.jsx(be,{className:"h-6 w-6 "+("gold"===e?"text-black":"text-white")}),st.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 rounded-full animate-ping "+("gold"===e?"bg-yellow-400":"bg-blue-400")})]}),st.jsxs("div",{children:[st.jsx("h2",{className:"text-xl font-bold "+("gold"===e?"text-gray-100":"text-gray-900"),children:"AI Controller Preview"}),st.jsx("p",{className:"text-sm "+("gold"===e?"text-gray-400":"text-gray-600"),children:"The future of outreach management"})]})]})}),st.jsxs("div",{className:"h-96 overflow-y-auto p-6 space-y-4",children:[t.map(t=>st.jsx("div",{className:"flex "+("user"===t.sender?"justify-end":"justify-start"),children:st.jsxs("div",{className:"flex items-start space-x-3 max-w-md "+("user"===t.sender?"flex-row-reverse space-x-reverse":""),children:[st.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center "+("user"===t.sender?"gold"===e?"gold-gradient text-black":"bg-gradient-to-r from-blue-600 to-purple-600 text-white":"gold"===e?"bg-gray-800 border border-yellow-400/30 text-yellow-400":"bg-gray-100 border border-blue-200 text-blue-600"),children:"user"===t.sender?st.jsx(D,{className:"h-5 w-5"}):st.jsx(be,{className:"h-5 w-5"})}),st.jsxs("div",{className:"px-6 py-4 rounded-2xl backdrop-blur-sm "+("user"===t.sender?"gold"===e?"bg-yellow-400/20 border border-yellow-400/30 text-gray-100":"bg-gradient-to-r from-blue-600 to-purple-600 text-white":"gold"===e?"bg-gray-800/80 border border-yellow-400/20 text-gray-200":"bg-white/80 border border-blue-200/50 text-gray-900"),children:[st.jsx("p",{className:"text-sm leading-relaxed",children:t.content}),st.jsx("p",{className:"text-xs mt-2 opacity-70",children:t.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},t.id)),a&&st.jsx("div",{className:"flex justify-start",children:st.jsxs("div",{className:"flex items-start space-x-3",children:[st.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center "+("gold"===e?"bg-gray-800 border border-yellow-400/30 text-yellow-400":"bg-gray-100 border border-blue-200 text-blue-600"),children:st.jsx(be,{className:"h-5 w-5"})}),st.jsx("div",{className:"px-6 py-4 rounded-2xl backdrop-blur-sm "+("gold"===e?"bg-gray-800/80 border border-yellow-400/20":"bg-white/80 border border-blue-200/50"),children:st.jsxs("div",{className:"flex space-x-2",children:[st.jsx("div",{className:"w-2 h-2 rounded-full animate-bounce "+("gold"===e?"bg-yellow-400":"bg-blue-600")}),st.jsx("div",{className:"w-2 h-2 rounded-full animate-bounce "+("gold"===e?"bg-yellow-400":"bg-blue-600"),style:{animationDelay:"0.1s"}}),st.jsx("div",{className:"w-2 h-2 rounded-full animate-bounce "+("gold"===e?"bg-yellow-400":"bg-blue-600"),style:{animationDelay:"0.2s"}})]})})]})})]}),st.jsxs("div",{className:"p-6 border-t backdrop-blur-sm "+("gold"===e?"border-yellow-400/20":"border-blue-200/50"),children:[st.jsxs("div",{className:"flex space-x-4",children:[st.jsx("input",{type:"text",value:l,onChange:e=>r(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),i())},placeholder:"Ask the AI Controller anything...",className:`flex-1 px-6 py-4 border rounded-2xl focus:outline-none focus:ring-2 backdrop-blur-sm transition-all ${"gold"===e?"border-yellow-400/30 bg-black/30 text-gray-200 placeholder-gray-400 focus:ring-yellow-400/50":"border-blue-300/50 bg-white/50 text-gray-900 placeholder-gray-500 focus:ring-blue-500/50"} focus:border-transparent`,disabled:a}),st.jsx("button",{onClick:i,disabled:!l.trim()||a,className:`px-6 py-4 rounded-2xl transition-all transform hover:scale-105 ${"gold"===e?"gold-gradient text-black hover:shadow-lg hover:shadow-yellow-400/25":"bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:shadow-lg hover:shadow-blue-500/25"} disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none`,children:st.jsx(fe,{className:"h-5 w-5"})})]}),st.jsx("p",{className:"text-xs mt-3 text-center text-gray-500",children:"🚀 The AI Controller is being built. Soon you'll control everything from here."})]})]}),st.jsx("div",{className:"mt-12 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{title:"Campaign Automation",description:"AI will create, optimize, and manage campaigns automatically",icon:z,color:"gold"===e?"from-yellow-400 to-yellow-600":"from-blue-500 to-blue-700"},{title:"Lead Intelligence",description:"Discover and score leads with advanced AI algorithms",icon:M,color:"gold"===e?"from-purple-400 to-purple-600":"from-purple-500 to-purple-700"},{title:"Smart Analytics",description:"Predictive insights and performance optimization",icon:F,color:"gold"===e?"from-green-400 to-green-600":"from-green-500 to-green-700"},{title:"Sequence Mastery",description:"AI-powered sequence building and optimization",icon:O,color:"gold"===e?"from-blue-400 to-blue-600":"from-indigo-500 to-indigo-700"},{title:"Channel Control",description:"Automatic channel management and optimization",icon:U,color:"gold"===e?"from-orange-400 to-orange-600":"from-orange-500 to-orange-700"},{title:"Revenue Engine",description:"Scale to 100k+ monthly revenue with AI guidance",icon:q,color:"gold"===e?"from-red-400 to-red-600":"from-red-500 to-red-700"}].map((t,s)=>{const l=t.icon;return st.jsxs("div",{className:"group p-6 rounded-2xl border backdrop-blur-sm transition-all duration-500 hover:scale-105 "+("gold"===e?"bg-black/20 border-yellow-400/20 hover:border-yellow-400/40 hover:bg-yellow-400/5":"bg-white/30 border-blue-200/30 hover:border-blue-300/50 hover:bg-white/50"),style:{animationDelay:.1*s+"s"},children:[st.jsx("div",{className:`w-16 h-16 rounded-xl bg-gradient-to-r ${t.color} flex items-center justify-center mb-4 group-hover:scale-110 transition-transform`,children:st.jsx(l,{className:"h-8 w-8 text-white"})}),st.jsx("h3",{className:"text-lg font-bold mb-2 "+("gold"===e?"text-gray-100":"text-gray-900"),children:t.title}),st.jsx("p",{className:"text-sm "+("gold"===e?"text-gray-400":"text-gray-600"),children:t.description})]},s)})}),st.jsx("div",{className:"mt-16 text-center",children:st.jsxs("div",{className:"inline-flex items-center space-x-3 px-8 py-4 rounded-full backdrop-blur-sm "+("gold"===e?"bg-gradient-to-r from-yellow-400/20 to-purple-400/20 border border-yellow-400/30":"bg-gradient-to-r from-blue-100/50 to-purple-100/50 border border-blue-300/50"),children:[st.jsx(Fe,{className:"h-6 w-6 animate-spin "+("gold"===e?"text-yellow-400":"text-blue-600")}),st.jsx("span",{className:"text-lg font-bold "+("gold"===e?"text-yellow-400":"text-blue-700"),children:"Revolutionary Features Loading..."}),st.jsx(Oe,{className:"h-6 w-6 animate-pulse "+("gold"===e?"text-purple-400":"text-purple-600")})]})})]})]})}var Ht={exports:{}};
/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/const Vt=h(Ht.exports=function e(){var t,s="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==s?s:{},l=!s.document&&!!s.postMessage,r=s.IS_PAPA_WORKER||!1,a={},o=0,i={};function n(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=f(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new x(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,t){var l=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<l){let t=this._config.newline;t||(a=this._config.quoteChar||'"',t=this._handle.guessLineEndings(e,a)),e=[...e.split(t).slice(l)].join(t)}this.isFirstChunk&&v(this._config.beforeFirstChunk)&&void 0!==(a=this._config.beforeFirstChunk(e))&&(e=a),this.isFirstChunk=!1,this._halted=!1,l=this._partialLine+e;var a=(this._partialLine="",this._handle.parse(l,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(e=a.meta.cursor,this._finished||(this._partialLine=l.substring(e-this._baseIndex),this._baseIndex=e),a&&a.data&&(this._rowCount+=a.data.length),l=this._finished||this._config.preview&&this._rowCount>=this._config.preview,r)s.postMessage({results:a,workerId:i.WORKER_ID,finished:l});else if(v(this._config.chunk)&&!t){if(this._config.chunk(a,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=a=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(a.data),this._completeResults.errors=this._completeResults.errors.concat(a.errors),this._completeResults.meta=a.meta),this._completed||!l||!v(this._config.complete)||a&&a.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),l||a&&a.meta.paused||this._nextChunk(),a}this._halted=!0},this._sendError=function(e){v(this._config.error)?this._config.error(e):r&&this._config.error&&s.postMessage({workerId:i.WORKER_ID,error:e,finished:!1})}}function d(e){var t;(e=e||{}).chunkSize||(e.chunkSize=i.RemoteChunkSize),n.call(this,e),this._nextChunk=l?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),l||(t.onload=j(this._chunkLoaded,this),t.onerror=j(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!l),this._config.downloadRequestHeaders){var e,s=this._config.downloadRequestHeaders;for(e in s)t.setRequestHeader(e,s[e])}var r;this._config.chunkSize&&(r=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+r));try{t.send(this._config.downloadRequestBody)}catch(a){this._chunkError(a.message)}l&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){var e;4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(null!==(e=(e=t).getResponseHeader("Content-Range"))?parseInt(e.substring(e.lastIndexOf("/")+1)):-1),this.parseChunk(t.responseText)))},this._chunkError=function(e){e=t.statusText||e,this._sendError(new Error(e))}}function c(e){(e=e||{}).chunkSize||(e.chunkSize=i.LocalChunkSize),n.call(this,e);var t,s,l="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,s=e.slice||e.webkitSlice||e.mozSlice,l?((t=new FileReader).onload=j(this._chunkLoaded,this),t.onerror=j(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input,r=(this._config.chunkSize&&(r=Math.min(this._start+this._config.chunkSize,this._input.size),e=s.call(e,this._start,r)),t.readAsText(e,this._config.encoding));l||this._chunkLoaded({target:{result:r}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function g(e){var t;n.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){var e,s;if(!this._finished)return e=this._config.chunkSize,t=e?(s=t.substring(0,e),t.substring(e)):(s=t,""),this._finished=!t,this.parseChunk(s)}}function m(e){n.call(this,e=e||{});var t=[],s=!0,l=!1;this.pause=function(){n.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){n.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){l&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):s=!0},this._streamData=j(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),s&&(s=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(l){this._streamError(l)}},this),this._streamError=j(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=j(function(){this._streamCleanUp(),l=!0,this._streamData("")},this),this._streamCleanUp=j(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function x(e){var t,s,l,r,a=Math.pow(2,53),o=-a,n=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,d=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,c=this,g=0,m=0,x=!1,y=!1,p=[],b={data:[],errors:[],meta:{}};function j(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function w(){if(b&&l&&(k("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+i.DefaultDelimiter+"'"),l=!1),e.skipEmptyLines&&(b.data=b.data.filter(function(e){return!j(e)})),N()){let s=function(t,s){v(e.transformHeader)&&(t=e.transformHeader(t,s)),p.push(t)};if(b)if(Array.isArray(b.data[0])){for(var t=0;N()&&t<b.data.length;t++)b.data[t].forEach(s);b.data.splice(0,1)}else b.data.forEach(s)}function s(t,s){for(var l=e.header?{}:[],r=0;r<t.length;r++){var i=r,c=t[r];c=((t,s)=>{return l=t,e.dynamicTypingFunction&&void 0===e.dynamicTyping[l]&&(e.dynamicTyping[l]=e.dynamicTypingFunction(l)),!0===(e.dynamicTyping[l]||e.dynamicTyping)?"true"===s||"TRUE"===s||"false"!==s&&"FALSE"!==s&&((e=>{if(n.test(e)&&(e=parseFloat(e),o<e&&e<a))return 1})(s)?parseFloat(s):d.test(s)?new Date(s):""===s?null:s):s;var l})(i=e.header?r>=p.length?"__parsed_extra":p[r]:i,c=e.transform?e.transform(c,i):c),"__parsed_extra"===i?(l[i]=l[i]||[],l[i].push(c)):l[i]=c}return e.header&&(r>p.length?k("FieldMismatch","TooManyFields","Too many fields: expected "+p.length+" fields but parsed "+r,m+s):r<p.length&&k("FieldMismatch","TooFewFields","Too few fields: expected "+p.length+" fields but parsed "+r,m+s)),l}var r;b&&(e.header||e.dynamicTyping||e.transform)&&(r=1,!b.data.length||Array.isArray(b.data[0])?(b.data=b.data.map(s),r=b.data.length):b.data=s(b.data,0),e.header&&b.meta&&(b.meta.fields=p),m+=r)}function N(){return e.header&&0===p.length}function k(e,t,s,l){e={type:e,code:t,message:s},void 0!==l&&(e.row=l),b.errors.push(e)}v(e.step)&&(r=e.step,e.step=function(t){b=t,N()?w():(w(),0!==b.data.length&&(g+=t.data.length,e.preview&&g>e.preview?s.abort():(b.data=b.data[0],r(b,c))))}),this.parse=function(r,a,o){var n=e.quoteChar||'"';return e.newline||(e.newline=this.guessLineEndings(r,n)),l=!1,e.delimiter?v(e.delimiter)&&(e.delimiter=e.delimiter(r),b.meta.delimiter=e.delimiter):((n=((t,s,l,r,a)=>{var o,n,d,c;a=a||[",","\t","|",";",i.RECORD_SEP,i.UNIT_SEP];for(var g=0;g<a.length;g++){for(var m,x=a[g],u=0,y=0,p=0,b=(d=void 0,new h({comments:r,delimiter:x,newline:s,preview:10}).parse(t)),f=0;f<b.data.length;f++)l&&j(b.data[f])?p++:(y+=m=b.data[f].length,void 0===d?d=m:0<m&&(u+=Math.abs(m-d),d=m));0<b.data.length&&(y/=b.data.length-p),(void 0===n||u<=n)&&(void 0===c||c<y)&&1.99<y&&(n=u,o=x,c=y)}return{successful:!!(e.delimiter=o),bestDelimiter:o}})(r,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=n.bestDelimiter:(l=!0,e.delimiter=i.DefaultDelimiter),b.meta.delimiter=e.delimiter),n=f(e),e.preview&&e.header&&n.preview++,t=r,s=new h(n),b=s.parse(t,a,o),w(),x?{meta:{paused:!0}}:b||{meta:{paused:!1}}},this.paused=function(){return x},this.pause=function(){x=!0,s.abort(),t=v(e.chunk)?"":t.substring(s.getCharIndex())},this.resume=function(){c.streamer._halted?(x=!1,c.streamer.parseChunk(t,!0)):setTimeout(c.resume,3)},this.aborted=function(){return y},this.abort=function(){y=!0,s.abort(),b.meta.aborted=!0,v(e.complete)&&e.complete(b),t=""},this.guessLineEndings=function(e,t){e=e.substring(0,1048576),t=new RegExp(u(t)+"([^]*?)"+u(t),"gm");var s=(e=e.replace(t,"")).split("\r");if(e=1<(t=e.split("\n")).length&&t[0].length<s[0].length,1===s.length||e)return"\n";for(var l=0,r=0;r<s.length;r++)"\n"===s[r][0]&&l++;return l>=s.length/2?"\r\n":"\r"}}function u(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function h(e){var t=(e=e||{}).delimiter,s=e.newline,l=e.comments,r=e.step,a=e.preview,o=e.fastMode,n=null,d=!1,c=null==e.quoteChar?'"':e.quoteChar,g=c;if(void 0!==e.escapeChar&&(g=e.escapeChar),("string"!=typeof t||-1<i.BAD_DELIMITERS.indexOf(t))&&(t=","),l===t)throw new Error("Comment character same as delimiter");!0===l?l="#":("string"!=typeof l||-1<i.BAD_DELIMITERS.indexOf(l))&&(l=!1),"\n"!==s&&"\r"!==s&&"\r\n"!==s&&(s="\n");var m=0,x=!1;this.parse=function(i,h,y){if("string"!=typeof i)throw new Error("Input must be a string");var p=i.length,b=t.length,f=s.length,j=l.length,w=v(r),N=[],k=[],_=[],C=m=0;if(!i)return F();if(o||!1!==o&&-1===i.indexOf(c)){for(var S=i.split(s),I=0;I<S.length;I++){if(_=S[I],m+=_.length,I!==S.length-1)m+=s.length;else if(y)return F();if(!l||_.substring(0,j)!==l){if(w){if(N=[],T(_.split(t)),O(),x)return F()}else T(_.split(t));if(a&&a<=I)return N=N.slice(0,a),F(!0)}}return F()}for(var E=i.indexOf(t,m),A=i.indexOf(s,m),q=new RegExp(u(g)+u(c),"g"),D=i.indexOf(c,m);;)if(i[m]===c)for(D=m,m++;;){if(-1===(D=i.indexOf(c,D+1)))return y||k.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:N.length,index:m}),R();if(D===p-1)return R(i.substring(m,D).replace(q,c));if(c===g&&i[D+1]===g)D++;else if(c===g||0===D||i[D-1]!==g){-1!==E&&E<D+1&&(E=i.indexOf(t,D+1));var L=P(-1===(A=-1!==A&&A<D+1?i.indexOf(s,D+1):A)?E:Math.min(E,A));if(i.substr(D+1+L,b)===t){_.push(i.substring(m,D).replace(q,c)),i[m=D+1+L+b]!==c&&(D=i.indexOf(c,m)),E=i.indexOf(t,m),A=i.indexOf(s,m);break}if(L=P(A),i.substring(D+1+L,D+1+L+f)===s){if(_.push(i.substring(m,D).replace(q,c)),$(D+1+L+f),E=i.indexOf(t,m),D=i.indexOf(c,m),w&&(O(),x))return F();if(a&&N.length>=a)return F(!0);break}k.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:N.length,index:m}),D++}}else if(l&&0===_.length&&i.substring(m,m+j)===l){if(-1===A)return F();m=A+f,A=i.indexOf(s,m),E=i.indexOf(t,m)}else if(-1!==E&&(E<A||-1===A))_.push(i.substring(m,E)),m=E+b,E=i.indexOf(t,m);else{if(-1===A)break;if(_.push(i.substring(m,A)),$(A+f),w&&(O(),x))return F();if(a&&N.length>=a)return F(!0)}return R();function T(e){N.push(e),C=m}function P(e){var t=0;return-1!==e&&(e=i.substring(D+1,e))&&""===e.trim()?e.length:t}function R(e){return y||(void 0===e&&(e=i.substring(m)),_.push(e),m=p,T(_),w&&O()),F()}function $(e){m=e,T(_),_=[],A=i.indexOf(s,m)}function F(l){if(e.header&&!h&&N.length&&!d){var r=N[0],a=Object.create(null),o=new Set(r);let t=!1;for(let s=0;s<r.length;s++){let l=r[s];if(a[l=v(e.transformHeader)?e.transformHeader(l,s):l]){let e,i=a[l];for(;e=l+"_"+i,i++,o.has(e););o.add(e),r[s]=e,a[l]++,t=!0,(n=null===n?{}:n)[e]=l}else a[l]=1,r[s]=l;o.add(l)}t&&console.warn("Duplicate headers found and renamed."),d=!0}return{data:N,errors:k,meta:{delimiter:t,linebreak:s,aborted:x,truncated:!!l,cursor:C+(h||0),renamedHeaders:n}}}function O(){r(F()),N=[],k=[]}},this.abort=function(){x=!0},this.getCharIndex=function(){return m}}function y(e){var t=e.data,s=a[t.workerId],l=!1;if(t.error)s.userError(t.error,t.file);else if(t.results&&t.results.data){var r={abort:function(){l=!0,p(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:b,resume:b};if(v(s.userStep)){for(var o=0;o<t.results.data.length&&(s.userStep({data:t.results.data[o],errors:t.results.errors,meta:t.results.meta},r),!l);o++);delete t.results}else v(s.userChunk)&&(s.userChunk(t.results,r,t.file),delete t.results)}t.finished&&!l&&p(t.workerId,t.results)}function p(e,t){var s=a[e];v(s.userComplete)&&s.userComplete(t),s.terminate(),delete a[e]}function b(){throw new Error("Not implemented.")}function f(e){if("object"!=typeof e||null===e)return e;var t,s=Array.isArray(e)?[]:{};for(t in e)s[t]=f(e[t]);return s}function j(e,t){return function(){e.apply(t,arguments)}}function v(e){return"function"==typeof e}return i.parse=function(t,l){var r,n=(l=l||{}).dynamicTyping||!1;if(v(n)&&(l.dynamicTypingFunction=n,n={}),l.dynamicTyping=n,l.transform=!!v(l.transform)&&l.transform,!l.worker||!i.WORKERS_SUPPORTED)return n=null,i.NODE_STREAM_INPUT,"string"==typeof t?(t=65279!==(r=t).charCodeAt(0)?r:r.slice(1),n=new(l.download?d:g)(l)):!0===t.readable&&v(t.read)&&v(t.on)?n=new m(l):(s.File&&t instanceof File||t instanceof Object)&&(n=new c(l)),n.stream(t);(n=(()=>{var t,l,r;return!!i.WORKERS_SUPPORTED&&(l=s.URL||s.webkitURL||null,r=e.toString(),t=i.BLOB_URL||(i.BLOB_URL=l.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",r,")();"],{type:"text/javascript"}))),(t=new s.Worker(t)).onmessage=y,t.id=o++,a[t.id]=t)})()).userStep=l.step,n.userChunk=l.chunk,n.userComplete=l.complete,n.userError=l.error,l.step=v(l.step),l.chunk=v(l.chunk),l.complete=v(l.complete),l.error=v(l.error),delete l.worker,n.postMessage({input:t,config:l,workerId:n.id})},i.unparse=function(e,t){var s=!1,l=!0,r=",",a="\r\n",o='"',n=o+o,d=!1,c=null,g=!1,m=((()=>{if("object"==typeof t){if("string"!=typeof t.delimiter||i.BAD_DELIMITERS.filter(function(e){return-1!==t.delimiter.indexOf(e)}).length||(r=t.delimiter),"boolean"!=typeof t.quotes&&"function"!=typeof t.quotes&&!Array.isArray(t.quotes)||(s=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(d=t.skipEmptyLines),"string"==typeof t.newline&&(a=t.newline),"string"==typeof t.quoteChar&&(o=t.quoteChar),"boolean"==typeof t.header&&(l=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");c=t.columns}void 0!==t.escapeChar&&(n=t.escapeChar+o),t.escapeFormulae instanceof RegExp?g=t.escapeFormulae:"boolean"==typeof t.escapeFormulae&&t.escapeFormulae&&(g=/^[=+\-@\t\r].*$/)}})(),new RegExp(u(o),"g"));if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return x(null,e,d);if("object"==typeof e[0])return x(c||Object.keys(e[0]),e,d)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||c),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),x(e.fields||[],e.data||[],d);throw new Error("Unable to serialize unrecognized input");function x(e,t,s){var o="",i=("string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t)),Array.isArray(e)&&0<e.length),n=!Array.isArray(t[0]);if(i&&l){for(var d=0;d<e.length;d++)0<d&&(o+=r),o+=h(e[d],d);0<t.length&&(o+=a)}for(var c=0;c<t.length;c++){var g=(i?e:t[c]).length,m=!1,x=i?0===Object.keys(t[c]).length:0===t[c].length;if(s&&!i&&(m="greedy"===s?""===t[c].join("").trim():1===t[c].length&&0===t[c][0].length),"greedy"===s&&i){for(var u=[],y=0;y<g;y++){var p=n?e[y]:y;u.push(t[c][p])}m=""===u.join("").trim()}if(!m){for(var b=0;b<g;b++){0<b&&!x&&(o+=r);var f=i&&n?e[b]:b;o+=h(t[c][f],b)}c<t.length-1&&(!s||0<g&&!x)&&(o+=a)}}return o}function h(e,t){var l,a;return null==e?"":e.constructor===Date?JSON.stringify(e).slice(1,25):(a=!1,g&&"string"==typeof e&&g.test(e)&&(e="'"+e,a=!0),l=e.toString().replace(m,n),(a=a||!0===s||"function"==typeof s&&s(e,t)||Array.isArray(s)&&s[t]||((e,t)=>{for(var s=0;s<t.length;s++)if(-1<e.indexOf(t[s]))return!0;return!1})(l,i.BAD_DELIMITERS)||-1<l.indexOf(r)||" "===l.charAt(0)||" "===l.charAt(l.length-1))?o+l+o:l)}},i.RECORD_SEP=String.fromCharCode(30),i.UNIT_SEP=String.fromCharCode(31),i.BYTE_ORDER_MARK="\ufeff",i.BAD_DELIMITERS=["\r","\n",'"',i.BYTE_ORDER_MARK],i.WORKERS_SUPPORTED=!l&&!!s.Worker,i.NODE_STREAM_INPUT=1,i.LocalChunkSize=10485760,i.RemoteChunkSize=5242880,i.DefaultDelimiter=",",i.Parser=h,i.ParserHandle=x,i.NetworkStreamer=d,i.FileStreamer=c,i.StringStreamer=g,i.ReadableStreamStreamer=m,s.jQuery&&((t=s.jQuery).fn.parse=function(e){var l=e.config||{},r=[];return this.each(function(e){if("INPUT"!==t(this).prop("tagName").toUpperCase()||"file"!==t(this).attr("type").toLowerCase()||!s.FileReader||!this.files||0===this.files.length)return!0;for(var a=0;a<this.files.length;a++)r.push({file:this.files[a],inputElem:this,instanceConfig:t.extend({},l)})}),a(),this;function a(){if(0===r.length)v(e.complete)&&e.complete();else{var s,l,a,n,d=r[0];if(v(e.before)){var c=e.before(d.file,d.inputElem);if("object"==typeof c){if("abort"===c.action)return s="AbortError",l=d.file,a=d.inputElem,n=c.reason,void(v(e.error)&&e.error({name:s},l,a,n));if("skip"===c.action)return void o();"object"==typeof c.config&&(d.instanceConfig=t.extend(d.instanceConfig,c.config))}else if("skip"===c)return void o()}var g=d.instanceConfig.complete;d.instanceConfig.complete=function(e){v(g)&&g(e,d.file,d.inputElem),o()},i.parse(d.file,d.instanceConfig)}}function o(){r.splice(0,1),a()}}),r&&(s.onmessage=function(e){e=e.data,void 0===i.WORKER_ID&&e&&(i.WORKER_ID=e.workerId),"string"==typeof e.input?s.postMessage({workerId:i.WORKER_ID,results:i.parse(e.input,e.config),finished:!0}):(s.File&&e.input instanceof File||e.input instanceof Object)&&(e=i.parse(e.input,e.config))&&s.postMessage({workerId:i.WORKER_ID,results:e,finished:!0})}),(d.prototype=Object.create(n.prototype)).constructor=d,(c.prototype=Object.create(n.prototype)).constructor=c,(g.prototype=Object.create(g.prototype)).constructor=g,(m.prototype=Object.create(n.prototype)).constructor=m,i}());function Gt({listId:e,onClose:t,onSuccess:s}){const{user:l}=nt(),{theme:r}=gt(),[a,o]=g.useState("csv"),[d,m]=g.useState(null),[x,u]=g.useState(!1),[h,y]=g.useState(null),[p,b]=g.useState({name:"",email:"",phone:"",company_name:"",job_title:"",source_url:"",source_platform:"manual"}),f=t=>c(this,null,function*(){if(!l)return;const s=t.map(t=>({list_id:e,user_id:l.id,name:ht.sanitizeInput(t.name),email:t.email?ht.sanitizeEmail(t.email):null,phone:t.phone?ht.sanitizePhone(t.phone):null,company_name:t.company_name?ht.sanitizeInput(t.company_name):null,job_title:t.job_title?ht.sanitizeInput(t.job_title):null,source_url:t.source_url?ht.sanitizeUrl(t.source_url):null,source_platform:ht.sanitizeInput(t.source_platform),custom_fields:{}}));for(let e=0;e<s.length;e+=50){const t=s.slice(e,e+50),{error:l}=yield at.from("list_leads").insert(t);if(l)throw new Error(`Batch ${Math.floor(e/50)+1} failed: ${l.message}`)}});return st.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto "+("gold"===r?"bg-black/75":"bg-gray-900/50"),children:st.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:st.jsxs("div",{className:"w-full max-w-2xl rounded-xl shadow-2xl "+("gold"===r?"black-card gold-border":"bg-white border border-gray-200"),children:[st.jsx("div",{className:"p-6 border-b "+("gold"===r?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center "+("gold"===r?"gold-gradient":"bg-blue-100"),children:st.jsx(Me,{className:"h-6 w-6 "+("gold"===r?"text-black":"text-blue-600")})}),st.jsxs("div",{children:[st.jsx("h2",{className:"text-xl font-bold "+("gold"===r?"text-gray-200":"text-gray-900"),children:"Upload Leads to List"}),st.jsx("p",{className:"text-sm "+("gold"===r?"text-gray-400":"text-gray-600"),children:"Add leads via CSV upload or manual entry"})]})]}),st.jsx("button",{onClick:t,className:"p-2 rounded-lg transition-colors "+("gold"===r?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"),children:st.jsx(ee,{className:"h-5 w-5"})})]})}),st.jsxs("div",{className:"p-6 space-y-6",children:[st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-3 "+("gold"===r?"text-gray-300":"text-gray-700"),children:"Upload Method"}),st.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[st.jsx("button",{onClick:()=>o("csv"),className:"p-4 rounded-lg border-2 transition-all "+("csv"===a?"gold"===r?"border-yellow-400 bg-yellow-400/10":"border-blue-500 bg-blue-50":"gold"===r?"border-gray-600 hover:border-gray-500":"border-gray-200 hover:border-gray-300"),children:st.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[st.jsx(re,{className:"h-6 w-6 "+("csv"===a?"gold"===r?"text-yellow-400":"text-blue-600":"gold"===r?"text-gray-400":"text-gray-500")}),st.jsx("span",{className:"text-sm font-medium "+("csv"===a?"gold"===r?"text-yellow-400":"text-blue-600":"gold"===r?"text-gray-300":"text-gray-700"),children:"CSV Upload"}),st.jsx("span",{className:"text-xs text-center text-gray-500",children:"Bulk import from file"})]})}),st.jsx("button",{onClick:()=>o("manual"),className:"p-4 rounded-lg border-2 transition-all "+("manual"===a?"gold"===r?"border-yellow-400 bg-yellow-400/10":"border-blue-500 bg-blue-50":"gold"===r?"border-gray-600 hover:border-gray-500":"border-gray-200 hover:border-gray-300"),children:st.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[st.jsx(M,{className:"h-6 w-6 "+("manual"===a?"gold"===r?"text-yellow-400":"text-blue-600":"gold"===r?"text-gray-400":"text-gray-500")}),st.jsx("span",{className:"text-sm font-medium "+("manual"===a?"gold"===r?"text-yellow-400":"text-blue-600":"gold"===r?"text-gray-300":"text-gray-700"),children:"Manual Entry"}),st.jsx("span",{className:"text-xs text-center text-gray-500",children:"Add one lead"})]})})]})]}),"csv"===a&&st.jsxs("div",{className:"space-y-4",children:[st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===r?"text-gray-300":"text-gray-700"),children:"CSV File"}),st.jsxs("div",{className:"border-2 border-dashed rounded-lg p-6 text-center "+("gold"===r?"border-yellow-400/30 bg-yellow-400/5":"border-gray-300 bg-gray-50"),children:[st.jsx("input",{type:"file",accept:".csv",onChange:e=>{var t;const s=null==(t=e.target.files)?void 0:t[0];if(s){if("text/csv"!==s.type&&!s.name.endsWith(".csv"))return void y({success:!1,message:"Please upload a CSV file"});m(s),y(null)}},className:"hidden",id:"csv-upload"}),st.jsxs("label",{htmlFor:"csv-upload",className:"cursor-pointer",children:[st.jsx(Me,{className:"h-8 w-8 mx-auto mb-2 "+("gold"===r?"text-yellow-400":"text-gray-400")}),st.jsx("p",{className:"text-sm font-medium "+("gold"===r?"text-gray-200":"text-gray-900"),children:d?d.name:"Click to upload CSV file"}),st.jsx("p",{className:"text-xs text-gray-500",children:"Supports: name, email, phone, company, job_title columns"})]})]})]}),st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("button",{onClick:()=>{const e=[["name","email","phone","company_name","job_title","source_url","source_platform"],["John Doe","john@company.com","+1234567890","Acme Corp","Marketing Director","https://linkedin.com/in/johndoe","linkedin"],["Jane Smith","jane@startup.com","+1987654321","Startup Inc","CEO","https://company.com/about","website"]].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n"),t=new Blob([e],{type:"text/csv"}),s=URL.createObjectURL(t),l=document.createElement("a");l.href=s,l.download="leads_template.csv",l.click(),URL.revokeObjectURL(s)},className:"inline-flex items-center px-3 py-2 text-sm rounded-lg border transition-colors "+("gold"===r?"border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border-gray-300 text-gray-700 hover:bg-gray-50"),children:[st.jsx(he,{className:"h-4 w-4 mr-2"}),"Download Template"]}),st.jsxs("button",{onClick:()=>c(this,null,function*(){if(d&&l){u(!0),y(null);try{const e=yield d.text();Vt.parse(e,{header:!0,skipEmptyLines:!0,complete:e=>c(this,null,function*(){try{const t=[],s=[];if(e.data.forEach((e,l)=>{try{const s={name:e.name||e.Name||e.full_name||e["Full Name"]||"",email:e.email||e.Email||e.email_address||e["Email Address"]||"",phone:e.phone||e.Phone||e.phone_number||e["Phone Number"]||"",company_name:e.company||e.Company||e.company_name||e["Company Name"]||"",job_title:e.title||e.Title||e.job_title||e["Job Title"]||e.position||e.Position||"",source_url:e.source_url||e["Source URL"]||e.linkedin||e.LinkedIn||"",source_platform:e.source||e.Source||e.platform||e.Platform||"csv_upload"};s.name.trim()||(s.name=`Lead ${l+1}`),t.push(s)}catch(r){s.push(`Row ${l+2}: ${r instanceof Error?r.message:"Processing error"}`)}}),s.length>0&&0===t.length)return y({success:!1,message:`CSV processing failed: ${s.slice(0,5).join(", ")}${s.length>5?"...":""}`}),void u(!1);yield f(t),s.length>0?y({success:!0,message:`Imported ${t.length} leads successfully. ${s.length} rows had errors.`,details:{imported:t.length,errors:s.length}}):y({success:!0,message:`Successfully imported ${t.length} leads to the list!`,details:{imported:t.length,errors:0}})}catch(t){y({success:!1,message:`Import failed: ${t instanceof Error?t.message:"Unknown error"}`})}finally{u(!1)}}),error:e=>{y({success:!1,message:`CSV parsing failed: ${e.message}`}),u(!1)}})}catch(e){y({success:!1,message:`File processing failed: ${e instanceof Error?e.message:"Unknown error"}`}),u(!1)}}}),disabled:!d||x,className:`inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors ${"gold"===r?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50`,children:[x?st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}):st.jsx(Me,{className:"h-4 w-4 mr-2"}),x?"Processing...":"Upload CSV"]})]})]}),"manual"===a&&st.jsxs("form",{onSubmit:e=>c(this,null,function*(){if(e.preventDefault(),l){p.name.trim()||(p.name="Manual Lead"),u(!0),y(null);try{yield f([p]),y({success:!0,message:"Lead added successfully!"}),b({name:"",email:"",phone:"",company_name:"",job_title:"",source_url:"",source_platform:"manual"}),setTimeout(()=>{s(),t()},1500)}catch(r){y({success:!1,message:r instanceof Error?r.message:"Failed to add lead"})}finally{u(!1)}}}),className:"space-y-4",children:[st.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===r?"text-gray-300":"text-gray-700"),children:"Full Name *"}),st.jsx("input",{type:"text",value:p.name,onChange:e=>b(n(i({},p),{name:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===r?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"John Doe",required:!0})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===r?"text-gray-300":"text-gray-700"),children:"Email Address"}),st.jsx("input",{type:"email",value:p.email,onChange:e=>b(n(i({},p),{email:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===r?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"john@company.com"})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===r?"text-gray-300":"text-gray-700"),children:"Phone Number"}),st.jsx("input",{type:"tel",value:p.phone,onChange:e=>b(n(i({},p),{phone:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===r?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"+1234567890"})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===r?"text-gray-300":"text-gray-700"),children:"Company Name"}),st.jsx("input",{type:"text",value:p.company_name,onChange:e=>b(n(i({},p),{company_name:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===r?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"Acme Corp"})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===r?"text-gray-300":"text-gray-700"),children:"Job Title"}),st.jsx("input",{type:"text",value:p.job_title,onChange:e=>b(n(i({},p),{job_title:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===r?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"Marketing Director"})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===r?"text-gray-300":"text-gray-700"),children:"Source URL"}),st.jsx("input",{type:"url",value:p.source_url,onChange:e=>b(n(i({},p),{source_url:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===r?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"https://linkedin.com/in/johndoe"})]})]}),st.jsx("button",{type:"submit",disabled:x,className:`w-full px-4 py-2 text-sm font-medium rounded-lg transition-colors ${"gold"===r?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50`,children:x?st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),"Adding Lead..."]}):"Add Lead to List"})]}),h&&st.jsx("div",{className:"rounded-lg border p-4 "+(h.success?"gold"===r?"bg-green-500/10 border-green-500/30 text-green-400":"bg-green-50 border-green-200 text-green-800":"gold"===r?"bg-red-500/10 border-red-500/30 text-red-400":"bg-red-50 border-red-200 text-red-800"),children:st.jsxs("div",{className:"flex items-start",children:[st.jsx("div",{className:"flex-shrink-0",children:h.success?st.jsx($,{className:"h-5 w-5"}):st.jsx(I,{className:"h-5 w-5"})}),st.jsxs("div",{className:"ml-3",children:[st.jsx("p",{className:"text-sm font-medium",children:h.message}),h.details&&st.jsxs("p",{className:"text-xs mt-1",children:["Imported: ",h.details.imported," | Errors: ",h.details.errors]})]})]})}),"csv"===a&&st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===r?"bg-blue-500/10 border border-blue-500/20":"bg-blue-50 border border-blue-200"),children:[st.jsx("h4",{className:"text-sm font-medium mb-2 "+("gold"===r?"text-blue-400":"text-blue-700"),children:"📋 CSV Format Requirements"}),st.jsxs("ul",{className:"text-sm space-y-1 "+("gold"===r?"text-blue-300":"text-blue-600"),children:[st.jsxs("li",{children:["• ",st.jsx("strong",{children:"Required:"})," name column"]}),st.jsxs("li",{children:["• ",st.jsx("strong",{children:"Optional:"})," email, phone, company_name, job_title, source_url"]}),st.jsx("li",{children:'• Column names are flexible (e.g., "Name", "Full Name", "name" all work)'}),st.jsx("li",{children:"• Phone numbers should include country code (e.g., +1234567890)"}),st.jsx("li",{children:"• Email addresses must be valid format"})]})]})]})]})})})}function Wt({lead:e,listId:t,onClose:s,onSave:l}){const{user:r}=nt(),{theme:a}=gt(),[o,d]=g.useState({name:"",email:"",phone:"",company_name:"",job_title:"",source_url:"",source_platform:""}),[m,x]=g.useState([]),[u,h]=g.useState(!1),[y,p]=g.useState(null);g.useEffect(()=>{if(e){d({name:e.name||"",email:e.email||"",phone:e.phone||"",company_name:e.company_name||"",job_title:e.job_title||"",source_url:e.source_url||"",source_platform:e.source_platform||""});const t=e.custom_fields||{},s=Object.entries(t).map(([e,t])=>({key:e,value:String(t)}));x(s)}},[e]);const b=(e,t,s)=>{const l=[...m];l[e][t]=s,x(l)};return st.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto "+("gold"===a?"bg-black/75":"bg-gray-900/50"),children:st.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:st.jsxs("div",{className:"w-full max-w-2xl rounded-xl shadow-2xl "+("gold"===a?"black-card gold-border":"bg-white border border-gray-200"),children:[st.jsx("div",{className:"p-6 border-b "+("gold"===a?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center "+("gold"===a?"gold-gradient":"bg-blue-100"),children:st.jsx(D,{className:"h-6 w-6 "+("gold"===a?"text-black":"text-blue-600")})}),st.jsxs("div",{children:[st.jsx("h2",{className:"text-xl font-bold "+("gold"===a?"text-gray-200":"text-gray-900"),children:"Edit Lead Information"}),st.jsx("p",{className:"text-sm "+("gold"===a?"text-gray-400":"text-gray-600"),children:"Update lead details and add custom fields"})]})]}),st.jsx("button",{onClick:s,className:"p-2 rounded-lg transition-colors "+("gold"===a?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"),children:st.jsx(ee,{className:"h-5 w-5"})})]})}),st.jsx("div",{className:"p-6 max-h-[80vh] overflow-y-auto",children:st.jsxs("form",{onSubmit:t=>c(this,null,function*(){if(t.preventDefault(),r){p(null),h(!0);try{o.name.trim()||(o.name="Unnamed Lead");const t={name:ht.sanitizeInput(o.name),email:o.email&&""!==o.email.trim()?ht.sanitizeInput(o.email):null,phone:o.phone&&""!==o.phone.trim()?ht.sanitizeInput(o.phone):null,company_name:o.company_name&&""!==o.company_name.trim()?ht.sanitizeInput(o.company_name):null,job_title:o.job_title&&""!==o.job_title.trim()?ht.sanitizeInput(o.job_title):null,source_url:o.source_url&&""!==o.source_url.trim()?ht.sanitizeUrl(o.source_url):null,source_platform:o.source_platform&&""!==o.source_platform.trim()?ht.sanitizeInput(o.source_platform):null},a={};m.forEach(e=>{if(e.key&&""!==e.key.trim()&&e.value&&""!==e.value.trim()){const t=ht.sanitizeInput(e.key),s=ht.sanitizeInput(e.value);t&&s&&(a[t]=s)}});const d=n(i({},t),{custom_fields:a,updated_at:(new Date).toISOString()});Object.keys(d).forEach(e=>{null!==d[e]&&void 0!==d[e]||delete d[e]});const{error:c}=yield at.from("list_leads").update(d).eq("id",e.id).eq("user_id",r.id);if(c)throw c;p({success:!0,message:"Lead updated successfully!"}),setTimeout(()=>{l(),s()},1e3)}catch(a){console.error("Error updating lead:",a),p({success:!1,message:a instanceof Error?a.message:"Failed to update lead. Please try again."})}finally{h(!1)}}}),className:"space-y-6",children:[st.jsxs("div",{className:"space-y-4",children:[st.jsx("h3",{className:"text-lg font-semibold "+("gold"===a?"text-gray-200":"text-gray-900"),children:"Basic Information"}),st.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===a?"text-gray-300":"text-gray-700"),children:"Full Name *"}),st.jsxs("div",{className:"relative",children:[st.jsx(D,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 "+("gold"===a?"text-yellow-400":"text-gray-400")}),st.jsx("input",{type:"text",value:o.name,onChange:e=>d(n(i({},o),{name:e.target.value})),className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===a?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"John Doe",required:!0})]})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===a?"text-gray-300":"text-gray-700"),children:"Email Address"}),st.jsxs("div",{className:"relative",children:[st.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 "+("gold"===a?"text-yellow-400":"text-gray-400")}),st.jsx("input",{type:"email",value:o.email,onChange:e=>d(n(i({},o),{email:e.target.value})),className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===a?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"john@company.com"})]})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===a?"text-gray-300":"text-gray-700"),children:"Phone Number"}),st.jsxs("div",{className:"relative",children:[st.jsx(J,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 "+("gold"===a?"text-yellow-400":"text-gray-400")}),st.jsx("input",{type:"tel",value:o.phone,onChange:e=>d(n(i({},o),{phone:e.target.value})),className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===a?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"+1234567890"})]})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===a?"text-gray-300":"text-gray-700"),children:"Company Name"}),st.jsxs("div",{className:"relative",children:[st.jsx(ye,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 "+("gold"===a?"text-yellow-400":"text-gray-400")}),st.jsx("input",{type:"text",value:o.company_name,onChange:e=>d(n(i({},o),{company_name:e.target.value})),className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===a?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"Acme Corp"})]})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===a?"text-gray-300":"text-gray-700"),children:"Job Title"}),st.jsxs("div",{className:"relative",children:[st.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 "+("gold"===a?"text-yellow-400":"text-gray-400")}),st.jsx("input",{type:"text",value:o.job_title,onChange:e=>d(n(i({},o),{job_title:e.target.value})),className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===a?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"Marketing Director"})]})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===a?"text-gray-300":"text-gray-700"),children:"Source Platform"}),st.jsxs("select",{value:o.source_platform,onChange:e=>d(n(i({},o),{source_platform:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===a?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),children:[st.jsx("option",{value:"",children:"Select source..."}),st.jsx("option",{value:"linkedin",children:"LinkedIn"}),st.jsx("option",{value:"facebook",children:"Facebook"}),st.jsx("option",{value:"twitter",children:"Twitter"}),st.jsx("option",{value:"instagram",children:"Instagram"}),st.jsx("option",{value:"website",children:"Website"}),st.jsx("option",{value:"referral",children:"Referral"}),st.jsx("option",{value:"cold_email",children:"Cold Email"}),st.jsx("option",{value:"manual",children:"Manual Entry"}),st.jsx("option",{value:"other",children:"Other"})]})]})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===a?"text-gray-300":"text-gray-700"),children:"Source URL"}),st.jsx("input",{type:"url",value:o.source_url,onChange:e=>d(n(i({},o),{source_url:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===a?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"https://linkedin.com/in/johndoe"}),st.jsx("p",{className:"text-xs mt-1 text-gray-500",children:"URL where this lead was found (LinkedIn profile, company website, etc.)"})]})]}),st.jsxs("div",{className:"space-y-4",children:[st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsx("h3",{className:"text-lg font-semibold "+("gold"===a?"text-gray-200":"text-gray-900"),children:"Custom Fields"}),st.jsxs("button",{type:"button",onClick:()=>{x([...m,{key:"",value:""}])},className:"inline-flex items-center px-3 py-2 text-sm rounded-lg transition-colors "+("gold"===a?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-50"),children:[st.jsx(H,{className:"h-4 w-4 mr-1"}),"Add Field"]})]}),0===m.length?st.jsxs("div",{className:"text-center py-8 border-2 border-dashed rounded-lg "+("gold"===a?"border-yellow-400/30 text-gray-400":"border-gray-300 text-gray-500"),children:[st.jsx(ze,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),st.jsx("p",{className:"text-sm",children:"No custom fields yet"}),st.jsx("p",{className:"text-xs mt-1",children:"Add custom fields to store additional lead information"})]}):st.jsx("div",{className:"space-y-3",children:m.map((e,t)=>st.jsx("div",{className:"p-4 rounded-lg border "+("gold"===a?"border-yellow-400/20 bg-black/10":"border-gray-200 bg-gray-50"),children:st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-3",children:[st.jsx("input",{type:"text",value:e.key,onChange:e=>b(t,"key",e.target.value.trim()),className:"px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===a?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"Field name"}),st.jsx("input",{type:"text",value:e.value,onChange:e=>b(t,"value",e.target.value),className:"px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===a?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"Field value"})]}),st.jsx("button",{type:"button",onClick:()=>(e=>{x(m.filter((t,s)=>s!==e))})(t),className:"p-2 rounded-lg transition-colors "+("gold"===a?"text-red-400 hover:bg-red-400/10":"text-red-600 hover:bg-red-50"),children:st.jsx(Z,{className:"h-4 w-4"})})]})},t))})]}),y&&st.jsx("div",{className:"rounded-lg border p-4 "+(y.success?"gold"===a?"bg-green-500/10 border-green-500/30 text-green-400":"bg-green-50 border-green-200 text-green-800":"gold"===a?"bg-red-500/10 border-red-500/30 text-red-400":"bg-red-50 border-red-200 text-red-800"),children:st.jsxs("div",{className:"flex items-start",children:[st.jsx("div",{className:"flex-shrink-0",children:y.success?st.jsx($,{className:"h-5 w-5"}):st.jsx(I,{className:"h-5 w-5"})}),st.jsx("div",{className:"ml-3",children:st.jsx("p",{className:"text-sm font-medium",children:y.message})})]})}),st.jsxs("div",{className:"flex space-x-3 pt-4",children:[st.jsx("button",{type:"button",onClick:s,disabled:u,className:`flex-1 px-4 py-2 text-sm rounded-lg transition-colors ${"gold"===a?"text-gray-400 bg-gray-800 border border-gray-600 hover:bg-gray-700":"text-gray-700 bg-gray-200 hover:bg-gray-300"} disabled:opacity-50`,children:"Cancel"}),st.jsx("button",{type:"submit",disabled:u,className:`flex-1 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${"gold"===a?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50`,children:u?st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),"Saving..."]}):st.jsxs(st.Fragment,{children:[st.jsx(oe,{className:"h-4 w-4 mr-2"}),"Save Changes"]})})]})]})})]})})})}function Jt({listId:e,leadCount:t,onClose:s,onSuccess:l}){const{user:r}=nt(),{theme:a}=gt(),[o,i]=g.useState("basic"),[n,d]=g.useState(!1),[m,x]=g.useState(null),[u,h]=g.useState(null),y={basic:{name:"Basic Enrichment",description:"Add missing email addresses and company information",features:["Email discovery","Company details","Job title verification"],costPerLead:.05,estimatedTime:"2-5 minutes"},premium:{name:"Premium Enrichment",description:"Complete profile enrichment with intent signals",features:["Everything in Basic","Phone numbers","Social profiles","Intent scoring","Company technographics"],costPerLead:.15,estimatedTime:"5-10 minutes"}},p=e=>c(this,null,function*(){let t=0;const r=()=>c(this,null,function*(){try{const a=yield fetch(`https://mazirhx.app.n8n.cloud/webhook/enrichment-status/${e}`);if(a.ok){const e=yield a.json();if(x(e),"completed"===e.status)return d(!1),h({success:!0,message:`Enrichment completed! ${e.leads_enriched} leads enriched. Cost: $${e.cost_usd.toFixed(2)}`}),void setTimeout(()=>{l(),s()},2e3);if("failed"===e.status)return d(!1),void h({success:!1,message:`Enrichment failed: ${e.error_message||"Unknown error"}`});t++,t<60?setTimeout(r,1e4):(d(!1),h({success:!1,message:"Enrichment timed out. Please check the status later."}))}}catch(a){console.error("Error polling enrichment status:",a),d(!1)}});r()}),b=t*y[o].costPerLead;return st.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto "+("gold"===a?"bg-black/75":"bg-gray-900/50"),children:st.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:st.jsxs("div",{className:"w-full max-w-2xl rounded-xl shadow-2xl "+("gold"===a?"black-card gold-border":"bg-white border border-gray-200"),children:[st.jsx("div",{className:"p-6 border-b "+("gold"===a?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center "+("gold"===a?"gold-gradient":"bg-blue-100"),children:st.jsx(De,{className:"h-6 w-6 "+("gold"===a?"text-black":"text-blue-600")})}),st.jsxs("div",{children:[st.jsx("h2",{className:"text-xl font-bold "+("gold"===a?"text-gray-200":"text-gray-900"),children:"Enrich Lead List"}),st.jsxs("p",{className:"text-sm "+("gold"===a?"text-gray-400":"text-gray-600"),children:["Add missing contact info and intent signals to ",t," leads"]})]})]}),st.jsx("button",{onClick:s,className:"p-2 rounded-lg transition-colors "+("gold"===a?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"),children:st.jsx(ee,{className:"h-5 w-5"})})]})}),st.jsxs("div",{className:"p-6 space-y-6",children:[st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-3 "+("gold"===a?"text-gray-300":"text-gray-700"),children:"Enrichment Level"}),st.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(y).map(([e,t])=>st.jsxs("button",{onClick:()=>i(e),className:"p-4 rounded-lg border-2 text-left transition-all "+(o===e?"gold"===a?"border-yellow-400 bg-yellow-400/10":"border-blue-500 bg-blue-50":"gold"===a?"border-gray-600 hover:border-gray-500":"border-gray-200 hover:border-gray-300"),children:[st.jsxs("div",{className:"flex items-center justify-between mb-2",children:[st.jsx("h3",{className:"font-semibold "+(o===e?"gold"===a?"text-yellow-400":"text-blue-600":"gold"===a?"text-gray-200":"text-gray-900"),children:t.name}),st.jsxs("span",{className:"text-xs px-2 py-1 rounded-full "+("premium"===e?"gold"===a?"bg-yellow-400/20 text-yellow-400":"bg-blue-100 text-blue-700":"gold"===a?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-600"),children:["$",t.costPerLead,"/lead"]})]}),st.jsx("p",{className:"text-sm mb-3 "+("gold"===a?"text-gray-400":"text-gray-600"),children:t.description}),st.jsx("ul",{className:"text-xs space-y-1 text-gray-500",children:t.features.map((e,t)=>st.jsxs("li",{className:"flex items-center",children:[st.jsx($,{className:"h-3 w-3 mr-2 text-green-500"}),e]},t))})]},e))})]}),st.jsx("div",{className:"p-4 rounded-lg border "+("gold"===a?"border-yellow-400/20 bg-yellow-400/5":"border-blue-200 bg-blue-50"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{children:[st.jsx("div",{className:"text-sm font-medium "+("gold"===a?"text-yellow-400":"text-blue-700"),children:"Enrichment Summary"}),st.jsxs("div",{className:"text-xs "+("gold"===a?"text-yellow-300":"text-blue-600"),children:[t," leads × $",y[o].costPerLead,"/lead"]})]}),st.jsxs("div",{className:"text-right",children:[st.jsxs("div",{className:"text-lg font-bold "+("gold"===a?"text-yellow-400":"text-blue-600"),children:["$",b.toFixed(2)]}),st.jsxs("div",{className:"text-xs text-gray-500",children:["Est. ",y[o].estimatedTime]})]})]})}),m&&n&&st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===a?"border-blue-500/30 bg-blue-500/10":"border-blue-200 bg-blue-50"),children:[st.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[st.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-transparent "+("gold"===a?"border-t-yellow-400":"border-t-blue-600")}),st.jsxs("div",{children:[st.jsx("div",{className:"text-sm font-medium "+("gold"===a?"text-blue-400":"text-blue-700"),children:"Enriching leads..."}),st.jsxs("div",{className:"text-xs "+("gold"===a?"text-blue-300":"text-blue-600"),children:[m.leads_processed||0," of ",t," processed"]})]})]}),st.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 "+("gold"===a?"bg-gray-700":"bg-gray-200"),children:st.jsx("div",{className:"h-2 rounded-full transition-all "+("gold"===a?"gold-gradient":"bg-blue-600"),style:{width:(t>0?(m.leads_processed||0)/t*100:0)+"%"}})})]}),u&&st.jsx("div",{className:"rounded-lg border p-4 "+(u.success?"gold"===a?"bg-green-500/10 border-green-500/30 text-green-400":"bg-green-50 border-green-200 text-green-800":"gold"===a?"bg-red-500/10 border-red-500/30 text-red-400":"bg-red-50 border-red-200 text-red-800"),children:st.jsxs("div",{className:"flex items-start",children:[st.jsx("div",{className:"flex-shrink-0",children:u.success?st.jsx($,{className:"h-5 w-5"}):st.jsx(I,{className:"h-5 w-5"})}),st.jsx("div",{className:"ml-3",children:st.jsx("p",{className:"text-sm font-medium",children:u.message})})]})}),st.jsxs("div",{className:"flex space-x-3",children:[st.jsx("button",{type:"button",onClick:s,disabled:n,className:`flex-1 px-4 py-2 text-sm rounded-lg transition-colors ${"gold"===a?"text-gray-400 bg-gray-800 border border-gray-600 hover:bg-gray-700":"text-gray-700 bg-gray-200 hover:bg-gray-300"} disabled:opacity-50`,children:"Cancel"}),st.jsx("button",{onClick:()=>c(this,null,function*(){if(r){d(!0),h(null);try{const s=yield fetch("https://mazirhx.app.n8n.cloud/webhook/enrich-list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:r.id,list_id:e,enrichment_type:o,lead_count:t,estimated_cost:(t*y[o].costPerLead).toFixed(2)})});if(!s.ok)throw new Error("Failed to start enrichment");{const e=yield s.json();x(e),h({success:!0,message:`Enrichment started! Processing ${t} leads with ${o} enrichment. You'll be notified when complete.`}),p(e.job_id)}}catch(s){h({success:!1,message:s instanceof Error?s.message:"Failed to start enrichment"}),d(!1)}}}),disabled:n||0===t,className:`flex-1 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${"gold"===a?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50`,children:n?st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),"Enriching..."]}):st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx(De,{className:"h-4 w-4 mr-2"}),"Start Enrichment ($",b.toFixed(2),")"]})})]}),st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===a?"bg-green-500/10 border border-green-500/20":"bg-green-50 border border-green-200"),children:[st.jsx("h4",{className:"text-sm font-medium mb-2 "+("gold"===a?"text-green-400":"text-green-700"),children:"🔍 What Gets Enriched"}),st.jsxs("ul",{className:"text-sm space-y-1 "+("gold"===a?"text-green-300":"text-green-600"),children:[st.jsx("li",{children:"• Missing email addresses discovered via multiple sources"}),st.jsx("li",{children:"• Company information and employee count"}),st.jsx("li",{children:"• Job title verification and seniority level"}),"premium"===o&&st.jsxs(st.Fragment,{children:[st.jsx("li",{children:"• Phone numbers from professional directories"}),st.jsx("li",{children:"• Social media profiles (LinkedIn, Twitter)"}),st.jsx("li",{children:"• Intent scoring based on recent activity"}),st.jsx("li",{children:"• Company technology stack and tools used"})]})]})]})]})]})})})}function Yt({listId:e,listName:t,onClose:s,onSuccess:l}){var r;const{user:a}=nt(),{theme:o}=gt(),[d,m]=g.useState(null),[x,u]=g.useState(!1),[h,y]=g.useState(!1),[p,b]=g.useState(null),[f,j]=g.useState(null),[v,w]=g.useState({fixPhoneFormats:!0,removeDuplicatePhones:!0,removeDuplicateEmails:!0,fixEmailFormats:!0,removeEmptyLeads:!0,standardizeNames:!0,cleanCompanyNames:!0}),[N,k]=g.useState(""),[_,S]=g.useState(!1),[E,A]=g.useState(null),[q,D]=g.useState(null),[T,P]=g.useState({name:"",geo:[],industries:[],employee_range:{min:null,max:null},company_revenue_usd:{min:null,max:null},roles_primary:[],roles_secondary:[],exclude_titles_contains:["Intern","Assistant","Recruiter","Student"],intent_signals_any:[],tech_signals_any:[],contact_rules:{require_email:!0,require_personal_phone:!1,company_domain_required:!0},weighting:{firmographic:.35,role:.25,intent:.2,tech:.1,contactability:.1},thresholds:{accept_min:.7,review_min:.5}}),[R,F]=g.useState(!1);g.useEffect(()=>{e&&O()},[e]);const O=()=>c(this,null,function*(){if(a){u(!0);try{const{data:t,error:s}=yield at.from("list_leads").select("*").eq("list_id",e).eq("user_id",a.id);if(s)throw s;const l=U(t||[]);m(l)}catch(t){console.error("Error analyzing list:",t),j({success:!1,message:"Failed to analyze list data"})}finally{u(!1)}}}),U=e=>{const t=new Map,s=new Map,l=[],r=[];let a=0,o=0,i=0,n=0,d=0,c=0;const g=/^\+?[\d\s\-\(\)]{10,}$/,m=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;e.forEach(e=>{if(e.name&&""!==e.name.trim()&&"Unnamed Lead"!==e.name||d++,e.company_name&&""!==e.company_name.trim()||c++,e.phone&&""!==e.phone.trim()){const s=e.phone.replace(/\s/g,"");if(t.has(s)?t.get(s).push(e.id):t.set(s,[e.id]),!g.test(e.phone)){a++;let t=e.phone;/^\d{10}$/.test(s)?t=`+1${s}`:/^1\d{10}$/.test(s)?t=`+${s}`:s.startsWith("+")||(t=`+1${s}`),l.push({id:e.id,name:e.name||"Unknown",phone:e.phone,issue:"Invalid format",suggestedFix:t})}}else i++;if(e.email&&""!==e.email.trim()){const t=e.email.toLowerCase().trim();s.has(t)?s.get(t).push(e.id):s.set(t,[e.id]),m.test(e.email)||(o++,r.push({id:e.id,name:e.name||"Unknown",email:e.email,issue:"Invalid format",suggestedFix:e.email.toLowerCase().trim()}))}else n++});const x=[];return t.forEach((e,t)=>{e.length>1&&x.push({type:"phone",value:t,count:e.length,leadIds:e})}),s.forEach((e,t)=>{e.length>1&&x.push({type:"email",value:t,count:e.length,leadIds:e})}),{totalLeads:e.length,duplicatePhones:x.filter(e=>"phone"===e.type).reduce((e,t)=>e+t.count-1,0),duplicateEmails:x.filter(e=>"email"===e.type).reduce((e,t)=>e+t.count-1,0),invalidPhones:a,invalidEmails:o,missingPhones:i,missingEmails:n,missingNames:d,missingCompanies:c,phoneIssues:l.slice(0,10),emailIssues:r.slice(0,10),duplicateGroups:x.slice(0,10)}},B=()=>{if(!d)return 0;const e=d.duplicatePhones+d.duplicateEmails+d.invalidPhones+d.invalidEmails+d.missingPhones+d.missingEmails,t=6*d.totalLeads,s=Math.max(0,Math.min(100,(t-e)/t*100));return Math.round(s)};return st.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto "+("gold"===o?"bg-black/75":"bg-gray-900/50"),children:st.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:st.jsxs("div",{className:"w-full max-w-4xl rounded-xl shadow-2xl "+("gold"===o?"black-card gold-border":"bg-white border border-gray-200"),children:[st.jsx("div",{className:"p-6 border-b "+("gold"===o?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center "+("gold"===o?"gold-gradient":"bg-blue-100"),children:st.jsx(De,{className:"h-6 w-6 "+("gold"===o?"text-black":"text-blue-600")})}),st.jsxs("div",{children:[st.jsxs("h2",{className:"text-xl font-bold "+("gold"===o?"text-gray-200":"text-gray-900"),children:["Clean List: ",t]}),st.jsx("p",{className:"text-sm "+("gold"===o?"text-gray-400":"text-gray-600"),children:"Analyze and clean your lead data for better campaign performance"})]})]}),st.jsx("button",{onClick:s,className:"p-2 rounded-lg transition-colors "+("gold"===o?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"),children:st.jsx(ee,{className:"h-5 w-5"})})]})}),st.jsxs("div",{className:"p-6 max-h-[80vh] overflow-y-auto space-y-6",children:[x?st.jsxs("div",{className:"text-center py-12",children:[st.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-transparent mx-auto mb-4 "+("gold"===o?"border-t-yellow-400":"border-t-blue-600")}),st.jsx("p",{className:"text-sm "+("gold"===o?"text-gray-400":"text-gray-600"),children:"Analyzing list data quality..."})]}):d?st.jsxs(st.Fragment,{children:[st.jsxs("div",{className:"p-6 rounded-lg border text-center "+("gold"===o?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-gray-50"),children:[st.jsxs("div",{className:"text-4xl font-bold mb-2 "+(H=B(),H>=80?"gold"===o?"text-green-400":"text-green-600":H>=60?"gold"===o?"text-yellow-400":"text-yellow-600":"gold"===o?"text-red-400":"text-red-600"),children:[B(),"%"]}),st.jsx("div",{className:"text-sm font-medium "+("gold"===o?"text-gray-300":"text-gray-700"),children:"Data Quality Score"}),st.jsxs("div",{className:"text-xs mt-1 text-gray-500",children:[d.totalLeads," total leads analyzed"]})]}),st.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===o?"border-red-500/20 bg-red-500/5":"border-red-200 bg-red-50"),children:[st.jsx("div",{className:"text-lg font-bold "+("gold"===o?"text-red-400":"text-red-600"),children:d.duplicatePhones+d.duplicateEmails}),st.jsx("div",{className:"text-sm "+("gold"===o?"text-red-300":"text-red-700"),children:"Duplicates"})]}),st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===o?"border-orange-500/20 bg-orange-500/5":"border-orange-200 bg-orange-50"),children:[st.jsx("div",{className:"text-lg font-bold "+("gold"===o?"text-orange-400":"text-orange-600"),children:d.invalidPhones+d.invalidEmails}),st.jsx("div",{className:"text-sm "+("gold"===o?"text-orange-300":"text-orange-700"),children:"Invalid Formats"})]}),st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===o?"border-yellow-500/20 bg-yellow-500/5":"border-yellow-200 bg-yellow-50"),children:[st.jsx("div",{className:"text-lg font-bold "+("gold"===o?"text-yellow-400":"text-yellow-600"),children:d.missingPhones+d.missingEmails}),st.jsx("div",{className:"text-sm "+("gold"===o?"text-yellow-300":"text-yellow-700"),children:"Missing Contact Info"})]}),st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===o?"border-blue-500/20 bg-blue-500/5":"border-blue-200 bg-blue-50"),children:[st.jsx("div",{className:"text-lg font-bold "+("gold"===o?"text-blue-400":"text-blue-600"),children:d.missingNames+d.missingCompanies}),st.jsx("div",{className:"text-sm "+("gold"===o?"text-blue-300":"text-blue-700"),children:"Missing Info"})]})]}),st.jsxs("div",{className:"p-6 rounded-lg border "+("gold"===o?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-gray-50"),children:[st.jsx("h3",{className:"text-lg font-semibold mb-4 "+("gold"===o?"text-gray-200":"text-gray-900"),children:"Cleaning Options"}),st.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{key:"fixPhoneFormats",label:"Fix Phone Formats",description:`Add country codes and standardize ${d.invalidPhones} phone numbers`,count:d.invalidPhones,icon:J},{key:"removeDuplicatePhones",label:"Remove Duplicate Phones",description:`Remove ${d.duplicatePhones} duplicate phone numbers`,count:d.duplicatePhones,icon:J},{key:"removeDuplicateEmails",label:"Remove Duplicate Emails",description:`Remove ${d.duplicateEmails} duplicate email addresses`,count:d.duplicateEmails,icon:L},{key:"fixEmailFormats",label:"Fix Email Formats",description:`Standardize ${d.invalidEmails} email addresses`,count:d.invalidEmails,icon:L},{key:"removeEmptyLeads",label:"Remove Empty Leads",description:"Remove leads with no phone or email",count:d.missingPhones+d.missingEmails,icon:Z},{key:"standardizeNames",label:"Standardize Names",description:"Fix capitalization and formatting",count:d.missingNames,icon:M}].map(e=>{const t=e.icon,s=v[e.key];return st.jsxs("label",{className:"flex items-start space-x-3 p-4 rounded-lg border cursor-pointer transition-all "+(s?"gold"===o?"border-yellow-400 bg-yellow-400/10":"border-blue-500 bg-blue-50":"gold"===o?"border-gray-600 hover:border-gray-500":"border-gray-200 hover:border-gray-300"),children:[st.jsx("input",{type:"checkbox",checked:s,onChange:t=>w(s=>n(i({},s),{[e.key]:t.target.checked})),className:"mt-1"}),st.jsx(t,{className:"h-5 w-5 mt-0.5 "+("gold"===o?"text-yellow-400":"text-blue-600")}),st.jsxs("div",{className:"flex-1",children:[st.jsxs("div",{className:"text-sm font-medium "+("gold"===o?"text-gray-200":"text-gray-900"),children:[e.label,e.count>0&&st.jsx("span",{className:"ml-2 px-2 py-1 rounded-full text-xs "+("gold"===o?"bg-red-500/20 text-red-400":"bg-red-100 text-red-800"),children:e.count})]}),st.jsx("div",{className:"text-xs "+("gold"===o?"text-gray-400":"text-gray-600"),children:e.description})]})]},e.key)})})]}),st.jsxs("div",{className:"p-6 rounded-lg border "+("gold"===o?"border-purple-500/20 bg-purple-500/5":"border-purple-200 bg-purple-50"),children:[st.jsx("h3",{className:"text-lg font-semibold mb-4 "+("gold"===o?"text-purple-400":"text-purple-700"),children:"🎯 Avatar Verification"}),st.jsx("p",{className:"text-sm mb-4 "+("gold"===o?"text-purple-300":"text-purple-600"),children:"Verify which leads match your ideal client avatar using AI scoring"}),st.jsx("div",{className:"mb-6",children:st.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[st.jsx("button",{onClick:()=>F(!1),className:"px-4 py-2 text-sm rounded-lg transition-colors "+(R?"gold"===o?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-50":"gold"===o?"gold-gradient text-black":"bg-blue-600 text-white"),children:"Simple Description"}),st.jsx("button",{onClick:()=>F(!0),className:"px-4 py-2 text-sm rounded-lg transition-colors "+(R?"gold"===o?"gold-gradient text-black":"bg-blue-600 text-white":"gold"===o?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-50"),children:"Advanced Form"})]})}),st.jsxs("div",{className:"space-y-4",children:[R?st.jsxs("div",{className:"space-y-4",children:[st.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===o?"text-gray-300":"text-gray-700"),children:"Avatar Name *"}),st.jsx("input",{type:"text",value:T.name,onChange:e=>P(t=>n(i({},t),{name:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===o?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"e.g., NYC Growth 50-500"})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===o?"text-gray-300":"text-gray-700"),children:"Geography"}),st.jsx("input",{type:"text",value:T.geo.join(", "),onChange:e=>P(t=>n(i({},t),{geo:e.target.value.split(",").map(e=>e.trim()).filter(Boolean)})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===o?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"e.g., New York City, San Francisco, United States"})]})]}),st.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===o?"text-gray-300":"text-gray-700"),children:"Industries"}),st.jsx("input",{type:"text",value:T.industries.join(", "),onChange:e=>P(t=>n(i({},t),{industries:e.target.value.split(",").map(e=>e.trim()).filter(Boolean)})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===o?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"e.g., Technology, Healthcare, Financial Services"})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===o?"text-gray-300":"text-gray-700"),children:"Employee Range"}),st.jsxs("div",{className:"flex space-x-2",children:[st.jsx("input",{type:"number",value:T.employee_range.min||"",onChange:e=>P(t=>n(i({},t),{employee_range:n(i({},t.employee_range),{min:parseInt(e.target.value)||null})})),className:"flex-1 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===o?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"Min"}),st.jsx("span",{className:"px-2 py-2 "+("gold"===o?"text-gray-400":"text-gray-600"),children:"-"}),st.jsx("input",{type:"number",value:T.employee_range.max||"",onChange:e=>P(t=>n(i({},t),{employee_range:n(i({},t.employee_range),{max:parseInt(e.target.value)||null})})),className:"flex-1 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===o?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"Max"})]})]})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===o?"text-gray-300":"text-gray-700"),children:"Primary Roles *"}),st.jsx("input",{type:"text",value:T.roles_primary.join(", "),onChange:e=>P(t=>n(i({},t),{roles_primary:e.target.value.split(",").map(e=>e.trim()).filter(Boolean)})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===o?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"e.g., Founder, CEO, Owner, President"})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===o?"text-gray-300":"text-gray-700"),children:"Intent Signals"}),st.jsx("input",{type:"text",value:T.intent_signals_any.join(", "),onChange:e=>P(t=>n(i({},t),{intent_signals_any:e.target.value.split(",").map(e=>e.trim()).filter(Boolean)})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===o?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"e.g., Hiring since Aug 2025, Posted jobs recently, Expansion"})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===o?"text-gray-300":"text-gray-700"),children:"Tech Stack Signals"}),st.jsx("input",{type:"text",value:T.tech_signals_any.join(", "),onChange:e=>P(t=>n(i({},t),{tech_signals_any:e.target.value.split(",").map(e=>e.trim()).filter(Boolean)})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===o?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"e.g., HubSpot, Salesforce, Calendly, WordPress"})]}),st.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===o?"text-gray-300":"text-gray-700"),children:"Accept Threshold"}),st.jsx("input",{type:"number",min:"0",max:"1",step:"0.01",value:T.thresholds.accept_min,onChange:e=>P(t=>n(i({},t),{thresholds:n(i({},t.thresholds),{accept_min:parseFloat(e.target.value)||.7})})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===o?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500")})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===o?"text-gray-300":"text-gray-700"),children:"Review Threshold"}),st.jsx("input",{type:"number",min:"0",max:"1",step:"0.01",value:T.thresholds.review_min,onChange:e=>P(t=>n(i({},t),{thresholds:n(i({},t.thresholds),{review_min:parseFloat(e.target.value)||.5})})),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===o?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500")})]})]})]}):st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===o?"text-gray-300":"text-gray-700"),children:"Describe Your Ideal Client Avatar"}),st.jsx("textarea",{value:N,onChange:e=>k(e.target.value),rows:4,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===o?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"Example: US wealth managers, 20-200 employees, must use HubSpot, hiring SDRs, located in major cities, revenue $10M+..."}),st.jsx("p",{className:"text-xs mt-1 text-gray-500",children:"Be specific about industry, company size, tech stack, hiring signals, location, etc."})]}),st.jsx("button",{onClick:()=>c(this,null,function*(){var t,s,l;if(!a)return;let r;if(R){if(!T.name.trim())return void j({success:!1,message:"Avatar name is required"});if(0===T.geo.length&&0===T.industries.length)return void j({success:!1,message:"Please specify either geography or industries"});if(0===T.roles_primary.length)return void j({success:!1,message:"At least one primary role is required"});r=T}else{if(!N.trim())return void j({success:!1,message:"Please provide an avatar description"});r=(e=>{const t=e.toLowerCase(),s=i({},T),l=e.split(".")[0];s.name=l.length>50?l.substring(0,47)+"...":l||"Custom Avatar",["nyc","new york","san francisco","sf","bay area","los angeles","la","chicago","boston","seattle","austin","denver","atlanta","miami","dallas","houston","phoenix","philadelphia","detroit","washington dc","dc","portland","nashville","charlotte","raleigh","tampa","orlando","las vegas","salt lake city","minneapolis","kansas city","columbus","indianapolis","milwaukee","memphis","louisville","richmond","norfolk","jacksonville","birmingham","new orleans","oklahoma city","tulsa","little rock","shreveport","baton rouge","mobile","huntsville","montgomery","tuscaloosa","dothan","florence","gadsden","anniston","opelika","auburn","enterprise","ozark","troy","andalusia","greenville","selma","demopolis","camden","monroeville","brewton","atmore","bay minette","daphne","fairhope","gulf shores","orange beach","foley","robertsdale","spanish fort","tillmans corner","prichard","chickasaw","saraland","satsuma","creola","bayou la batre","grand bay","irvington","theodore","semmes","wilmer","mount vernon","citronelle","jackson","grove hill","thomasville","coffeeville","millry","frisco city","repton","uriah","excel","monroeville","beatrice","peterman","tunnel springs","franklin","georgiana","greenville","fort deposit","luverne","brantley","dozier","rutledge","glenwood","goshen","troy","brundidge","banks","jack","coffee springs","new brockton","daleville","ozark","newton","midland city","pinckard","webb","clopton","ariton","skipperville","clio","louisville","clayton","eufaula","georgetown","morris","seale","pittsview","hurtsboro","union springs","midway","shorter","tuskegee","notasulga","dadeville","camp hill","daviston","jacksons gap","goldville","waverly","opelika","auburn","loachapoka","salem","smiths station","phenix city","ladonia","us","usa","united states","north america","canada","toronto","vancouver","montreal","calgary","ottawa","edmonton","quebec city","winnipeg","hamilton","kitchener","london","victoria","halifax","oshawa","windsor","saskatoon","st. catharines","regina","sherbrooke","kelowna","barrie","abbotsford","sudbury","kingston","saguenay","trois-rivières","guelph","cambridge","whitby","ajax","langley","saanich","terrebonne","milton","st. johns","moncton","thunder bay","dieppe","waterloo","delta","chatham-kent","red deer","kamloops","brantford","cape breton","lethbridge","saint-jean-sur-richelieu","clarington","pickering","nanaimo","sudbury","north vancouver","maple ridge","new westminster","saint john","coquitlam","richmond hill","hull","oakville","burlington","greater sudbury","lévis","barrie","moncton","saint-jérôme","granby"].forEach(e=>{if(t.includes(e)){const t=e.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");s.geo.includes(t)||s.geo.push(t)}}),Object.entries({technology:["tech","software","saas","ai","fintech","edtech","proptech","martech"],healthcare:["healthcare","medical","pharma","biotech","health"],"financial services":["finance","banking","investment","insurance","wealth"],"professional services":["consulting","legal","accounting","advisory"],manufacturing:["manufacturing","industrial","automotive"],retail:["retail","e-commerce","ecommerce","consumer"],"real estate":["real estate","property","construction"],education:["education","university","school","training"]}).forEach(([e,l])=>{l.some(e=>t.includes(e))&&s.industries.push(e.charAt(0).toUpperCase()+e.slice(1))});const r=t.match(/(\d+)[-–](\d+)\s*employees?/);r?(s.employee_range.min=parseInt(r[1]),s.employee_range.max=parseInt(r[2])):t.includes("startup")||t.includes("small")?s.employee_range={min:1,max:50}:t.includes("medium")||t.includes("mid-size")?s.employee_range={min:51,max:200}:(t.includes("large")||t.includes("enterprise"))&&(s.employee_range={min:201,max:null});const a=t.match(/\$(\d+)([mk]?)\+?\s*revenue/);if(a){let e=parseInt(a[1]);const t=a[2];"m"===t&&(e*=1e6),"k"===t&&(e*=1e3),s.company_revenue_usd.min=e}const o={primary:["founder","ceo","owner","president","managing director","managing partner"],secondary:["vp","vice president","head","director","c-suite","cto","cfo","cmo","coo"]};return o.primary.forEach(e=>{if(t.includes(e)){const t=e.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");s.roles_primary.includes(t)||s.roles_primary.push(t)}}),o.secondary.forEach(e=>{if(t.includes(e)){const t=e.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");s.roles_secondary.includes(t)||s.roles_secondary.push(t)}}),(t.includes("hiring")||t.includes("recruiting"))&&s.intent_signals_any.push("Hiring since Aug 2025"),(t.includes("growth")||t.includes("expanding"))&&s.intent_signals_any.push("Expansion"),(t.includes("funding")||t.includes("raised"))&&s.intent_signals_any.push("Recent funding"),["hubspot","salesforce","calendly","wordpress","shopify","stripe","slack","zoom","microsoft","google workspace"].forEach(e=>{if(t.includes(e)){const t=e.charAt(0).toUpperCase()+e.slice(1);s.tech_signals_any.includes(t)||s.tech_signals_any.push(t)}}),s})(N)}S(!0),j(null);try{const{data:o,error:i}=yield at.from("list_leads").select("*").eq("list_id",e).eq("user_id",a.id);if(i)throw i;if(!o||0===o.length)throw new Error("No leads found in this list");const n=`batch_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,d=r.name.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase()||`avatar_${Date.now()}`,{data:c,error:g}=yield at.from("cleaning_sessions").insert({owner_id:a.id,avatar_spec:r,avatar_id:d,batch_id:n,batch_size:500,lead_count:o.length,status:"queued"}).select().single();if(g)throw g;D(c);const m=o.map(e=>{var t,s,l;return{id:e.id,emails:e.email?[e.email.toLowerCase().trim()].filter(e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)):[],phones:e.phone?[e.phone.replace(/[^\d+]/g,"")].filter(e=>e.length>=10):[],full_name:e.name||"",first_name:e.name?e.name.split(" ")[0]:"",last_name:e.name?e.name.split(" ").slice(1).join(" "):"",title:e.job_title||"",company:e.company_name||"",company_domain:e.source_url?(()=>{try{return new URL(e.source_url).hostname.toLowerCase()}catch(t){return""}})():"",linkedin_url:e.source_url||"",source_slug:e.source_platform||"manual",country:(null==(t=e.custom_fields)?void 0:t.country)||"",state:(null==(s=e.custom_fields)?void 0:s.state)||"",city:(null==(l=e.custom_fields)?void 0:l.city)||"",site_signals:[],social_signals:[],tech_stack:[]}}).filter(e=>e.id);yield at.from("cleaning_sessions").update({status:"running",started_at:(new Date).toISOString()}).eq("id",c.id);const x={avatar:r,avatar_id:d,batch_id:n,batch_size:500,leads:m},u=yield fetch("https://mazirhx.app.n8n.cloud/webhook/verify-discovered",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)});if(!u.ok){const e=yield u.text();throw new Error(`Webhook failed: ${u.status} - ${e}`)}const h=yield u.json();yield at.from("cleaning_sessions").update({status:"completed",completed_at:(new Date).toISOString(),summary:h}).eq("id",c.id),A({success:!0,message:`Avatar verification completed! ${(null==(t=h.summary)?void 0:t.accept_count)||0} ACCEPT, ${(null==(s=h.summary)?void 0:s.review_count)||0} REVIEW, ${(null==(l=h.summary)?void 0:l.reject_count)||0} REJECT.`,summary:h}),console.log(JSON.stringify({ok:!0,batch_id:n,session_id:c.id,summary:h.summary}))}catch(o){console.error("Error during avatar verification:",o),(null==q?void 0:q.id)&&(yield at.from("cleaning_sessions").update({status:"failed",completed_at:(new Date).toISOString(),summary:{error:o instanceof Error?o.message:"Unknown error"}}).eq("id",q.id)),A({success:!1,message:`Avatar verification failed: ${o instanceof Error?o.message:"Unknown error"}`,summary:{error:o instanceof Error?o.message:"Unknown error"}}),console.log(JSON.stringify({ok:!1,error:o instanceof Error?o.message:"Unknown error"}))}finally{S(!1)}}),disabled:_||!R&&!N.trim()||R&&!T.name.trim(),className:"w-full px-4 py-3 text-sm font-medium rounded-lg transition-colors bg-purple-600 text-white hover:bg-purple-700 disabled:opacity-50",children:_?st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Verifying Avatar Match..."]}):st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx(z,{className:"h-4 w-4 mr-2"}),"Verify Avatar Match (",(null==d?void 0:d.totalLeads)||0," leads)"]})})]})]}),E&&st.jsx("div",{className:"p-4 rounded-lg border "+(E.success?"gold"===o?"bg-green-500/10 border-green-500/30 text-green-400":"bg-green-50 border-green-200 text-green-800":"gold"===o?"bg-red-500/10 border-red-500/30 text-red-400":"bg-red-50 border-red-200 text-red-800"),children:st.jsxs("div",{className:"flex items-start",children:[st.jsx("div",{className:"flex-shrink-0",children:E.success?st.jsx($,{className:"h-5 w-5"}):st.jsx(I,{className:"h-5 w-5"})}),st.jsxs("div",{className:"ml-3",children:[st.jsx("p",{className:"text-sm font-medium",children:E.message}),E.summary&&st.jsxs("div",{className:"text-xs mt-2 space-y-1",children:[st.jsxs("div",{children:["ACCEPT: ",E.summary.accept_count||0]}),st.jsxs("div",{children:["REVIEW: ",E.summary.review_count||0]}),st.jsxs("div",{children:["REJECT: ",E.summary.reject_count||0]}),st.jsxs("div",{children:["Average Score: ",(null==(r=E.summary.average_score)?void 0:r.toFixed(2))||"N/A"]})]})]})]})}),(d.phoneIssues.length>0||d.emailIssues.length>0||d.duplicateGroups.length>0)&&st.jsxs("div",{className:"p-6 rounded-lg border "+("gold"===o?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-gray-50"),children:[st.jsx("h4",{className:"text-md font-semibold mb-4 "+("gold"===o?"text-gray-200":"text-gray-900"),children:"Sample Issues Found"}),d.phoneIssues.length>0&&st.jsxs("div",{className:"mb-4",children:[st.jsx("h5",{className:"text-sm font-medium mb-2 "+("gold"===o?"text-gray-300":"text-gray-700"),children:"Phone Format Issues (showing first 5)"}),st.jsx("div",{className:"space-y-2",children:d.phoneIssues.slice(0,5).map((e,t)=>st.jsx("div",{className:"p-3 rounded-lg "+("gold"===o?"bg-black/30":"bg-white"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{children:[st.jsx("div",{className:"text-sm font-medium "+("gold"===o?"text-gray-200":"text-gray-900"),children:e.name}),st.jsxs("div",{className:"text-xs "+("gold"===o?"text-red-400":"text-red-600"),children:["Current: ",e.phone]})]}),st.jsxs("div",{className:"text-right",children:[st.jsx("div",{className:"text-xs "+("gold"===o?"text-gray-400":"text-gray-600"),children:"Will fix to:"}),st.jsx("div",{className:"text-sm font-medium "+("gold"===o?"text-green-400":"text-green-600"),children:e.suggestedFix})]})]})},t))})]}),d.duplicateGroups.length>0&&st.jsxs("div",{className:"mb-4",children:[st.jsx("h5",{className:"text-sm font-medium mb-2 "+("gold"===o?"text-gray-300":"text-gray-700"),children:"Duplicate Groups (showing first 5)"}),st.jsx("div",{className:"space-y-2",children:d.duplicateGroups.slice(0,5).map((e,t)=>st.jsx("div",{className:"p-3 rounded-lg "+("gold"===o?"bg-black/30":"bg-white"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{children:[st.jsxs("div",{className:"text-sm font-medium "+("gold"===o?"text-gray-200":"text-gray-900"),children:["phone"===e.type?"📞":"📧"," ",e.value]}),st.jsxs("div",{className:"text-xs "+("gold"===o?"text-gray-400":"text-gray-600"),children:["Found in ",e.count," leads"]})]}),st.jsxs("div",{className:"text-xs px-2 py-1 rounded-full "+("gold"===o?"bg-red-500/20 text-red-400":"bg-red-100 text-red-800"),children:["Will keep 1, remove ",e.count-1]})]})},t))})]})]}),h&&p&&st.jsxs("div",{className:"p-6 rounded-lg border "+("gold"===o?"border-blue-500/30 bg-blue-500/10":"border-blue-200 bg-blue-50"),children:[st.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[st.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-transparent "+("gold"===o?"border-t-yellow-400":"border-t-blue-600")}),st.jsxs("div",{children:[st.jsx("div",{className:"text-sm font-medium "+("gold"===o?"text-blue-400":"text-blue-700"),children:p.step}),st.jsx("div",{className:"text-xs "+("gold"===o?"text-blue-300":"text-blue-600"),children:p.currentAction})]})]}),st.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 "+("gold"===o?"bg-gray-700":"bg-gray-200"),children:st.jsx("div",{className:"h-2 rounded-full transition-all "+("gold"===o?"gold-gradient":"bg-blue-600"),style:{width:(p.total>0?p.completed/p.total*100:0)+"%"}})}),st.jsxs("div",{className:"text-xs mt-2 text-center "+("gold"===o?"text-gray-400":"text-gray-600"),children:[p.completed," of ",p.total," operations completed"]})]}),f&&st.jsx("div",{className:"rounded-lg border p-4 "+(f.success?"gold"===o?"bg-green-500/10 border-green-500/30 text-green-400":"bg-green-50 border-green-200 text-green-800":"gold"===o?"bg-red-500/10 border-red-500/30 text-red-400":"bg-red-50 border-red-200 text-red-800"),children:st.jsxs("div",{className:"flex items-start",children:[st.jsx("div",{className:"flex-shrink-0",children:f.success?st.jsx($,{className:"h-5 w-5"}):st.jsx(I,{className:"h-5 w-5"})}),st.jsxs("div",{className:"ml-3",children:[st.jsx("p",{className:"text-sm font-medium",children:f.message}),f.details&&st.jsxs("div",{className:"text-xs mt-1",children:["Phone numbers fixed: ",f.details.phoneFixed," | Duplicates removed: ",f.details.duplicatesRemoved," | Emails fixed: ",f.details.emailsFixed]})]})]})}),st.jsxs("div",{className:"flex space-x-3",children:[st.jsx("button",{type:"button",onClick:s,disabled:h,className:`flex-1 px-4 py-2 text-sm rounded-lg transition-colors ${"gold"===o?"text-gray-400 bg-gray-800 border border-gray-600 hover:bg-gray-700":"text-gray-700 bg-gray-200 hover:bg-gray-300"} disabled:opacity-50`,children:(null==f?void 0:f.success)?"Close":"Cancel"}),st.jsxs("button",{onClick:O,disabled:x||h,className:`px-4 py-2 text-sm font-medium rounded-lg border transition-colors ${"gold"===o?"border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border-gray-300 text-gray-700 hover:bg-gray-50"} disabled:opacity-50`,children:[st.jsx(C,{className:"h-4 w-4 mr-2"}),"Re-analyze"]}),!(null==f?void 0:f.success)&&st.jsx("button",{onClick:()=>c(this,null,function*(){if(a&&d){y(!0),j(null);try{let t=0,s=0;if(v.fixPhoneFormats&&(t+=d.phoneIssues.length),v.removeDuplicatePhones&&(t+=d.duplicateGroups.filter(e=>"phone"===e.type).length),v.removeDuplicateEmails&&(t+=d.duplicateGroups.filter(e=>"email"===e.type).length),v.fixEmailFormats&&(t+=d.emailIssues.length),v.removeEmptyLeads&&(t+=d.missingPhones+d.missingEmails),v.fixPhoneFormats){b({step:"Fixing phone formats",completed:s,total:t,currentAction:"Standardizing phone numbers..."});for(const e of d.phoneIssues)yield at.from("list_leads").update({phone:e.suggestedFix}).eq("id",e.id).eq("user_id",a.id),s++,b(e=>e?n(i({},e),{completed:s}):null)}if(v.removeDuplicatePhones){b({step:"Removing duplicate phones",completed:s,total:t,currentAction:"Removing duplicate phone numbers..."});for(const e of d.duplicateGroups.filter(e=>"phone"===e.type)){const t=e.leadIds.slice(1);t.length>0&&(yield at.from("list_leads").delete().in("id",t).eq("user_id",a.id)),s++,b(e=>e?n(i({},e),{completed:s}):null)}}if(v.removeDuplicateEmails){b({step:"Removing duplicate emails",completed:s,total:t,currentAction:"Removing duplicate email addresses..."});for(const e of d.duplicateGroups.filter(e=>"email"===e.type)){const t=e.leadIds.slice(1);t.length>0&&(yield at.from("list_leads").delete().in("id",t).eq("user_id",a.id)),s++,b(e=>e?n(i({},e),{completed:s}):null)}}if(v.fixEmailFormats){b({step:"Fixing email formats",completed:s,total:t,currentAction:"Standardizing email addresses..."});for(const e of d.emailIssues)yield at.from("list_leads").update({email:e.suggestedFix}).eq("id",e.id).eq("user_id",a.id),s++,b(e=>e?n(i({},e),{completed:s}):null)}if(v.removeEmptyLeads&&(b({step:"Removing empty leads",completed:s,total:t,currentAction:"Removing leads with no contact information..."}),yield at.from("list_leads").delete().eq("list_id",e).eq("user_id",a.id).or("phone.is.null,phone.eq.").or("email.is.null,email.eq."),s=t,b(e=>e?n(i({},e),{completed:s}):null)),v.standardizeNames){b({step:"Standardizing names",completed:s,total:t,currentAction:"Standardizing name formats..."});const{data:l}=yield at.from("list_leads").select("id, name").eq("list_id",e).eq("user_id",a.id).or("name.is.null,name.eq.,name.eq.Unnamed Lead");if(l)for(const e of l){const t=e.name?e.name.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "):"Unknown Lead";yield at.from("list_leads").update({name:t}).eq("id",e.id)}}j({success:!0,message:`List cleaned successfully! Processed ${t} operations.`,details:{phoneFixed:v.fixPhoneFormats?d.phoneIssues.length:0,duplicatesRemoved:(v.removeDuplicatePhones?d.duplicatePhones:0)+(v.removeDuplicateEmails?d.duplicateEmails:0),emailsFixed:v.fixEmailFormats?d.emailIssues.length:0}}),setTimeout(()=>{O()},1e3)}catch(t){console.error("Error cleaning list:",t),j({success:!1,message:t instanceof Error?t.message:"List cleaning failed"})}finally{y(!1),b(null)}}}),disabled:h||Object.values(v).every(e=>!e),className:`flex-1 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${"gold"===o?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50`,children:h?st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),"Cleaning..."]}):st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx(De,{className:"h-4 w-4 mr-2"}),"Clean List"]})})]})]}):st.jsxs("div",{className:"text-center py-12",children:[st.jsx(I,{className:"h-12 w-12 mx-auto mb-4 "+("gold"===o?"text-red-400":"text-red-600")}),st.jsx("p",{className:"text-sm "+("gold"===o?"text-gray-400":"text-gray-600"),children:"Failed to analyze list data"}),st.jsxs("button",{onClick:O,className:"mt-4 inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors "+("gold"===o?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[st.jsx(C,{className:"h-4 w-4 mr-2"}),"Try Again"]})]}),st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===o?"bg-green-500/10 border border-green-500/20":"bg-green-50 border border-green-200"),children:[st.jsx("h4",{className:"text-sm font-medium mb-2 "+("gold"===o?"text-green-400":"text-green-700"),children:"✨ Benefits of List Cleaning"}),st.jsxs("ul",{className:"text-sm space-y-1 "+("gold"===o?"text-green-300":"text-green-600"),children:[st.jsx("li",{children:"• Higher deliverability rates with properly formatted contact info"}),st.jsx("li",{children:"• Avoid contacting the same person multiple times"}),st.jsx("li",{children:"• Better campaign performance with clean, organized data"}),st.jsx("li",{children:"• Reduced bounce rates and improved sender reputation"}),st.jsx("li",{children:"• More accurate analytics and reporting"})]})]})]})]})})});var H}function Kt({listId:e,selectedLeadIds:t,onClose:s,onSuccess:l}){var r;const{user:a}=nt(),{theme:o}=gt(),[i,n]=g.useState([]),[d,m]=g.useState(""),[x,u]=g.useState("skip"),[h,y]=g.useState(!1),[p,b]=g.useState(null),[f,j]=g.useState(null),[v,w]=g.useState([]);g.useEffect(()=>{a&&(N(),k())},[a,e,t]);const N=()=>c(this,null,function*(){if(a)try{const{data:e,error:t}=yield at.from("campaigns").select("id, offer, status, created_at").eq("user_id",a.id).order("created_at",{ascending:!1});if(t)throw t;n(e||[])}catch(e){console.error("Error fetching campaigns:",e)}}),k=()=>c(this,null,function*(){if(a)try{let s=at.from("list_leads").select("*").eq("list_id",e).eq("user_id",a.id);t.length>0&&(s=s.in("id",t));const{data:l,error:r}=yield s;if(r)throw r;w(l||[])}catch(s){console.error("Error fetching leads to import:",s)}});return st.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto "+("gold"===o?"bg-black/75":"bg-gray-900/50"),children:st.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:st.jsxs("div",{className:"w-full max-w-2xl rounded-xl shadow-2xl "+("gold"===o?"black-card gold-border":"bg-white border border-gray-200"),children:[st.jsx("div",{className:"p-6 border-b "+("gold"===o?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center "+("gold"===o?"gold-gradient":"bg-blue-100"),children:st.jsx(fe,{className:"h-6 w-6 "+("gold"===o?"text-black":"text-blue-600")})}),st.jsxs("div",{children:[st.jsx("h2",{className:"text-xl font-bold "+("gold"===o?"text-gray-200":"text-gray-900"),children:"Export to Campaign"}),st.jsxs("p",{className:"text-sm "+("gold"===o?"text-gray-400":"text-gray-600"),children:["Send ",t.length>0?t.length:v.length," leads to a campaign"]})]})]}),st.jsx("button",{onClick:s,className:"p-2 rounded-lg transition-colors "+("gold"===o?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"),children:st.jsx(ee,{className:"h-5 w-5"})})]})}),st.jsxs("div",{className:"p-6 space-y-6",children:[st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===o?"text-gray-300":"text-gray-700"),children:"Select Campaign *"}),st.jsxs("select",{value:d,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===o?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),required:!0,children:[st.jsx("option",{value:"",children:"Choose a campaign..."}),i.map(e=>st.jsxs("option",{value:e.id,children:[e.offer||"Untitled Campaign"," (",e.status||"draft",")"]},e.id))]})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===o?"text-gray-300":"text-gray-700"),children:"Handle Duplicates"}),st.jsx("div",{className:"space-y-2",children:[{value:"skip",label:"Skip duplicates",desc:"Don't import leads that already exist in the campaign"},{value:"update",label:"Update existing",desc:"Update existing leads with new information"},{value:"create_new",label:"Create new entries",desc:"Import all leads, even if duplicates exist"}].map(e=>st.jsxs("label",{className:"flex items-start space-x-3 p-3 rounded-lg border cursor-pointer transition-colors "+(x===e.value?"gold"===o?"border-yellow-400 bg-yellow-400/10":"border-blue-500 bg-blue-50":"gold"===o?"border-gray-600 hover:border-gray-500":"border-gray-200 hover:border-gray-300"),children:[st.jsx("input",{type:"radio",name:"duplicateHandling",value:e.value,checked:x===e.value,onChange:e=>u(e.target.value),className:"mt-1"}),st.jsxs("div",{children:[st.jsx("div",{className:"text-sm font-medium "+("gold"===o?"text-gray-200":"text-gray-900"),children:e.label}),st.jsx("div",{className:"text-xs "+("gold"===o?"text-gray-400":"text-gray-600"),children:e.desc})]})]},e.value))})]}),st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===o?"border-yellow-400/20 bg-yellow-400/5":"border-blue-200 bg-blue-50"),children:[st.jsx("h4",{className:"text-sm font-medium mb-2 "+("gold"===o?"text-yellow-400":"text-blue-700"),children:"Import Preview"}),st.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[st.jsx(M,{className:"h-4 w-4 "+("gold"===o?"text-yellow-400":"text-blue-600")}),st.jsxs("span",{className:"gold"===o?"text-yellow-300":"text-blue-600",children:[v.length," leads will be imported"]}),st.jsx(te,{className:"h-4 w-4 "+("gold"===o?"text-yellow-400":"text-blue-600")}),st.jsx(z,{className:"h-4 w-4 "+("gold"===o?"text-yellow-400":"text-blue-600")}),st.jsx("span",{className:"gold"===o?"text-yellow-300":"text-blue-600",children:(null==(r=i.find(e=>e.id===d))?void 0:r.offer)||"Selected campaign"})]})]}),f&&st.jsx("div",{className:"rounded-lg border p-4 "+(f.success?"gold"===o?"bg-green-500/10 border-green-500/30 text-green-400":"bg-green-50 border-green-200 text-green-800":"gold"===o?"bg-red-500/10 border-red-500/30 text-red-400":"bg-red-50 border-red-200 text-red-800"),children:st.jsxs("div",{className:"flex items-start",children:[st.jsx("div",{className:"flex-shrink-0",children:f.success?st.jsx($,{className:"h-5 w-5"}):st.jsx(I,{className:"h-5 w-5"})}),st.jsxs("div",{className:"ml-3",children:[st.jsx("p",{className:"text-sm font-medium",children:f.message}),p&&st.jsxs("div",{className:"text-xs mt-1",children:["Imported: ",p.leads_imported," | Skipped: ",p.leads_skipped]})]})]})}),st.jsxs("div",{className:"flex space-x-3",children:[st.jsx("button",{type:"button",onClick:s,disabled:h,className:`flex-1 px-4 py-2 text-sm rounded-lg transition-colors ${"gold"===o?"text-gray-400 bg-gray-800 border border-gray-600 hover:bg-gray-700":"text-gray-700 bg-gray-200 hover:bg-gray-300"} disabled:opacity-50`,children:"Cancel"}),st.jsx("button",{onClick:()=>c(this,null,function*(){if(d&&a){y(!0),j(null);try{const{data:r,error:o}=yield at.from("lead_import_jobs").insert([{user_id:a.id,source_list_id:e,target_campaign_id:d,leads_selected:v.length,duplicate_handling:x,status:"processing"}]).select().single();if(o)throw o;b(r);let i=0,n=0;const c=[];for(const e of v)try{const t={campaign_id:d,user_id:a.id,name:e.name,phone:e.phone&&""!==e.phone?e.phone:"",email:e.email,company_name:e.company_name,job_title:e.job_title,source_url:e.source_url,source_platform:e.source_platform||"list_import",status:"pending"};if("skip"===x){const{data:t,error:s}=yield at.from("uploaded_leads").select("id").eq("campaign_id",d).eq("user_id",a.id).or(`phone.eq.${e.phone||"null"},email.eq.${e.email||"null"}`).limit(1);if(s&&console.warn("Error checking duplicates:",s),t&&t.length>0){n++;continue}}const{error:s}=yield at.from("uploaded_leads").insert([t]);s?"skip"===x&&"23505"===s.code?n++:(console.error("Insert error for lead:",e.name,s),c.push(`${e.name}: ${s.message}`)):i++}catch(t){console.error("Error importing lead:",t),c.push(`Failed to import ${e.name}: ${t instanceof Error?t.message:"Unknown error"}`)}yield at.from("lead_import_jobs").update({leads_imported:i,leads_skipped:n,status:c.length>0?"completed_with_errors":"completed",error_message:c.length>0?c.join("; "):null,completed_at:(new Date).toISOString()}).eq("id",r.id),j({success:!0,message:`Successfully imported ${i} leads to campaign. ${n>0?`${n} duplicates skipped.`:""}`}),setTimeout(()=>{l(),s()},2e3)}catch(t){console.error("Error during import:",t),j({success:!1,message:t instanceof Error?t.message:"Import failed"}),p&&(yield at.from("lead_import_jobs").update({status:"failed",error_message:t instanceof Error?t.message:"Unknown error",completed_at:(new Date).toISOString()}).eq("id",p.id))}finally{y(!1)}}}),disabled:h||!d||0===v.length,className:`flex-1 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${"gold"===o?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50`,children:h?st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),"Importing..."]}):st.jsxs("div",{className:"flex items-center justify-center",children:[st.jsx(fe,{className:"h-4 w-4 mr-2"}),"Import ",v.length," Leads"]})})]}),st.jsxs("div",{className:"p-3 rounded-lg "+("gold"===o?"bg-gray-500/10 border border-gray-500/20":"bg-gray-50 border border-gray-200"),children:[st.jsx("h5",{className:"text-xs font-medium mb-1 "+("gold"===o?"text-gray-400":"text-gray-600"),children:"Import Guidelines:"}),st.jsxs("ul",{className:"text-xs space-y-1 text-gray-500",children:[st.jsx("li",{children:"• Leads will be added to the selected campaign for outreach"}),st.jsx("li",{children:"• Source information and intent scores are preserved"}),st.jsx("li",{children:"• Duplicate detection is based on phone number"}),st.jsx("li",{children:"• Import history is tracked for audit purposes"})]})]})]})]})})})}function Xt({intentRunId:e,onAddToList:t}){const{user:s}=nt(),{theme:l}=gt(),[r,a]=g.useState([]),[o,i]=g.useState([]),[n,d]=g.useState(e||""),[m,x]=g.useState(!0),[u,h]=g.useState(""),[y,p]=g.useState(""),[b,f]=g.useState([]),[j,v]=g.useState("intent_score"),[w,N]=g.useState("desc"),[k,_]=g.useState("all"),[C,I]=g.useState(null);g.useEffect(()=>{s&&q()},[s]),g.useEffect(()=>{n&&D()},[n,j,w]);const q=()=>c(this,null,function*(){if(s)try{const{data:t,error:l}=yield at.from("intent_runs").select("*").eq("user_id",s.id).order("created_at",{ascending:!1});if(l)throw l;i(t||[]),!e&&t&&t.length>0&&d(t[0].id)}catch(t){console.error("Error fetching intent runs:",t),h("Failed to load discovery runs")}}),D=()=>c(this,null,function*(){if(n&&s)try{x(!0);let e=at.from("discovered_leads").select("*").eq("intent_run_id",n).eq("user_id",s.id);e=e.order(j,{ascending:"asc"===w});const{data:t,error:l}=yield e;if(l)throw l;a(t||[])}catch(e){console.error("Error fetching discovered leads:",e),h("Failed to load discovered leads")}finally{x(!1)}}),T=r.filter(e=>{var t,s,l,r;const a=!y||(null==(t=e.full_name)?void 0:t.toLowerCase().includes(y.toLowerCase()))||(null==(s=e.email)?void 0:s.toLowerCase().includes(y.toLowerCase()))||(null==(l=e.company)?void 0:l.toLowerCase().includes(y.toLowerCase()))||(null==(r=e.title)?void 0:r.toLowerCase().includes(y.toLowerCase()));let o=!0;switch(k){case"high_intent":o=e.intent_score>=.7;break;case"has_email":o=!!e.email;break;case"has_phone":o=!!e.phone;break;default:o=!0}return a&&o}),P=()=>c(this,null,function*(){if(!s)return;const e=b.length>0?b:T.map(e=>e.id);if(0!==e.length)try{const l=r.filter(t=>e.includes(t.id)),a=o.find(e=>e.id===n),i=`Discovery: ${(null==a?void 0:a.goal.substring(0,50))||"AI Discovery"}${(null==a?void 0:a.goal)&&a.goal.length>50?"...":""}`,d=`${e.length} high-intent leads from discovery run on ${(new Date).toLocaleDateString()}. Goal: ${(null==a?void 0:a.goal)||"Unknown goal"}`,{data:c,error:g}=yield at.from("lists").insert([{user_id:s.id,name:i,description:d,tags:["discovery","auto-generated","high-intent"]}]).select().single();if(g)throw g;const m=l.map(e=>({list_id:c.id,user_id:s.id,name:e.full_name||`${e.first_name||""} ${e.last_name||""}`.trim()||"Unknown Lead",email:e.email,phone:e.phone,company_name:e.company,job_title:e.title,source_url:e.linkedin_url,source_platform:e.source_slug||"discovery",custom_fields:{intent_score:e.intent_score,tags:e.tags||[],reasons:e.reasons||[],country:e.country,state:e.state,city:e.city,company_domain:e.company_domain,discovery_run_id:e.intent_run_id}})),x=50;for(let e=0;e<m.length;e+=x){const t=m.slice(e,e+x),{error:s}=yield at.from("list_leads").upsert(t,{onConflict:"list_id,email",ignoreDuplicates:!0});if(s)throw console.error("Error inserting batch:",s),new Error(`Failed to insert batch ${Math.floor(e/x)+1}: ${s.message}`)}I({success:!0,message:`Successfully created list "${i}" with ${e.length} leads!`}),f([]),t&&t(l)}catch(l){console.error("Error creating list from selected leads:",l),I({success:!1,message:`Failed to create list: ${l instanceof Error?l.message:"Unknown error"}`})}}),R=e=>e>=.8?"gold"===l?"text-green-400":"text-green-600":e>=.6?"gold"===l?"text-yellow-400":"text-yellow-600":e>=.4?"gold"===l?"text-orange-400":"text-orange-600":"gold"===l?"text-red-400":"text-red-600",F=o.find(e=>e.id===n);return m&&0===r.length?st.jsx(bt,{size:"lg",message:"Loading discovered leads...",className:"h-64"}):st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{children:[st.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:["gold"===l?st.jsx(E,{className:"h-8 w-8 text-yellow-400"}):st.jsx(z,{className:"h-8 w-8 text-blue-600"}),st.jsx("h2",{className:"text-2xl font-bold "+("gold"===l?"gold-text-gradient":"text-gray-900"),children:"Discovered Leads"})]}),st.jsx("p",{className:"gold"===l?"text-gray-400":"text-gray-600",children:"High-intent prospects found by AI discovery"})]}),b.length>0&&t&&st.jsxs("button",{onClick:P,className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors "+("gold"===l?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[st.jsx(H,{className:"h-4 w-4 mr-2"}),"Create New List (",b.length,")"]})]}),(u||C)&&st.jsx("div",{className:"rounded-lg border p-4 "+((null==C?void 0:C.success)||!u?"gold"===l?"bg-green-500/10 border-green-500/30 text-green-400":"bg-green-50 border-green-200 text-green-800":"gold"===l?"bg-red-500/10 border-red-500/30 text-red-400":"bg-red-50 border-red-200 text-red-800"),children:st.jsxs("div",{className:"flex items-start",children:[st.jsx("div",{className:"flex-shrink-0",children:(null==C?void 0:C.success)||!u?st.jsx($,{className:"h-5 w-5"}):st.jsx(S,{className:"h-5 w-5"})}),st.jsx("div",{className:"ml-3",children:st.jsx("p",{className:"text-sm font-medium",children:(null==C?void 0:C.message)||u})}),st.jsx("button",{onClick:()=>{h(""),I(null)},className:"ml-auto text-current hover:opacity-70",children:"×"})]})}),st.jsx("div",{className:"p-4 rounded-lg border "+("gold"===l?"border-yellow-400/20 bg-black/10":"border-gray-200 bg-gray-50"),children:st.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[st.jsxs("div",{className:"flex-1",children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===l?"text-gray-300":"text-gray-700"),children:"Discovery Run"}),st.jsxs("select",{value:n,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),children:[st.jsx("option",{value:"",children:"Select a discovery run..."}),o.map(e=>st.jsxs("option",{value:e.id,children:[e.goal.substring(0,60),"... (",e.leads_found," leads, $",e.cost_usd.toFixed(2),")"]},e.id))]})]}),F&&st.jsxs("div",{className:"p-3 rounded-lg "+("gold"===l?"bg-yellow-400/10":"bg-blue-50"),children:[st.jsx("div",{className:"text-sm font-medium "+("gold"===l?"text-yellow-400":"text-blue-700"),children:"Run Summary"}),st.jsxs("div",{className:"text-xs "+("gold"===l?"text-yellow-300":"text-blue-600"),children:[F.leads_found," leads • $",F.cost_usd.toFixed(2)," cost • ",F.niche]}),st.jsx("div",{className:"text-xs text-gray-500",children:new Date(F.created_at).toLocaleDateString()})]}),b.length>0&&st.jsxs("button",{onClick:P,className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg border transition-colors "+("gold"===l?"border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border-gray-300 text-gray-700 hover:bg-gray-50"),children:[st.jsx(H,{className:"h-4 w-4 mr-2"}),"Create New List (",b.length,")"]})]})}),n&&st.jsxs(st.Fragment,{children:[st.jsx("div",{className:"p-4 rounded-lg border "+("gold"===l?"border-yellow-400/20 bg-black/10":"border-gray-200 bg-gray-50"),children:st.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[st.jsx("div",{className:"flex-1 max-w-md",children:st.jsxs("div",{className:"relative",children:[st.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 "+("gold"===l?"text-yellow-400":"text-gray-400")}),st.jsx("input",{type:"text",placeholder:"Search discovered leads...",value:y,onChange:e=>p(e.target.value),className:`w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 ${"gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"} focus:border-transparent`})]})}),st.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[st.jsxs("select",{value:k,onChange:e=>_(e.target.value),className:"px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),children:[st.jsx("option",{value:"all",children:"All Leads"}),st.jsx("option",{value:"high_intent",children:"High Intent (70%+)"}),st.jsx("option",{value:"has_email",children:"Has Email"}),st.jsx("option",{value:"has_phone",children:"Has Phone"})]}),st.jsxs("select",{value:`${j}-${w}`,onChange:e=>{const[t,s]=e.target.value.split("-");v(t),N(s)},className:"px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===l?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),children:[st.jsx("option",{value:"intent_score-desc",children:"Highest Intent"}),st.jsx("option",{value:"intent_score-asc",children:"Lowest Intent"}),st.jsx("option",{value:"created_at-desc",children:"Newest First"}),st.jsx("option",{value:"created_at-asc",children:"Oldest First"}),st.jsx("option",{value:"company-asc",children:"Company A-Z"}),st.jsx("option",{value:"company-desc",children:"Company Z-A"})]}),b.length>0&&st.jsxs("button",{onClick:()=>{const e=[["Name","Email","Phone","Company","Title","LinkedIn","Location","Intent Score","Tags","Reasons","Source"],...(b.length>0?r.filter(e=>b.includes(e.id)):T).map(e=>{var t,s,l;return[e.full_name||`${e.first_name||""} ${e.last_name||""}`.trim()||"",e.email||"",e.phone||"",e.company||"",e.title||"",e.linkedin_url||"",[e.city,e.state,e.country].filter(Boolean).join(", "),(null==(t=e.intent_score)?void 0:t.toString())||"0",(null==(s=e.tags)?void 0:s.join("; "))||"",(null==(l=e.reasons)?void 0:l.join("; "))||"",e.source_slug||""]})].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n"),t=new Blob([e],{type:"text/csv"}),s=URL.createObjectURL(t),l=document.createElement("a");l.href=s,l.download=`discovered_leads_${(new Date).toISOString().split("T")[0]}.csv`,l.click(),URL.revokeObjectURL(s)},className:"inline-flex items-center px-3 py-2 text-sm rounded-lg transition-colors "+("gold"===l?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-50"),children:[st.jsx(he,{className:"h-4 w-4 mr-1"}),"Export (",b.length,")"]})]})]})}),st.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===l?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-white"),children:[st.jsxs("div",{className:"flex items-center",children:[st.jsx(M,{className:"h-5 w-5 mr-2 "+("gold"===l?"text-yellow-400":"text-blue-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===l?"text-gray-300":"text-gray-700"),children:"Total Leads"})]}),st.jsx("p",{className:"text-2xl font-bold mt-1 "+("gold"===l?"text-yellow-400":"text-blue-600"),children:T.length})]}),st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===l?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-white"),children:[st.jsxs("div",{className:"flex items-center",children:[st.jsx(A,{className:"h-5 w-5 mr-2 "+("gold"===l?"text-yellow-400":"text-green-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===l?"text-gray-300":"text-gray-700"),children:"High Intent"})]}),st.jsx("p",{className:"text-2xl font-bold mt-1 "+("gold"===l?"text-yellow-400":"text-green-600"),children:T.filter(e=>e.intent_score>=.7).length})]}),st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===l?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-white"),children:[st.jsxs("div",{className:"flex items-center",children:[st.jsx(L,{className:"h-5 w-5 mr-2 "+("gold"===l?"text-yellow-400":"text-purple-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===l?"text-gray-300":"text-gray-700"),children:"With Email"})]}),st.jsx("p",{className:"text-2xl font-bold mt-1 "+("gold"===l?"text-yellow-400":"text-purple-600"),children:T.filter(e=>e.email).length})]}),st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===l?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-white"),children:[st.jsxs("div",{className:"flex items-center",children:[st.jsx(J,{className:"h-5 w-5 mr-2 "+("gold"===l?"text-yellow-400":"text-orange-600")}),st.jsx("span",{className:"text-sm font-medium "+("gold"===l?"text-gray-300":"text-gray-700"),children:"With Phone"})]}),st.jsx("p",{className:"text-2xl font-bold mt-1 "+("gold"===l?"text-yellow-400":"text-orange-600"),children:T.filter(e=>e.phone).length})]})]}),st.jsx("div",{className:"rounded-xl border "+("gold"===l?"black-card gold-border":"bg-white border-gray-200"),children:0===T.length?st.jsxs("div",{className:"text-center py-12",children:[st.jsx(z,{className:"h-12 w-12 mx-auto mb-4 "+("gold"===l?"text-gray-600":"text-gray-400")}),st.jsx("h3",{className:"text-lg font-medium mb-2 "+("gold"===l?"text-gray-200":"text-gray-900"),children:n?"No leads found":"Select a discovery run"}),st.jsx("p",{className:"gold"===l?"text-gray-400":"text-gray-600",children:n?y||"all"!==k?"No leads match your search criteria":"This discovery run found no leads":"Choose a discovery run from the dropdown above to view leads"})]}):st.jsxs(st.Fragment,{children:[st.jsx("div",{className:"overflow-x-auto",children:st.jsxs("table",{className:"min-w-full",children:[st.jsx("thead",{className:""+("gold"===l?"bg-black/20":"bg-gray-50"),children:st.jsxs("tr",{children:[st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===l?"text-gray-400":"text-gray-500"),children:st.jsx("input",{type:"checkbox",checked:b.length===T.length&&T.length>0,onChange:()=>{b.length===T.length?f([]):f(T.map(e=>e.id))},className:"rounded"})}),st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===l?"text-gray-400":"text-gray-500"),children:"Lead"}),st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===l?"text-gray-400":"text-gray-500"),children:"Contact"}),st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===l?"text-gray-400":"text-gray-500"),children:"Company"}),st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===l?"text-gray-400":"text-gray-500"),children:"Intent Score"}),st.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===l?"text-gray-400":"text-gray-500"),children:"Source"})]})}),st.jsx("tbody",{className:"divide-y "+("gold"===l?"divide-yellow-400/20":"divide-gray-200"),children:T.map(e=>{return st.jsxs("tr",{className:`hover:${"gold"===l?"bg-yellow-400/5":"bg-gray-50"} transition-colors`,children:[st.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:st.jsx("input",{type:"checkbox",checked:b.includes(e.id),onChange:()=>{return t=e.id,void f(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"rounded"})}),st.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center "+("gold"===l?"bg-blue-500/20":"bg-blue-100"),children:st.jsx(M,{className:"h-5 w-5 "+("gold"===l?"text-blue-400":"text-blue-600")})}),st.jsxs("div",{className:"ml-4",children:[st.jsx("div",{className:"text-sm font-medium "+("gold"===l?"text-gray-200":"text-gray-900"),children:e.full_name||`${e.first_name||""} ${e.last_name||""}`.trim()||"Unknown"}),e.title&&st.jsx("div",{className:"text-sm "+("gold"===l?"text-gray-400":"text-gray-500"),children:e.title}),e.linkedin_url&&st.jsxs("a",{href:e.linkedin_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs hover:underline flex items-center "+("gold"===l?"text-blue-400":"text-blue-600"),children:[st.jsx(ve,{className:"h-3 w-3 mr-1"}),"LinkedIn"]})]})]})}),st.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:st.jsxs("div",{className:"space-y-1",children:[e.email&&st.jsxs("div",{className:"flex items-center text-sm "+("gold"===l?"text-gray-300":"text-gray-700"),children:[st.jsx(L,{className:"h-3 w-3 mr-2"}),e.email]}),e.phone&&st.jsxs("div",{className:"flex items-center text-sm "+("gold"===l?"text-gray-300":"text-gray-700"),children:[st.jsx(J,{className:"h-3 w-3 mr-2"}),e.phone]}),!e.email&&!e.phone&&st.jsx("span",{className:"text-sm text-gray-500",children:"No contact info"})]})}),st.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:st.jsxs("div",{children:[e.company?st.jsxs("div",{className:"flex items-center text-sm "+("gold"===l?"text-gray-300":"text-gray-700"),children:[st.jsx(ye,{className:"h-3 w-3 mr-2"}),e.company]}):st.jsx("span",{className:"text-sm text-gray-500",children:"No company"}),(e.city||e.state||e.country)&&st.jsxs("div",{className:"flex items-center text-xs mt-1 "+("gold"===l?"text-gray-400":"text-gray-500"),children:[st.jsx(Ue,{className:"h-3 w-3 mr-1"}),[e.city,e.state,e.country].filter(Boolean).join(", ")]})]})}),st.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx("div",{className:"px-3 py-1 rounded-full text-sm font-medium "+(t=e.intent_score,t>=.8?"gold"===l?"bg-green-500/20":"bg-green-100":t>=.6?"gold"===l?"bg-yellow-500/20":"bg-yellow-100":t>=.4?"gold"===l?"bg-orange-500/20":"bg-orange-100":"gold"===l?"bg-red-500/20":"bg-red-100"),children:st.jsxs("span",{className:R(e.intent_score),children:[Math.round(100*e.intent_score),"%"]})}),e.intent_score>=.8&&st.jsx(A,{className:"h-4 w-4 "+("gold"===l?"text-yellow-400":"text-yellow-500")})]}),e.tags&&e.tags.length>0&&st.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[e.tags.slice(0,2).map((e,t)=>st.jsx("span",{className:"text-xs px-2 py-1 rounded-full "+("gold"===l?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-700"),children:e},t)),e.tags.length>2&&st.jsxs("span",{className:"text-xs px-2 py-1 rounded-full "+("gold"===l?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-600"),children:["+",e.tags.length-2]})]})]}),st.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[st.jsx("div",{className:"text-sm "+("gold"===l?"text-gray-300":"text-gray-700"),children:e.source_slug||"Unknown"}),st.jsx("div",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]})]},e.id);var t})})]})}),b.length>0&&st.jsx("div",{className:"px-6 py-4 border-t "+("gold"===l?"border-yellow-400/20":"border-gray-200"),children:st.jsx("div",{className:"p-4 rounded-lg "+("gold"===l?"bg-yellow-400/10 border border-yellow-400/20":"bg-blue-50 border border-blue-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("span",{className:"text-sm font-medium "+("gold"===l?"text-yellow-400":"text-blue-700"),children:[b.length," leads selected"]}),st.jsx("div",{className:"flex items-center space-x-2",children:st.jsx("button",{onClick:()=>f([]),className:`text-sm ${"gold"===l?"text-gray-400":"text-gray-600"} hover:underline`,children:"Clear selection"})})]})})})]})})]})]})}function Qt({onLeadsFound:e}){const{user:t}=nt(),{theme:s}=gt(),[l,r]=g.useState(""),[a,o]=g.useState(!1),[d,m]=g.useState([]),[x,u]=g.useState(null),[h,y]=g.useState(!1),[p,b]=g.useState(""),[f,j]=g.useState(!1),[v,w]=g.useState({}),[N,k]=g.useState(["linkedin-basic","x-twitter","google-maps","indeed-jobs"]),[_,C]=g.useState({}),S={"linkedin-basic":{title:"LinkedIn Basic",category:"social",icon:"💼",requiresCookies:!0,fields:[{key:"li_at",label:"li_at Cookie",type:"password",required:!0},{key:"JSESSIONID",label:"JSESSIONID",type:"password",required:!0}],helper:"Chrome: DevTools → Application → Cookies → linkedin.com"},"linkedin-sales-navigator":{title:"Sales Navigator",category:"social",icon:"🎯",requiresCookies:!0,fields:[{key:"li_at",label:"li_at Cookie",type:"password",required:!0},{key:"JSESSIONID",label:"JSESSIONID",type:"password",required:!0},{key:"li_a",label:"li_a Cookie",type:"password",required:!1}],helper:"Chrome: DevTools → Application → Cookies → linkedin.com"},"x-twitter":{title:"X (Twitter)",category:"social",icon:"🐦",requiresCookies:!0,fields:[{key:"auth_token",label:"auth_token",type:"password",required:!0},{key:"ct0",label:"ct0 (CSRF Token)",type:"password",required:!0}],helper:"Chrome: DevTools → Application → Cookies → twitter.com"},"facebook-groups":{title:"Facebook Groups",category:"social",icon:"👥",requiresCookies:!0,fields:[{key:"c_user",label:"c_user",type:"password",required:!0},{key:"xs",label:"xs Cookie",type:"password",required:!0},{key:"fr",label:"fr Cookie",type:"password",required:!0}],helper:"Chrome: DevTools → Application → Cookies → facebook.com"},"instagram-basic":{title:"Instagram",category:"social",icon:"📸",requiresCookies:!0,fields:[{key:"sessionid",label:"sessionid",type:"password",required:!0},{key:"csrftoken",label:"csrftoken",type:"password",required:!0}],helper:"Chrome: DevTools → Application → Cookies → instagram.com"},"reddit-auth":{title:"Reddit",category:"social",icon:"🤖",requiresCookies:!0,fields:[{key:"reddit_session",label:"reddit_session",type:"password",required:!0}],helper:"Chrome: DevTools → Application → Cookies → reddit.com"},"google-maps":{title:"Google Maps",category:"maps",icon:"🗺️",requiresCookies:!0,fields:[{key:"SAPISID",label:"SAPISID",type:"password",required:!0},{key:"__Secure-3PSAPISID",label:"__Secure-3PSAPISID",type:"password",required:!0}],helper:"Chrome: DevTools → Application → Cookies → maps.google.com"},"indeed-jobs":{title:"Indeed Jobs",category:"jobs",icon:"💼",requiresCookies:!0,fields:[{key:"CTK",label:"CTK Session",type:"password",required:!0}],helper:"Chrome: DevTools → Application → Cookies → indeed.com"},glassdoor:{title:"Glassdoor",category:"jobs",icon:"🏢",requiresCookies:!0,fields:[{key:"GDSession",label:"GDSession",type:"password",required:!0},{key:"TS01ac2299",label:"TS Cookie",type:"password",required:!0}],helper:"Chrome: DevTools → Application → Cookies → glassdoor.com"},"apollo-portal":{title:"Apollo.io",category:"enrichment",icon:"🚀",requiresCookies:!1,fields:[{key:"api_key",label:"API Key",type:"password",required:!0}],helper:"Get from Apollo.io dashboard → Settings → API"},"hunter-io":{title:"Hunter.io",category:"enrichment",icon:"🔍",requiresCookies:!1,fields:[{key:"api_key",label:"API Key",type:"password",required:!0}],helper:"Get from Hunter.io dashboard → API tab"},"people-data-labs":{title:"People Data Labs",category:"enrichment",icon:"👥",requiresCookies:!1,fields:[{key:"api_key",label:"API Key",type:"password",required:!0}],helper:"Get from PDL dashboard → API Keys"},dropcontact:{title:"Dropcontact",category:"enrichment",icon:"📧",requiresCookies:!1,fields:[{key:"api_key",label:"API Key",type:"password",required:!0}],helper:"Get from Dropcontact dashboard → API"},"serper-bing":{title:"Serper (Bing)",category:"search",icon:"🔎",requiresCookies:!1,fields:[{key:"api_key",label:"API Key",type:"password",required:!0}],helper:"Get from Serper.dev dashboard"},"github-scraper":{title:"GitHub",category:"developer",icon:"👨‍💻",requiresCookies:!0,fields:[{key:"user_session",label:"user_session",type:"password",required:!0}],helper:"Chrome: DevTools → Application → Cookies → github.com"}};g.useEffect(()=>{t&&A()},[t]);const A=()=>c(this,null,function*(){if(t)try{const{data:e,error:s}=yield at.from("intent_runs").select("*").eq("user_id",t.id).order("created_at",{ascending:!1}).limit(5);if(s){if("42P01"===s.code)return console.warn("Intent runs table not yet created"),void m([]);throw s}m(e||[])}catch(e){console.error("Error fetching recent runs:",e),m([])}}),q=()=>c(this,null,function*(){if(t&&l.trim()){o(!0);try{const e=l.trim(),s=T(l),a=O(l),{data:o,error:i}=yield at.from("intent_runs").insert([{user_id:t.id,goal:e,niche:s,signals:a,seed_queries:[l],status:"running",budget_max_usd:8,credentials:Object.keys(v).length>0?v:null,actors_config:{selected_actors:N,actors_used:N}}]).select().single();if(i)throw i;u(o);if(!(yield fetch("https://hook.eu2.make.com/your-orchestrator-webhook",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaign_id:`intent_${o.id}`,user_id:t.id,goal:e,niche:s,signals:a,seed_queries:[l],credentials:Object.keys(v).length>0?v:null,selected_actors:N,actors_allow:["twitter_search_ppr","reddit_members","places_yelp","jobs_indeed"],top_k:300,budget:{max_usd:8},explore_ratio:.1})})).ok)throw new Error("Failed to start intent discovery");D(o.id),r("")}catch(e){console.error("Error starting intent discovery:",e),o(!1),x&&(yield at.from("intent_runs").update({status:"failed",error_message:e instanceof Error?e.message:"Unknown error",completed_at:(new Date).toISOString()}).eq("id",x.id))}}}),D=t=>c(this,null,function*(){let s=0;const l=()=>c(this,null,function*(){try{const{data:r,error:a}=yield at.from("intent_runs").select("*").eq("id",t).single();if(a)throw a;if(u(r),"completed"===r.status)return o(!1),A(),r.leads_found>0&&(yield L(t,r.goal)),e(),b(t),void y(!0);if("failed"===r.status)return void o(!1);s++,s<60?setTimeout(l,5e3):o(!1)}catch(r){console.error("Error polling run status:",r),o(!1)}});l()}),L=(e,s)=>c(this,null,function*(){if(t)try{const l=`Discovery: ${s.substring(0,50)}${s.length>50?"...":""}`,r=`Auto-generated from discovery run on ${(new Date).toLocaleDateString()}. Goal: ${s}`,{data:a,error:o}=yield at.from("lists").insert([{user_id:t.id,name:l,description:r,tags:["discovery","auto-generated"]}]).select().single();if(o)throw o;const{data:i,error:n}=yield at.from("discovered_leads").select("*").eq("intent_run_id",e).eq("user_id",t.id);if(n)throw n;if(i&&i.length>0){const s=i.map(s=>({list_id:a.id,user_id:t.id,name:s.full_name||`${s.first_name||""} ${s.last_name||""}`.trim()||"Unknown Lead",email:s.email,phone:s.phone,company_name:s.company,job_title:s.title,source_url:s.linkedin_url,source_platform:s.source_slug||"discovery",custom_fields:{intent_score:s.intent_score,tags:s.tags||[],reasons:s.reasons||[],country:s.country,state:s.state,city:s.city,company_domain:s.company_domain,discovery_run_id:e}})),r=50;for(let e=0;e<s.length;e+=r){const t=s.slice(e,e+r),{error:l}=yield at.from("list_leads").insert(t);l&&console.error("Error inserting batch:",l)}console.log(`Created list "${l}" with ${s.length} discovered leads`)}}catch(l){console.error("Error creating list from discovered leads:",l)}}),T=e=>["SaaS","E-commerce","Healthcare","Fintech","EdTech","PropTech","MarTech"].find(t=>e.toLowerCase().includes(t.toLowerCase()))||"General",O=e=>{const t=[];return Object.entries({hiring:["hiring","recruiting","looking for","need help"],funding:["funding","raised","investment","series"],growth:["scaling","growing","expanding","growth"],pain:["struggling","problem","issue","challenge"],budget:["budget","spend","invest","cost"]}).forEach(([s,l])=>{l.some(t=>e.toLowerCase().includes(t))&&t.push(s)}),t.length>0?t:["general_intent"]},M=(e,t,s)=>{w(l=>n(i({},l),{[e]:n(i({},l[e]),{[t]:s})}))},U=(e,t)=>{const s=(e=>{const t={};return e.split(";").forEach(e=>{const[s,...l]=e.split("=");if(s&&l.length>0){const e=s.trim(),r=l.join("=").trim();e&&r&&(t[e]=r)}}),t})(t),l=S[e];if(l){const t={};l.fields.forEach(e=>{s[e.key]&&(t[e.key]=s[e.key])}),w(s=>n(i({},s),{[e]:n(i(i({},s[e]),t),{user_agent:navigator.userAgent})}))}},B=e=>{switch(e){case"connected":return $;case"incomplete":return I;default:return xe}},H=e=>{switch(e){case"connected":case"completed":return"gold"===s?"text-green-400":"text-green-600";case"incomplete":case"running":return"gold"===s?"text-yellow-400":"text-yellow-600";case"failed":return"gold"===s?"text-red-400":"text-red-600";default:return"gold"===s?"text-gray-400":"text-gray-600"}};return st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{className:"p-6 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-gray-50"),children:[st.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:["gold"===s?st.jsx(E,{className:"h-6 w-6 text-yellow-400"}):st.jsx(De,{className:"h-6 w-6 text-blue-600"}),st.jsx("h3",{className:"text-lg font-semibold "+("gold"===s?"text-gray-200":"text-gray-900"),children:"AI Intent Discovery"})]}),st.jsx("p",{className:"text-sm mb-6 "+("gold"===s?"text-gray-400":"text-gray-600"),children:"Describe what type of leads you're looking for, and our AI will find prospects with buying intent across multiple platforms."}),st.jsxs("div",{className:"mb-6 p-4 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-yellow-400/5":"border-blue-200 bg-blue-50"),children:[st.jsxs("div",{className:"flex items-center justify-between mb-4",children:[st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx(Se,{className:"h-5 w-5 "+("gold"===s?"text-yellow-400":"text-blue-600")}),st.jsxs("h4",{className:"text-sm font-medium "+("gold"===s?"text-yellow-400":"text-blue-700"),children:["Scraping Credentials (",Object.keys(v).length,"/",N.length,")"]})]}),st.jsx("button",{onClick:()=>j(!f),className:`text-sm ${"gold"===s?"text-yellow-400":"text-blue-600"} hover:underline`,children:f?"Hide":"Setup Credentials"})]}),st.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:N.map(e=>{const t=S[e],l=(e=>{const t=v[e];if(!t)return"not_connected";const s=S[e];return s?s.fields.filter(e=>e.required).every(e=>{var s;return null==(s=t[e.key])?void 0:s.trim()})?"connected":"incomplete":"not_connected"})(e),r=B(l);return st.jsx("div",{className:"p-3 rounded-lg border "+("connected"===l?"gold"===s?"border-green-500/30 bg-green-500/10":"border-green-200 bg-green-50":"gold"===s?"border-gray-600 bg-gray-800/50":"border-gray-200 bg-white"),children:st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsx("span",{className:"text-lg",children:null==t?void 0:t.icon}),st.jsxs("div",{className:"flex-1 min-w-0",children:[st.jsx("div",{className:"text-xs font-medium truncate "+("gold"===s?"text-gray-200":"text-gray-900"),children:null==t?void 0:t.title}),st.jsxs("div",{className:"flex items-center space-x-1",children:[st.jsx(r,{className:`h-3 w-3 ${H(l)}`}),st.jsx("span",{className:`text-xs ${H(l)}`,children:"connected"===l?"Ready":"incomplete"===l?"Setup":"Not Set"})]})]})]})},e)})}),f&&st.jsx("div",{className:"space-y-4",children:N.map(e=>{const t=S[e],l=v[e]||{};return st.jsxs("div",{className:"p-4 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-white"),children:[st.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[st.jsx("span",{className:"text-xl",children:null==t?void 0:t.icon}),st.jsxs("div",{children:[st.jsx("h5",{className:"font-medium "+("gold"===s?"text-gray-200":"text-gray-900"),children:null==t?void 0:t.title}),st.jsx("p",{className:"text-xs text-gray-500",children:null==t?void 0:t.helper})]})]}),(null==t?void 0:t.requiresCookies)&&st.jsxs("div",{className:"mb-4",children:[st.jsx("label",{className:"block text-xs font-medium mb-2 "+("gold"===s?"text-gray-300":"text-gray-700"),children:"Paste Raw Cookie String (Quick Setup)"}),st.jsxs("div",{className:"flex space-x-2",children:[st.jsx("input",{type:"text",placeholder:"Paste browser cookies here...",className:"flex-1 px-3 py-2 text-xs border rounded-lg focus:outline-none focus:ring-2 "+("gold"===s?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),onPaste:t=>{const s=t.clipboardData.getData("text");U(e,s)}}),st.jsx("button",{onClick:()=>{const t=document.querySelector('input[placeholder="Paste browser cookies here..."]');(null==t?void 0:t.value)&&(U(e,t.value),t.value="")},className:"px-3 py-2 text-xs rounded-lg transition-colors "+("gold"===s?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-50"),children:"Parse"})]})]}),st.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[null==t?void 0:t.fields.map(t=>{const r="password"===t.type,a=_[`${e}-${t.key}`]||!1;return st.jsxs("div",{children:[st.jsxs("label",{className:"block text-xs font-medium mb-1 "+("gold"===s?"text-gray-300":"text-gray-700"),children:[t.label,t.required&&st.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),st.jsxs("div",{className:"relative",children:[st.jsx("input",{type:r&&!a?"password":"text",value:l[t.key]||"",onChange:s=>M(e,t.key,s.target.value),className:`w-full px-3 py-2 text-xs border rounded-lg focus:outline-none focus:ring-2 ${r?"pr-8":""} ${"gold"===s?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"}`,placeholder:t.key}),r&&st.jsx("button",{type:"button",onClick:()=>C(s=>n(i({},s),{[`${e}-${t.key}`]:!a})),className:"absolute right-2 top-1/2 transform -translate-y-1/2 "+("gold"===s?"text-gray-400":"text-gray-500"),children:a?st.jsx(P,{className:"h-3 w-3"}):st.jsx(R,{className:"h-3 w-3"})})]})]},t.key)}),st.jsxs("div",{className:"md:col-span-2",children:[st.jsx("label",{className:"block text-xs font-medium mb-1 "+("gold"===s?"text-gray-300":"text-gray-700"),children:"User Agent"}),st.jsx("input",{type:"text",value:l.user_agent||navigator.userAgent,onChange:t=>M(e,"user_agent",t.target.value),className:"w-full px-3 py-2 text-xs border rounded-lg focus:outline-none focus:ring-2 "+("gold"===s?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"Browser user agent"})]})]})]},e)})}),st.jsx("div",{className:"text-xs text-gray-500",children:"💡 Credentials are stored securely and only used for this discovery run"})]}),h&&p&&st.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto "+("gold"===s?"bg-black/75":"bg-gray-900/50"),children:st.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:st.jsxs("div",{className:"w-full max-w-7xl rounded-xl shadow-2xl "+("gold"===s?"black-card gold-border":"bg-white border border-gray-200"),children:[st.jsx("div",{className:"p-6 border-b "+("gold"===s?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsx("h2",{className:"text-xl font-bold "+("gold"===s?"text-gray-200":"text-gray-900"),children:"Discovered Leads Results"}),st.jsx("button",{onClick:()=>y(!1),className:"p-2 rounded-lg transition-colors "+("gold"===s?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"),children:st.jsx(ee,{className:"h-5 w-5"})})]})}),st.jsx("div",{className:"p-6 max-h-[80vh] overflow-y-auto",children:st.jsx(Xt,{intentRunId:p,onAddToList:e=>{console.log("Adding leads to list:",e),y(!1)}})})]})})}),x&&a&&st.jsx("div",{className:"mb-6 p-4 rounded-lg border "+("gold"===s?"border-blue-500/30 bg-blue-500/10":"border-blue-200 bg-blue-50"),children:st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-transparent "+("gold"===s?"border-t-yellow-400":"border-t-blue-600")}),st.jsxs("div",{children:[st.jsx("div",{className:"text-sm font-medium "+("gold"===s?"text-blue-400":"text-blue-700"),children:"Discovering leads..."}),st.jsxs("div",{className:"text-xs "+("gold"===s?"text-blue-300":"text-blue-600"),children:["Goal: ",x.goal]})]})]})}),st.jsxs("div",{className:"space-y-4",children:[st.jsxs("div",{className:"relative",children:[st.jsx("textarea",{value:l,onChange:e=>r(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),q())},rows:3,className:"w-full px-4 py-3 pr-12 border rounded-lg focus:outline-none focus:ring-2 resize-none "+("gold"===s?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"e.g., Find SaaS founders who are hiring marketing agencies and have raised funding recently...",disabled:a}),st.jsx("button",{onClick:q,disabled:a||!l.trim(),className:`absolute bottom-3 right-3 p-2 rounded-lg transition-colors ${"gold"===s?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50 disabled:cursor-not-allowed`,children:a?st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-transparent "+("gold"===s?"border-t-black":"border-t-white")}):st.jsx(fe,{className:"h-4 w-4"})})]}),st.jsx("div",{className:"flex flex-wrap gap-2",children:["Find SaaS founders hiring marketing help","E-commerce companies with growth signals","Healthcare startups raising funding","Fintech companies posting job openings"].map((e,t)=>st.jsx("button",{onClick:()=>r(e),disabled:a,className:`text-xs px-3 py-1 rounded-full border transition-colors ${"gold"===s?"border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border-gray-300 text-gray-600 hover:bg-gray-100"} disabled:opacity-50`,children:e},t))})]})]}),d.length>0&&st.jsxs("div",{className:"p-6 rounded-lg border "+("gold"===s?"border-yellow-400/20 bg-black/20":"border-gray-200 bg-gray-50"),children:[st.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[st.jsx(F,{className:"h-5 w-5 "+("gold"===s?"text-yellow-400":"text-blue-600")}),st.jsx("h4",{className:"text-lg font-semibold "+("gold"===s?"text-gray-200":"text-gray-900"),children:"Recent Discovery Runs"})]}),st.jsx("div",{className:"space-y-3",children:d.map(e=>{const t=B(e.status);return st.jsxs("div",{className:"p-4 rounded-lg border overflow-hidden "+("gold"===s?"border-yellow-400/10 bg-black/10":"border-gray-200 bg-white"),children:[st.jsxs("div",{className:"flex items-start justify-between mb-2 gap-3",children:[st.jsxs("div",{className:"flex items-center space-x-2 min-w-0 flex-1",children:[st.jsx(t,{className:`h-4 w-4 ${H(e.status)}`}),st.jsx("span",{className:"text-sm font-medium truncate "+("gold"===s?"text-gray-200":"text-gray-900"),children:e.goal.length>80?`${e.goal.substring(0,80)}...`:e.goal})]}),st.jsx("span",{className:"text-xs whitespace-nowrap flex-shrink-0 text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]}),st.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[st.jsxs("div",{className:"flex items-center space-x-3 text-xs flex-wrap",children:[st.jsxs("span",{className:"gold"===s?"text-gray-400":"text-gray-600",children:[st.jsx(z,{className:"h-3 w-3 inline mr-1"}),e.leads_found," leads"]}),st.jsxs("span",{className:"gold"===s?"text-gray-400":"text-gray-600",children:[st.jsx(Be,{className:"h-3 w-3 inline mr-1"}),"$",e.cost_usd.toFixed(2)]}),st.jsx("span",{className:("gold"===s?"text-gray-400":"text-gray-600")+" truncate max-w-20",children:e.niche})]}),st.jsxs("div",{className:"flex flex-wrap gap-1 justify-end items-center",children:["completed"===e.status&&e.leads_found>0&&st.jsxs("button",{onClick:()=>{b(e.id),y(!0)},className:"text-xs px-2 py-1 rounded-full transition-colors "+("gold"===s?"bg-blue-500/20 text-blue-400 hover:bg-blue-500/30":"bg-blue-100 text-blue-700 hover:bg-blue-200"),children:["View ",e.leads_found," Leads"]}),e.signals.slice(0,2).map((e,t)=>st.jsx("span",{className:"text-xs px-2 py-1 rounded-full whitespace-nowrap "+("gold"===s?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-700"),children:e.length>12?`${e.substring(0,12)}...`:e},t)),e.signals.length>2&&st.jsxs("span",{className:"text-xs px-2 py-1 rounded-full "+("gold"===s?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-600"),children:["+",e.signals.length-2]})]})]})]},e.id)})})]}),st.jsxs("div",{className:"p-4 rounded-lg "+("gold"===s?"bg-yellow-400/10 border border-yellow-400/20":"bg-blue-50 border border-blue-200"),children:[st.jsx("h4",{className:"text-sm font-medium mb-2 "+("gold"===s?"text-yellow-400":"text-blue-700"),children:"💡 Discovery Tips"}),st.jsxs("ul",{className:"text-sm space-y-1 "+("gold"===s?"text-yellow-300":"text-blue-600"),children:[st.jsx("li",{children:'• Be specific about industry and role (e.g., "SaaS founders", "Marketing directors")'}),st.jsx("li",{children:'• Include buying signals (e.g., "hiring", "raised funding", "looking for")'}),st.jsx("li",{children:'• Mention pain points or needs (e.g., "struggling with lead gen")'}),st.jsx("li",{children:"• Add credentials above to unlock premium data sources"}),st.jsx("li",{children:"• Each run costs ~$2-8 and finds 100-300 high-intent leads"})]})]})]})}function Zt({listId:e,listName:t,onClose:s,onSave:l}){const{user:r}=nt(),{theme:a}=gt(),[o,i]=g.useState([]),[n,d]=g.useState([]),[m,x]=g.useState(!0),[u,h]=g.useState(!1),[y,p]=g.useState(null),[b,f]=g.useState(new Set),[j,v]=g.useState(null),[w,N]=g.useState(""),[k,_]=g.useState(!1),[C,S]=g.useState(""),[E,A]=g.useState(""),[q,D]=g.useState(""),[L,T]=g.useState("email"),P=g.useRef(null),R=[{key:"name",label:"Name",width:"200px"},{key:"email",label:"Email",width:"250px"},{key:"phone",label:"Phone",width:"150px"},{key:"company_name",label:"Company",width:"200px"},{key:"job_title",label:"Job Title",width:"180px"},{key:"source_url",label:"Source URL",width:"200px"},{key:"source_platform",label:"Source",width:"120px"},{key:"score",label:"AI Score",width:"100px"},{key:"label",label:"Decision",width:"100px"},{key:"normalized_title",label:"Clean Title",width:"180px"},{key:"normalized_industry",label:"Clean Industry",width:"150px"},{key:"reasons",label:"AI Reasons",width:"250px"},{key:"ai_notes",label:"AI Notes",width:"250px"},{key:"batch_id",label:"Batch ID",width:"150px"}];g.useEffect(()=>{e&&r&&F()},[e,r]);const F=()=>c(this,null,function*(){if(r)try{x(!0);const{data:t,error:s}=yield at.from("list_leads").select("*").eq("list_id",e).eq("user_id",r.id).order("created_at",{ascending:!1});if(s)throw s;const l=(t||[]).map(e=>{var t;return{id:e.id,name:e.name||"",email:e.email||"",phone:e.phone||"",company_name:e.company_name||"",job_title:e.job_title||"",source_url:e.source_url||"",source_platform:e.source_platform||"",score:(null==(t=e.score)?void 0:t.toString())||"",label:e.label||"",normalized_title:e.normalized_title||"",normalized_industry:e.normalized_industry||"",reasons:e.reasons||"",ai_notes:e.ai_notes||"",batch_id:e.batch_id||"",isNew:!1,isModified:!1,isDeleted:!1}});i(l),d(JSON.parse(JSON.stringify(l)))}catch(t){console.error("Error fetching leads:",t),p({success:!1,message:"Failed to load leads"})}finally{x(!1)}}),O=o.some(e=>e.isNew||e.isModified||e.isDeleted),M=o.filter(e=>!e.isDeleted);return m?st.jsx("div",{className:"flex items-center justify-center h-64",children:st.jsx(bt,{size:"lg",message:"Loading spreadsheet editor..."})}):st.jsx("div",{className:"fixed inset-0 z-50 overflow-hidden "+("gold"===a?"bg-black/75":"bg-gray-900/50"),children:st.jsxs("div",{className:"h-full flex flex-col "+("gold"===a?"black-card":"bg-white"),children:[st.jsxs("div",{className:"flex items-center justify-between p-6 border-b "+("gold"===a?"border-yellow-400/20":"border-gray-200"),children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center "+("gold"===a?"gold-gradient":"bg-blue-100"),children:st.jsx(He,{className:"h-6 w-6 "+("gold"===a?"text-black":"text-blue-600")})}),st.jsxs("div",{children:[st.jsxs("h2",{className:"text-xl font-bold "+("gold"===a?"text-gray-200":"text-gray-900"),children:["Edit List: ",t]}),st.jsxs("p",{className:"text-sm "+("gold"===a?"text-gray-400":"text-gray-600"),children:["Spreadsheet-like editor for your lead list (",M.length," leads)"]})]})]}),st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsxs("button",{onClick:()=>{const e=[R.map(e=>e.label),...o.filter(e=>!e.isDeleted).map(e=>R.map(t=>e[t.key]||""))].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n"),s=new Blob([e],{type:"text/csv"}),l=URL.createObjectURL(s),r=document.createElement("a");r.href=l,r.download=`${t}_edited_${(new Date).toISOString().split("T")[0]}.csv`,r.click(),URL.revokeObjectURL(l)},className:"inline-flex items-center px-3 py-2 text-sm rounded-lg border transition-colors "+("gold"===a?"border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border-gray-300 text-gray-700 hover:bg-gray-50"),children:[st.jsx(he,{className:"h-4 w-4 mr-1"}),"Export"]}),st.jsxs("button",{onClick:()=>c(this,null,function*(){if(r){h(!0),p(null);try{const t={toInsert:o.filter(e=>e.isNew&&!e.isDeleted),toUpdate:o.filter(e=>e.isModified&&!e.isNew&&!e.isDeleted),toDelete:o.filter(e=>e.isDeleted&&!e.isNew)};let s=0,a=0,i=0;if(t.toInsert.length>0){const l=t.toInsert.map(t=>({list_id:e,user_id:r.id,name:t.name||"Unnamed Lead",email:t.email||null,phone:t.phone||null,company_name:t.company_name||null,job_title:t.job_title||null,source_url:t.source_url||null,source_platform:t.source_platform||"manual",score:t.score?parseFloat(t.score):null,label:t.label||null,normalized_title:t.normalized_title||null,normalized_industry:t.normalized_industry||null,reasons:t.reasons||null,ai_notes:t.ai_notes||null,batch_id:t.batch_id||null,custom_fields:{}})),{error:a}=yield at.from("list_leads").insert(l);if(a)throw a;s=l.length}for(const e of t.toUpdate){const{error:t}=yield at.from("list_leads").update({name:e.name||"Unnamed Lead",email:e.email||null,phone:e.phone||null,company_name:e.company_name||null,job_title:e.job_title||null,source_url:e.source_url||null,source_platform:e.source_platform||"manual",score:e.score?parseFloat(e.score):null,label:e.label||null,normalized_title:e.normalized_title||null,normalized_industry:e.normalized_industry||null,reasons:e.reasons||null,ai_notes:e.ai_notes||null,batch_id:e.batch_id||null,updated_at:(new Date).toISOString()}).eq("id",e.id).eq("user_id",r.id);if(t)throw t;a++}if(t.toDelete.length>0){const e=t.toDelete.map(e=>e.id),{error:s}=yield at.from("list_leads").delete().in("id",e).eq("user_id",r.id);if(s)throw s;i=e.length}p({success:!0,message:`Changes saved! ${s} added, ${a} updated, ${i} deleted.`}),setTimeout(()=>{F(),l()},1500)}catch(t){console.error("Error saving changes:",t),p({success:!1,message:t instanceof Error?t.message:"Failed to save changes"})}finally{h(!1)}}}),disabled:u||!O,className:`inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors ${"gold"===a?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50`,children:[u?st.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}):st.jsx(oe,{className:"h-4 w-4 mr-2"}),u?"Saving...":O?"Save Changes":"No Changes"]}),st.jsx("button",{onClick:s,className:"p-2 rounded-lg transition-colors "+("gold"===a?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"),children:st.jsx(ee,{className:"h-5 w-5"})})]})]}),st.jsxs("div",{className:"flex items-center justify-between p-4 border-b "+("gold"===a?"border-yellow-400/20":"border-gray-200"),children:[st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsxs("button",{onClick:()=>{const e={id:`new_${Date.now()}`,name:"",email:"",phone:"",company_name:"",job_title:"",source_url:"",source_platform:"manual",score:"",label:"",normalized_title:"",normalized_industry:"",reasons:"",ai_notes:"",batch_id:"",isNew:!0,isModified:!1,isDeleted:!1};i([...o,e])},className:"inline-flex items-center px-3 py-2 text-sm rounded-lg transition-colors "+("gold"===a?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-50"),children:[st.jsx(H,{className:"h-4 w-4 mr-1"}),"Add Row"]}),st.jsxs("button",{onClick:()=>{const e=o.filter((e,t)=>b.has(`${t}`)).map(e=>R.map(t=>e[t.key]||"").join("\t")).join("\n");N(e),navigator.clipboard.writeText(e)},disabled:0===b.size,className:`inline-flex items-center px-3 py-2 text-sm rounded-lg transition-colors ${"gold"===a?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-50"} disabled:opacity-50`,children:[st.jsx(Ve,{className:"h-4 w-4 mr-1"}),"Copy"]}),st.jsxs("button",{onClick:()=>c(this,null,function*(){try{const e=yield navigator.clipboard.readText();console.log("Pasted data:",e)}catch(e){console.error("Failed to paste:",e)}}),className:"inline-flex items-center px-3 py-2 text-sm rounded-lg transition-colors "+("gold"===a?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-50"),children:[st.jsx(Ge,{className:"h-4 w-4 mr-1"}),"Paste"]})]}),st.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[O&&st.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+("gold"===a?"bg-yellow-500/20 text-yellow-400":"bg-yellow-100 text-yellow-800"),children:"Unsaved changes"}),st.jsxs("span",{className:"gold"===a?"text-gray-400":"text-gray-600",children:[M.length," rows"]})]})]}),y&&st.jsx("div",{className:"mx-6 mt-4 rounded-lg border p-4 "+(y.success?"gold"===a?"bg-green-500/10 border-green-500/30 text-green-400":"bg-green-50 border-green-200 text-green-800":"gold"===a?"bg-red-500/10 border-red-500/30 text-red-400":"bg-red-50 border-red-200 text-red-800"),children:st.jsxs("div",{className:"flex items-start",children:[st.jsx("div",{className:"flex-shrink-0",children:y.success?st.jsx($,{className:"h-5 w-5"}):st.jsx(I,{className:"h-5 w-5"})}),st.jsx("div",{className:"ml-3",children:st.jsx("p",{className:"text-sm font-medium",children:y.message})}),st.jsx("button",{onClick:()=>p(null),className:"ml-auto text-current hover:opacity-70",children:"×"})]})}),st.jsx("div",{className:"flex-1 overflow-auto p-6",children:st.jsx("div",{ref:P,className:"border rounded-lg overflow-hidden "+("gold"===a?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("table",{className:"min-w-full",children:[st.jsx("thead",{className:"sticky top-0 "+("gold"===a?"bg-black/40":"bg-gray-50"),children:st.jsxs("tr",{children:[st.jsx("th",{className:"w-12 px-4 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===a?"text-gray-400":"text-gray-500"),children:"#"}),R.map(e=>st.jsx("th",{style:{width:e.width},className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===a?"text-gray-400":"text-gray-500"),children:e.label},e.key)),st.jsx("th",{className:"w-16 px-4 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===a?"text-gray-400":"text-gray-500"),children:"Actions"})]})}),st.jsx("tbody",{className:"divide-y "+("gold"===a?"divide-yellow-400/20":"divide-gray-200"),children:M.map((e,t)=>st.jsxs("tr",{className:"transition-colors "+(e.isNew?"gold"===a?"bg-green-500/10":"bg-green-50":e.isModified?"gold"===a?"bg-yellow-500/10":"bg-yellow-50":"gold"===a?"hover:bg-yellow-400/5":"hover:bg-gray-50"),children:[st.jsxs("td",{className:"px-4 py-2 text-xs "+("gold"===a?"text-gray-500":"text-gray-400"),children:[t+1,e.isNew&&st.jsx("span",{className:"ml-1 text-xs "+("gold"===a?"text-green-400":"text-green-600"),children:"NEW"}),e.isModified&&st.jsx("span",{className:"ml-1 text-xs "+("gold"===a?"text-yellow-400":"text-yellow-600"),children:"MOD"})]}),R.map(s=>{const l=`${t}-${s.key}`,r=(null==j?void 0:j.rowIndex)===t&&(null==j?void 0:j.field)===s.key,d=e[s.key]||"";return st.jsx("td",{className:"px-4 py-2 border-r "+("gold"===a?"border-yellow-400/10":"border-gray-100"),style:{width:s.width},children:r?st.jsx("input",{type:"text",value:d,onChange:e=>((e,t,s)=>{const l=[...o],r=l[e];if(r){if(r[t]=s,!r.isNew){const e=n.find(e=>e.id===r.id);e&&e[t]!==s&&(r.isModified=!0)}i(l)}})(t,s.key,e.target.value),onBlur:()=>v(null),onKeyDown:e=>((e,t,s)=>{if("Enter"===e.key)e.preventDefault(),v(null);else if("Escape"===e.key)v(null);else if("Tab"===e.key){e.preventDefault();const l=R.findIndex(e=>e.key===s),r=e.shiftKey?l-1:l+1;r>=0&&r<R.length?v({rowIndex:t,field:R[r].key}):!e.shiftKey&&r>=R.length?t+1<o.length&&v({rowIndex:t+1,field:R[0].key}):e.shiftKey&&r<0&&t>0&&v({rowIndex:t-1,field:R[R.length-1].key})}})(e,t,s.key),className:"w-full px-2 py-1 text-sm border rounded focus:outline-none focus:ring-2 "+("gold"===a?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),autoFocus:!0}):st.jsx("div",{onClick:()=>((e,t)=>{v({rowIndex:e,field:t})})(t,s.key),className:`min-h-[24px] px-2 py-1 text-sm cursor-text rounded hover:bg-opacity-50 ${b.has(l)?"gold"===a?"bg-yellow-400/20":"bg-blue-100":"hover:bg-gray-100"} ${"gold"===a?"text-gray-200":"text-gray-900"}`,children:d||st.jsx("span",{className:"gold"===a?"text-gray-600":"text-gray-400",children:"Click to edit"})})},s.key)}),st.jsx("td",{className:"px-4 py-2",children:st.jsx("button",{onClick:()=>(e=>{const t=[...o];t[e].isNew?t.splice(e,1):t[e].isDeleted=!0,i(t)})(t),className:"p-1 rounded transition-colors "+("gold"===a?"text-red-400 hover:bg-red-400/10":"text-red-600 hover:bg-red-50"),title:"Delete row",children:st.jsx(Z,{className:"h-4 w-4"})})})]},e.id))})]})})}),st.jsx("div",{className:"p-4 border-t "+("gold"===a?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsx("div",{className:"text-sm "+("gold"===a?"text-gray-400":"text-gray-600"),children:"💡 Tips: Click cells to edit • Tab to navigate • Enter to confirm • Escape to cancel"}),st.jsx("div",{className:"flex items-center space-x-2",children:st.jsxs("span",{className:"text-sm "+("gold"===a?"text-gray-400":"text-gray-600"),children:[o.filter(e=>e.isNew).length," new • ",o.filter(e=>e.isModified).length," modified • ",o.filter(e=>e.isDeleted).length," deleted"]})})]})})]})})}function es(){const{user:e}=nt(),{theme:t}=gt(),[s,l]=g.useState([]),[r,a]=g.useState(null),[o,d]=g.useState([]),[m,x]=g.useState(!0),[u,h]=g.useState(!1),[y,p]=g.useState(""),[b,f]=g.useState(""),[j,v]=g.useState([]),[w,N]=g.useState(!1),[k,_]=g.useState(!1),[C,I]=g.useState(!1),[A,q]=g.useState(!1),[D,T]=g.useState(!1),[P,R]=g.useState(!1),[$,F]=g.useState(!1),[O,U]=g.useState(!1),[B,V]=g.useState(null),[G,W]=g.useState(""),[Y,K]=g.useState(""),[Q,ee]=g.useState(!1);g.useEffect(()=>{e&&te()},[e]),g.useEffect(()=>{r&&se()},[r]);const te=()=>c(this,null,function*(){if(e)try{x(!0);const{data:t,error:s}=yield at.from("lists").select("\n          *,\n          list_leads(count)\n        ").eq("user_id",e.id).order("updated_at",{ascending:!1});if(s)throw s;const o=(null==t?void 0:t.map(e=>{var t,s;return n(i({},e),{lead_count:(null==(s=null==(t=e.list_leads)?void 0:t[0])?void 0:s.count)||0})}))||[];l(o),!r&&o.length>0&&a(o[0])}catch(t){console.error("Error fetching lists:",t),p("Failed to load lists")}finally{x(!1)}}),se=()=>c(this,null,function*(){if(r&&e)try{h(!0);const{data:t,error:s}=yield at.from("list_leads").select("*").eq("list_id",r.id).eq("user_id",e.id).order("created_at",{ascending:!1});if(s)throw s;d(t||[])}catch(t){console.error("Error fetching list leads:",t),p("Failed to load list leads")}finally{h(!1)}}),le=t=>c(this,null,function*(){if(confirm("Are you sure you want to delete this list and all its leads?"))try{const{error:s}=yield at.from("lists").delete().eq("id",t).eq("user_id",null==e?void 0:e.id);if(s)throw s;(null==r?void 0:r.id)===t&&(a(null),d([])),te()}catch(s){console.error("Error deleting list:",s),p("Failed to delete list")}}),re=o.filter(e=>{var t,s,l,r,a;if(!b)return!0;const o=b.toLowerCase();return(null==(t=e.name)?void 0:t.toLowerCase().includes(o))||(null==(s=e.email)?void 0:s.toLowerCase().includes(o))||(null==(l=e.phone)?void 0:l.includes(b))||(null==(r=e.company_name)?void 0:r.toLowerCase().includes(o))||(null==(a=e.job_title)?void 0:a.toLowerCase().includes(o))});return m?st.jsx(bt,{size:"lg",message:"Loading lists...",className:"h-64"}):st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("div",{children:[st.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:["gold"===t?st.jsx(E,{className:"h-8 w-8 text-yellow-400"}):st.jsx(M,{className:"h-8 w-8 text-blue-600"}),st.jsx("h1",{className:"text-3xl font-bold "+("gold"===t?"gold-text-gradient":"text-gray-900"),children:"Lists Manager"})]}),st.jsx("p",{className:"gold"===t?"text-gray-400":"text-gray-600",children:"Organize and manage your lead lists for targeted campaigns"})]}),st.jsxs("div",{className:"flex items-center space-x-3",children:[st.jsxs("button",{onClick:()=>F(!0),className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg border transition-colors "+("gold"===t?"border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border-gray-300 text-gray-700 hover:bg-gray-50"),children:[st.jsx(z,{className:"h-4 w-4 mr-2"}),"Discover Leads"]}),st.jsxs("button",{onClick:()=>N(!0),className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors "+("gold"===t?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[st.jsx(H,{className:"h-4 w-4 mr-2"}),"New List"]})]})]}),y&&st.jsx(pt,{message:y,onDismiss:()=>p("")}),st.jsx("div",{className:"p-4 rounded-xl border "+("gold"===t?"black-card gold-border":"bg-white border-gray-200"),children:st.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[st.jsxs("div",{className:"flex-1 max-w-md",children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===t?"text-gray-300":"text-gray-700"),children:"Select List"}),st.jsxs("select",{value:(null==r?void 0:r.id)||"",onChange:e=>{const t=s.find(t=>t.id===e.target.value);a(t||null)},className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===t?"border-yellow-400/30 bg-black/50 text-gray-200 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),children:[st.jsx("option",{value:"",children:"Choose a list..."}),s.map(e=>st.jsxs("option",{value:e.id,children:[e.name," (",e.lead_count||0," leads)"]},e.id))]})]}),st.jsx("div",{className:"flex items-center space-x-2",children:r&&st.jsxs(st.Fragment,{children:[st.jsxs("button",{onClick:()=>_(!0),className:"inline-flex items-center px-3 py-2 text-sm rounded-lg transition-colors "+("gold"===t?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-50"),children:[st.jsx(Me,{className:"h-4 w-4 mr-1"}),"Upload"]}),st.jsxs("button",{onClick:()=>q(!0),disabled:0===o.length,className:`inline-flex items-center px-3 py-2 text-sm rounded-lg transition-colors ${"gold"===t?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-50"} disabled:opacity-50`,children:[st.jsx(De,{className:"h-4 w-4 mr-1"}),"Enrich"]}),st.jsxs("button",{onClick:()=>T(!0),disabled:0===o.length,className:`inline-flex items-center px-3 py-2 text-sm rounded-lg transition-colors ${"gold"===t?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-50"} disabled:opacity-50`,children:[st.jsx(Se,{className:"h-4 w-4 mr-1"}),"Clean"]}),st.jsxs("button",{onClick:()=>U(!0),disabled:0===o.length,className:`inline-flex items-center px-3 py-2 text-sm rounded-lg transition-colors ${"gold"===t?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-50"} disabled:opacity-50`,children:[st.jsx(He,{className:"h-4 w-4 mr-1"}),"Edit"]}),st.jsx("button",{onClick:()=>le(r.id),className:"p-2 rounded-lg transition-colors "+("gold"===t?"text-red-400 hover:bg-red-400/10":"text-red-600 hover:bg-red-50"),title:"Delete list",children:st.jsx(Z,{className:"h-4 w-4"})})]})})]})}),r?st.jsxs("div",{className:"space-y-6",children:[st.jsxs("div",{className:"p-4 rounded-xl border "+("gold"===t?"black-card gold-border":"bg-white border-gray-200"),children:[st.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[st.jsxs("div",{children:[st.jsxs("h2",{className:"text-lg font-bold "+("gold"===t?"text-gray-200":"text-gray-900"),children:[r.name," (",o.length," leads)"]}),r.description&&st.jsx("p",{className:"text-sm "+("gold"===t?"text-gray-400":"text-gray-600"),children:r.description})]}),st.jsx("div",{className:"flex-1 max-w-md",children:st.jsxs("div",{className:"relative",children:[st.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 "+("gold"===t?"text-yellow-400":"text-gray-400")}),st.jsx("input",{type:"text",placeholder:"Search leads...",value:b,onChange:e=>f(e.target.value),className:`w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 ${"gold"===t?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"} focus:border-transparent`})]})})]}),j.length>0&&st.jsx("div",{className:"mt-4 p-3 rounded-lg "+("gold"===t?"bg-yellow-400/10 border border-yellow-400/20":"bg-blue-50 border border-blue-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsxs("span",{className:"text-sm font-medium "+("gold"===t?"text-yellow-400":"text-blue-700"),children:[j.length," leads selected"]}),st.jsxs("div",{className:"flex items-center space-x-2",children:[st.jsxs("button",{onClick:()=>{const e=[["Name","Email","Phone","Company","Job Title","Source URL","Source Platform","Created"],...(j.length>0?o.filter(e=>j.includes(e.id)):re).map(e=>[e.name||"",e.email||"",e.phone||"",e.company_name||"",e.job_title||"",e.source_url||"",e.source_platform||"",new Date(e.created_at).toLocaleDateString()])].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n"),t=new Blob([e],{type:"text/csv"}),s=URL.createObjectURL(t),l=document.createElement("a");l.href=s,l.download=`${(null==r?void 0:r.name)||"leads"}_export_${(new Date).toISOString().split("T")[0]}.csv`,l.click(),URL.revokeObjectURL(s)},className:"inline-flex items-center px-3 py-1 text-xs rounded-lg transition-colors "+("gold"===t?"border border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border border-gray-300 text-gray-700 hover:bg-gray-50"),children:[st.jsx(he,{className:"h-3 w-3 mr-1"}),"Export"]}),st.jsxs("button",{onClick:()=>R(!0),className:"inline-flex items-center px-3 py-1 text-xs rounded-lg transition-colors "+("gold"===t?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[st.jsx(fe,{className:"h-3 w-3 mr-1"}),"To Campaign"]}),st.jsxs("button",{onClick:()=>c(this,null,function*(){if(0!==j.length&&confirm(`Are you sure you want to delete ${j.length} selected leads?`))try{const{error:t}=yield at.from("list_leads").delete().in("id",j).eq("user_id",null==e?void 0:e.id);if(t)throw t;v([]),se(),te()}catch(t){console.error("Error deleting leads:",t),p("Failed to delete leads")}}),className:"inline-flex items-center px-3 py-1 text-xs rounded-lg bg-red-600 text-white hover:bg-red-700 transition-colors",children:[st.jsx(Z,{className:"h-3 w-3 mr-1"}),"Delete"]}),st.jsx("button",{onClick:()=>v([]),className:`text-xs ${"gold"===t?"text-gray-400":"text-gray-600"} hover:underline`,children:"Clear"})]})]})})]}),st.jsx("div",{className:"rounded-xl border "+("gold"===t?"black-card gold-border":"bg-white border-gray-200"),children:u?st.jsx(bt,{size:"md",message:"Loading leads...",className:"h-32"}):0===re.length?st.jsxs("div",{className:"text-center py-12",children:[st.jsx(M,{className:"h-12 w-12 mx-auto mb-4 "+("gold"===t?"text-gray-600":"text-gray-400")}),st.jsx("h3",{className:"text-lg font-medium mb-2 "+("gold"===t?"text-gray-200":"text-gray-900"),children:b?"No leads match your search":"No leads in this list"}),st.jsx("p",{className:"mb-6 "+("gold"===t?"text-gray-400":"text-gray-600"),children:b?"Try adjusting your search terms":"Upload leads or discover new prospects to get started"}),!b&&st.jsxs("div",{className:"flex justify-center space-x-3",children:[st.jsxs("button",{onClick:()=>_(!0),className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors "+("gold"===t?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[st.jsx(Me,{className:"h-4 w-4 mr-2"}),"Upload Leads"]}),st.jsxs("button",{onClick:()=>F(!0),className:"inline-flex items-center px-4 py-2 text-sm rounded-lg border transition-colors "+("gold"===t?"border-yellow-400/30 text-yellow-400 hover:bg-yellow-400/10":"border-gray-300 text-gray-700 hover:bg-gray-50"),children:[st.jsx(z,{className:"h-4 w-4 mr-2"}),"Discover Leads"]})]})]}):st.jsx("div",{className:"overflow-x-auto",children:st.jsxs("table",{className:"min-w-full",children:[st.jsx("thead",{className:""+("gold"===t?"bg-black/20":"bg-gray-50"),children:st.jsxs("tr",{children:[st.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===t?"text-gray-400":"text-gray-500"),children:st.jsx("input",{type:"checkbox",checked:j.length===re.length&&re.length>0,onChange:()=>{j.length===re.length?v([]):v(re.map(e=>e.id))},className:"rounded"})}),st.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===t?"text-gray-400":"text-gray-500"),children:"Lead"}),st.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===t?"text-gray-400":"text-gray-500"),children:"Contact"}),st.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===t?"text-gray-400":"text-gray-500"),children:"Company"}),st.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===t?"text-gray-400":"text-gray-500"),children:"Source"}),st.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider "+("gold"===t?"text-gray-400":"text-gray-500"),children:"Actions"})]})}),st.jsx("tbody",{className:"divide-y "+("gold"===t?"divide-yellow-400/20":"divide-gray-200"),children:re.map(e=>st.jsxs("tr",{className:`hover:${"gold"===t?"bg-yellow-400/5":"bg-gray-50"} transition-colors`,children:[st.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:st.jsx("input",{type:"checkbox",checked:j.includes(e.id),onChange:()=>{return t=e.id,void v(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"rounded"})}),st.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:st.jsxs("div",{className:"flex items-center",children:[st.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center "+("gold"===t?"bg-blue-500/20":"bg-blue-100"),children:st.jsx(M,{className:"h-4 w-4 "+("gold"===t?"text-blue-400":"text-blue-600")})}),st.jsxs("div",{className:"ml-3",children:[st.jsx("div",{className:"text-sm font-medium "+("gold"===t?"text-gray-200":"text-gray-900"),children:e.name}),e.job_title&&st.jsx("div",{className:"text-xs "+("gold"===t?"text-gray-400":"text-gray-500"),children:e.job_title})]})]})}),st.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:st.jsxs("div",{className:"space-y-1",children:[e.email&&st.jsxs("div",{className:"flex items-center text-xs "+("gold"===t?"text-gray-300":"text-gray-700"),children:[st.jsx(L,{className:"h-3 w-3 mr-1"}),st.jsx("span",{className:"truncate max-w-32",children:e.email})]}),e.phone&&st.jsxs("div",{className:"flex items-center text-xs "+("gold"===t?"text-gray-300":"text-gray-700"),children:[st.jsx(J,{className:"h-3 w-3 mr-1"}),e.phone]})]})}),st.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.company_name?st.jsxs("div",{className:"flex items-center text-xs "+("gold"===t?"text-gray-300":"text-gray-700"),children:[st.jsx(ye,{className:"h-3 w-3 mr-1"}),st.jsx("span",{className:"truncate max-w-32",children:e.company_name})]}):st.jsx("span",{className:"text-xs text-gray-500",children:"No company"})}),st.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:st.jsx("div",{className:"text-xs "+("gold"===t?"text-gray-300":"text-gray-700"),children:e.source_platform||"Manual"})}),st.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:st.jsx("button",{onClick:()=>{V(e),I(!0)},className:"p-1 rounded transition-colors "+("gold"===t?"text-yellow-400 hover:bg-yellow-400/10":"text-blue-600 hover:bg-blue-100"),title:"Edit lead",children:st.jsx(X,{className:"h-3 w-3"})})})]},e.id))})]})})})]}):0===s.length?st.jsxs("div",{className:"p-12 rounded-xl border text-center "+("gold"===t?"black-card gold-border":"bg-white border-gray-200"),children:[st.jsx(M,{className:"h-16 w-16 mx-auto mb-4 "+("gold"===t?"text-gray-600":"text-gray-400")}),st.jsx("h3",{className:"text-xl font-medium mb-2 "+("gold"===t?"text-gray-200":"text-gray-900"),children:"No lists yet"}),st.jsx("p",{className:"mb-6 "+("gold"===t?"text-gray-400":"text-gray-600"),children:"Create your first list to organize leads"}),st.jsxs("button",{onClick:()=>N(!0),className:"inline-flex items-center px-6 py-3 text-sm font-medium rounded-lg transition-colors "+("gold"===t?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"),children:[st.jsx(H,{className:"h-4 w-4 mr-2"}),"Create First List"]})]}):st.jsxs("div",{className:"p-8 rounded-xl border text-center "+("gold"===t?"black-card gold-border":"bg-white border-gray-200"),children:[st.jsx(M,{className:"h-12 w-12 mx-auto mb-4 "+("gold"===t?"text-gray-600":"text-gray-400")}),st.jsx("h3",{className:"text-lg font-medium mb-2 "+("gold"===t?"text-gray-200":"text-gray-900"),children:"Select a list to view leads"}),st.jsx("p",{className:"gold"===t?"text-gray-400":"text-gray-600",children:"Choose a list from the dropdown above to manage its leads"})]}),w&&st.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto "+("gold"===t?"bg-black/75":"bg-gray-900/50"),children:st.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:st.jsxs("div",{className:"w-full max-w-md rounded-xl shadow-2xl "+("gold"===t?"black-card gold-border":"bg-white border border-gray-200"),children:[st.jsx("div",{className:"p-6 border-b "+("gold"===t?"border-yellow-400/20":"border-gray-200"),children:st.jsx("h3",{className:"text-lg font-semibold "+("gold"===t?"text-gray-200":"text-gray-900"),children:"Create New List"})}),st.jsxs("form",{onSubmit:t=>c(this,null,function*(){if(t.preventDefault(),e&&G.trim()){ee(!0);try{const{data:t,error:s}=yield at.from("lists").insert([{user_id:e.id,name:G.trim(),description:Y.trim()||null,tags:[]}]).select().single();if(s)throw s;W(""),K(""),N(!1),te(),a(t)}catch(s){console.error("Error creating list:",s),p("Failed to create list")}finally{ee(!1)}}}),className:"p-6 space-y-4",children:[st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===t?"text-gray-300":"text-gray-700"),children:"List Name *"}),st.jsx("input",{type:"text",value:G,onChange:e=>W(e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===t?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"e.g., SaaS Founders Q4",required:!0})]}),st.jsxs("div",{children:[st.jsx("label",{className:"block text-sm font-medium mb-2 "+("gold"===t?"text-gray-300":"text-gray-700"),children:"Description"}),st.jsx("textarea",{value:Y,onChange:e=>K(e.target.value),rows:3,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 "+("gold"===t?"border-yellow-400/30 bg-black/50 text-gray-200 placeholder-gray-500 focus:ring-yellow-400":"border-gray-300 bg-white text-gray-900 focus:ring-blue-500"),placeholder:"Describe this list..."})]}),st.jsxs("div",{className:"flex space-x-3",children:[st.jsx("button",{type:"button",onClick:()=>N(!1),className:"flex-1 px-4 py-2 text-sm rounded-lg transition-colors "+("gold"===t?"text-gray-400 bg-gray-800 border border-gray-600 hover:bg-gray-700":"text-gray-700 bg-gray-200 hover:bg-gray-300"),children:"Cancel"}),st.jsx("button",{type:"submit",disabled:Q||!G.trim(),className:`flex-1 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${"gold"===t?"gold-gradient text-black hover-gold":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50`,children:Q?"Creating...":"Create List"})]})]})]})})}),O&&r&&st.jsx(Zt,{listId:r.id,listName:r.name,onClose:()=>U(!1),onSave:()=>{U(!1),se(),te()}}),k&&r&&st.jsx(Gt,{listId:r.id,onClose:()=>_(!1),onSuccess:()=>{_(!1),se(),te()}}),C&&B&&r&&st.jsx(Wt,{lead:B,listId:r.id,onClose:()=>{I(!1),V(null)},onSave:()=>{I(!1),V(null),se()}}),A&&r&&st.jsx(Jt,{listId:r.id,leadCount:o.length,onClose:()=>q(!1),onSuccess:()=>{q(!1),se()}}),D&&r&&st.jsx(Yt,{listId:r.id,listName:r.name,onClose:()=>T(!1),onSuccess:()=>{T(!1),se(),te()}}),P&&r&&st.jsx(Kt,{listId:r.id,selectedLeadIds:j,onClose:()=>R(!1),onSuccess:()=>{R(!1),v([])}}),$&&st.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto "+("gold"===t?"bg-black/75":"bg-gray-900/50"),children:st.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:st.jsxs("div",{className:"w-full max-w-4xl rounded-xl shadow-2xl "+("gold"===t?"black-card gold-border":"bg-white border border-gray-200"),children:[st.jsx("div",{className:"p-6 border-b "+("gold"===t?"border-yellow-400/20":"border-gray-200"),children:st.jsxs("div",{className:"flex items-center justify-between",children:[st.jsx("h2",{className:"text-xl font-bold "+("gold"===t?"text-gray-200":"text-gray-900"),children:"AI Lead Discovery"}),st.jsx("button",{onClick:()=>F(!1),className:"p-2 rounded-lg transition-colors "+("gold"===t?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"),children:st.jsx(S,{className:"h-5 w-5"})})]})}),st.jsx("div",{className:"p-6",children:st.jsx(Qt,{onLeadsFound:()=>{F(!1),te()}})})]})})})]})}function ts(){return st.jsx(mt,{children:st.jsx(ct,{children:st.jsx(it,{children:st.jsx(w,{children:st.jsx("div",{className:"min-h-screen",children:st.jsxs(N,{children:[st.jsx(k,{path:"/auth",element:st.jsx(ft,{})}),st.jsxs(k,{path:"/",element:st.jsx(jt,{}),children:[st.jsx(k,{index:!0,element:st.jsx(y,{to:"/dashboard",replace:!0})}),st.jsx(k,{path:"dashboard",element:st.jsx(vt,{})}),st.jsx(k,{path:"campaigns",element:st.jsx(wt,{})}),st.jsx(k,{path:"campaigns/:id/edit",element:st.jsx(Et,{})}),st.jsx(k,{path:"campaigns/:id/chat",element:st.jsx(At,{})}),st.jsx(k,{path:"booked",element:st.jsx(Pt,{})}),st.jsx(k,{path:"targeting",element:st.jsx(Bt,{})}),st.jsx(k,{path:"lists",element:st.jsx(es,{})}),st.jsx(k,{path:"settings",element:st.jsx(Ut,{})}),st.jsx(k,{path:"admin",element:st.jsx(Rt,{})})]})]})})})})})})}lt.createRoot(document.getElementById("root")).render(st.jsx(x.StrictMode,{children:st.jsx(ts,{})}));
